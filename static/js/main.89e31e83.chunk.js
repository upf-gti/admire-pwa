(this["webpackJsonpadmire-pwa"]=this["webpackJsonpadmire-pwa"]||[]).push([[0],{111:function(e,t,n){"use strict";var r=n(14),a=n.n(r),o=n(20),c={get:function(){var e=Object(o.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(t).then((function(e){return e.json()})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),post:function(){var e=Object(o.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(e){return e.json()})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()};t.a=c},125:function(e,t,n){"use strict";t.a=n.p+"static/media/logo.f23962e9.png"},152:function(e,t,n){"use strict";var r=n(2),a=n(5),o=n(6),c=n(23),i=n.n(c),s=n(64),l=n(1),d=n(0),u=["id","stream","onClick","isLocal"];t.a=function(e){var t,n=e.id,c=e.stream,b=e.onClick,f=e.isLocal,j=void 0!==f&&f,m=Object(o.a)(e,u),h=Object(l.useRef)(null),v=Object(l.useState)({audio:!1}),p=Object(a.a)(v,2),g=p[0],O=p[1];return Object(l.useEffect)((function(){c&&h.current&&(h.current.srcObject=c)}),[c]),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{className:"jsx-3417875426 "+"Video ".concat(null!==(t=m.className)&&void 0!==t?t:""),children:[Object(d.jsxs)("div",{className:"jsx-3417875426 stream-status position-absolute bottom-0 start-0",children:[Object(d.jsxs)("span",{className:"jsx-3417875426 status-user",children:[" ",n," "]}),Object(d.jsx)(s.a,{className:"status-audio",variant:"link",onClick:function(){O(Object(r.a)(Object(r.a)({},g),{},{audio:!g.audio}))},children:Object(d.jsx)("i",{className:"jsx-3417875426 "+"bi bi-mic".concat(null!==g&&void 0!==g&&g.audio?"":"-mute")})})]}),Object(d.jsx)("video",{autoPlay:!0,playsInline:!0,muted:j||!(null!==g&&void 0!==g&&g.audio),ref:h,onClick:b,className:"jsx-3417875426"})]}),Object(d.jsx)(i.a,{id:"3417875426",children:[".Video{position:relative;margin:0;padding:0;border:1px solid #494E58;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out;}",".Video:hover,.Video .selected{border:1px solid #057bbb;}",".Video .stream-status{color:white !important;z-index:1000;}",".Video .stream-status .status-user{padding:0.375rem 0.75rem;padding-right:0;}",".Video .stream-status .status-audio{color:white !important;cursor:pointer;padding:0;margin-bottom:.35rem;}",".Video video{width:100%;height:100%;object-fit:cover;margin-bottom:-4px;}"]})]})}},19:function(e,t,n){"use strict";var r=n(2),a=n(6),o=n(23),c=n.n(o),i=(n(1),n(100)),s=n(64),l=n(0),d=["title","children","show","setShow","callback","buttons","closeButton"];t.a=function(e){var t=e.title,n=e.children,o=e.show,u=e.setShow,b=void 0===u?function(){}:u,f=(e.callback,e.buttons),j=e.closeButton,m=Object(a.a)(e,d);return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)(i.a,Object(r.a)(Object(r.a)({centered:!0,show:o,keyboard:!0,onHide:function(){return b(!1)},dialogClassName:"modal-partial modal-shadow-lg"},m),{},{children:[j&&t&&Object(l.jsx)(i.a.Header,{closeButton:j,children:Object(l.jsx)(i.a.Title,{className:"user-select-none",children:t})}),Object(l.jsx)(i.a.Body,{children:n}),(f||j)&&Object(l.jsxs)(i.a.Footer,{children:[f&&f.map((function(e,t,n){return Object(l.jsx)("div",{className:"jsx-843084643",children:e},t)})),j&&Object(l.jsx)(s.a,{variant:"outline-secondary",onClick:function(){return b(!1)},children:" Close"})]})]})),Object(l.jsx)(c.a,{id:"843084643",children:['@charset "UTF-8";',".modal-partial.modal-shadow-lg.modal-md.modal-dialog-centered:focus-visible{outline:none;}",'.modal-partial .modal-title{font-weight:lighter;font-family:"Comfortaa",sans-serif;}',".modal-partial .modal-title h1,.modal-partial .modal-title h2,.modal-partial .modal-title h3,.modal-partial .modal-title h4,.modal-partial .modal-title h5,.modal-partial .modal-title h6{padding:0;margin:0;}",".modal-partial .modal-header{padding-bottom:.2em;}","@media only screen and (min-width:321px){}","@media only screen and (orientation:landscape) and (max-height:671px){.modal-dialog{max-width:38rem !important;}}"]})]})}},190:function(e,t,n){"use strict";(function(e){var r=n(2),a=n(6),o=n(23),c=n.n(o),i=n(191),s=n(455),l=n(13),d=n(43),u=n(18),b=n(213),f=n(206),j=n(207),m=n(208),h=n(209),v=n(210),p=n(125),g=(n(450),n(451),n(26)),O=n(83),x=n(51),w=n(27),k=n(0),y=["children"];window.toast=l.b,t.a=function(t){t.children;var n=Object(a.a)(t,y);return Object(k.jsxs)("div",Object(r.a)(Object(r.a)({id:"layout"},n),{},{className:"jsx-3991789039 "+(n&&null!=n.className&&n.className||""),children:[Object(k.jsx)(l.a,{id:"toaster",position:"bottom-right",reverseOrder:!0,toastOptions:{duration:2e3}}),Object(k.jsx)(d.a,{basename:"admire-pwa",children:Object(k.jsx)(w.b,{children:Object(k.jsx)(g.b,{children:Object(k.jsx)(x.b,{children:Object(k.jsxs)(O.b,{children:[Object(k.jsxs)(i.a,{children:[Object(k.jsx)("title",{className:"jsx-3991789039",children:"admire"}),Object(k.jsx)("title",{className:"jsx-3991789039",children:n.title}),Object(k.jsx)("meta",{property:"og:url",content:"http://www.admire3d.eu/",className:"jsx-3991789039"}),Object(k.jsx)("meta",{property:"og:type",content:Object({NODE_ENV:"production",PUBLIC_URL:"/admire-pwa",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://admire-dev-auth.brainstorm3d.com",REACT_APP_APP_URL:"wss://admire-dev-lobby.brainstorm3d.com",REACT_APP_BASE:"admire-pwa",REACT_APP_COOKIES_EXPIRE_TIME:"30",REACT_APP_NAME:"admire",REACT_APP_OG_DESC:"Advanced Mixed Realities",REACT_APP_OG_IMAGE:"http://www.admire3d.eu/wp-content/uploads/2021/02/admire.jpg",REACT_APP_OG_TITLE:"AdMiRe",REACT_APP_OG_URL:"http://www.admire3d.eu/",REACT_APP_RTC_URL:"wss://admire-dev-rtc.brainstorm3d.com"}).REACT_APP_OG_TYPE,className:"jsx-3991789039"}),Object(k.jsx)("meta",{property:"og:title",content:"AdMiRe",className:"jsx-3991789039"}),Object(k.jsx)("meta",{property:"og:description",content:"Advanced Mixed Realities",className:"jsx-3991789039"}),Object(k.jsx)("meta",{property:"og:image",content:e.envREACT_APP_OG_IMAGE,className:"jsx-3991789039"})]}),Object(k.jsxs)("div",{id:"title",variant:"none",className:"jsx-3991789039 d-flex m-3 position-absolute top-0 start-0 user-select-none",children:[Object(k.jsx)(s.a,{className:"me-2",width:32,height:32,src:p.a}),Object(k.jsx)("h1",{className:"jsx-3991789039 fs-3",children:"admire"})]}),Object(k.jsxs)("div",{className:"jsx-3991789039 z-top d-flex m-2 position-absolute top-0 end-0",children:[Object(k.jsx)(h.a,{}),Object(k.jsx)(m.a,{}),Object(k.jsx)(v.a,{})]}),Object(k.jsxs)(u.d,{children:[Object(k.jsx)(u.b,{component:b.a,exact:!0,path:["/","/settings","/about","/users","/chat","/profile","/room/:roomId","/room/:roomId/chat","/room/:roomId/guests"]}),Object(k.jsx)(u.b,{component:f.a,exact:!0,path:"/verified/:token"}),Object(k.jsx)(u.b,{component:j.a,exact:!0,path:"/reset-password/:token"}),Object(k.jsxs)(u.b,{children:[" ",Object(k.jsx)(u.a,{to:"/"})," "]})]})]})})})})}),Object(k.jsx)(c.a,{id:"3991789039",children:["#layout{text-align:center;background:#1B222E;}","#title{color:#D1D3D5;-webkit-filter:invert(0.5) brightness(0.5);filter:invert(0.5) brightness(0.5);mix-blend-mode:luminosity;}",".z-top{z-index:1000;}"]})]}))}}).call(this,n(132))},206:function(e,t,n){"use strict";var r=n(18),a=n(24),o=n(19),c=n(0);t.a=function(){var e=Object(r.g)();return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)(o.a,{size:"md",show:!0,title:Object(c.jsx)("h2",{className:"user-select-none",children:"User verified!\ud83c\udf89\ud83c\udf89"}),button_tittle:"Understood",callback:function(){e.push("/")},children:Object(c.jsx)(a.a,{className:"user-select-none",children:"Account verified successfully in the system. You can now login on the application."})})})}},207:function(e,t,n){"use strict";var r=n(14),a=n.n(r),o=n(20),c=n(7),i=n(2),s=n(5),l=n(13),d=n(1),u=n(18),b=n(216),f=n(157),j=n(456),m=n(454),h=n(64),v=n(111),p=n(24),g=n(19),O=n(0);t.a=function(){var e,t=Object(u.h)().token,n=Object(u.g)(),r=Object(d.useRef)(null),x=Object(d.useState)(void 0),w=Object(s.a)(x,2),k=w[0],y=w[1],S=Object(d.useState)({formErrors:{}}),C=Object(s.a)(S,2),_=C[0],I=C[1];function N(){return(N=Object(o.a)(a.a.mark((function e(r){var o,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),o=l.b.loading("Resetting password..."),c=_.password,e.next=5,v.a.post("".concat("https://admire-dev-auth.brainstorm3d.com","/reset-password/").concat(t),{password:c}).then((function(e){var t=e.status,r=e.description,a=e.message;switch(t){case"ok":l.b.success("Success",{id:o}),setTimeout((function(){return n.push("/")}),1e3);break;case 400:l.b.error(a,{id:o});break;case"error":l.b.error(r,{id:o});break;default:l.b.warn(r,{id:o})}})).catch((function(e){l.b.error("Error: ".concat(e),{id:o})}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(d.useEffect)((function(){!function(){var e=!0;for(var t in _)-1!==t.indexOf("_check")&&(e&=_[t]);y(!!e)}()}),[_]),Object(d.useEffect)((function(){y(!1)}),[]),Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)(g.a,{size:"md",show:!0,title:Object(O.jsx)("h2",{className:"user-select-none",children:"Reset password"}),children:[Object(O.jsx)(p.a,{className:"user-select-none",children:"Please enter your new password."}),Object(O.jsxs)(b.a,{validated:k,onSubmit:function(e){return N.apply(this,arguments)},ref:r,children:[Object(O.jsx)(f.a,{controlId:"floatingPassword",label:"New Password",children:Object(O.jsx)(b.a.Control,{required:!0,name:"password",type:"password",placeholder:" ",onChange:function(e){!function(e,t){var n=!1,r=_.formErrors;switch(e){case"email":n=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t),r[e]=n?"":" is invalid";break;case"password":n=t.length>=6,r[e]=n?"":" is too short";break;default:console.warn("Invalid field name: ",e)}I((function(a){var o;return Object(i.a)(Object(i.a)({},a),{},(o={},Object(c.a)(o,e,t),Object(c.a)(o,"".concat(e,"_check"),n),Object(c.a)(o,"formErrors",r),o))}))}(e.target.name,e.target.value)},defaultValue:null!==(e=_.password)&&void 0!==e?e:""})}),Object(O.jsx)(j.a,{placement:"bottom",overlay:Object(O.jsx)(m.a,{className:"".concat(k?"d-none":""," mt-2"),id:"tooltip-bottom",children:"Check form errors"}),children:Object(O.jsx)("span",{style:{padding:"10px 0"},children:Object(O.jsx)(h.a,{className:"mt-4",type:"submit",disabled:!k,children:" Proceed "})})})]})]})})}},208:function(e,t,n){"use strict";var r=n(14),a=n.n(r),o=n(20),c=n(2),i=n(5),s=n(1),l=n(64),d=n(19),u=n(24),b=n(0);t.a=function(){var e=Object(s.useState)(!1),t=Object(i.a)(e,2),n=t[0],r=t[1],f=Object(s.useReducer)((function(e,t){return t}),{proposalEvent:void 0}),j=Object(i.a)(f,2),m=j[0],h=j[1];function v(e){e.preventDefault(),h((function(t){return Object(c.a)(Object(c.a)({},t),{},{e:e})}))}function p(){return(p=Object(o.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==m&&void 0!==m&&m.proposalEvent){e.next=2;break}return e.abrupt("return");case 2:return m.proposalEvent.prompt(),e.next=5,m.proposalEvent.userChoice;case 5:t=e.sent,"accepted"===t.outcome&&h((function(e){return Object(c.a)(Object(c.a)({},e),{},{proposalEvent:void 0})}));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){return window.addEventListener("beforeinstallprompt",v,0),function(){window.removeEventListener("beforeinstallprompt",v,0)}}),[]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(l.a,{variant:"link",onClick:function(){return r(1)},children:"About"}),Object(b.jsx)(d.a,{closeButton:!0,size:"md",show:n,setShow:r,title:Object(b.jsxs)("span",{children:["admire"," - Offline capable ",Object(b.jsxs)(l.a,{variant:"".concat(m.proposalEvent?"outline-primary":"outline-secondary"),size:"sm",onClick:function(){return p.apply(this,arguments)},disabled:!m.proposalEvent,children:[" ","".concat(m.proposalEvent?"Install PWA":"Not available")]})]}),children:Object(b.jsx)(u.a,{children:'\n        An offline-capable AdMiRe version is available, wich is a [Progressive Web App](https://docs.microsoft.com/en-us/microsoft-edge/progressive-web-apps-chromium/).\n\n        The app serves the following features:\n        - Offline-capable (with [Service Workers](https://developers.google.com/web/fundamentals/primers/service-workers/))\n        - "Add to Home Screen" feature on Android and iOS supported devices to launch the app from the home screen.\n        - Dark Mode.\n        - Privacy-focused - We don\'t collect any personal data.\n        - Lightweight - The app is only ~5MB.\n\n        Hope you liked using this app \ud83d\ude09\n\n        <div align="center" className="fw-bolder">Made with \u2764\ufe0f by <a href="https://www.upf.edu/web/gti"> UPF-GTI</a> </div>\n        '})})]})}},209:function(e,t,n){"use strict";var r=n(5),a=n(1),o=n(64),c=n(19),i=n(24),s=n(27),l=n(0);t.a=function(){var e=Object(a.useState)(!1),t=Object(r.a)(e,2),n=t[0],d=t[1],u=Object(a.useContext)(s.a);return u.isLogged?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(o.a,{variant:"link",onClick:function(){return d(1)},children:"Profile"}),Object(l.jsxs)(c.a,{closeButton:!0,size:"lg",show:n,setShow:d,title:Object(l.jsx)("h2",{className:"user-select-none",children:"h3R"}),children:[Object(l.jsx)(i.a,{className:"user-select-none",children:'\n        An offline-capable AdMiRe version is available, wich is a [Progressive Web App](https://docs.microsoft.com/en-us/microsoft-edge/progressive-web-apps-chromium/).\n\n        The app serves the following features:\n        - Offline-capable (with [Service Workers](https://developers.google.com/web/fundamentals/primers/service-workers/))\n        - "Add to Home Screen" feature on Android and iOS supported devices to launch the app from the home screen.\n        - Dark Mode.\n        - Privacy-focused - We don\'t collect any personal data.\n        - Lightweight - The app is only ~5MB.\n\n        Hope you liked using this app \ud83d\ude09\n\n        <div align="center" className="fw-bolder">Made with \u2764\ufe0f by <a href="https://www.upf.edu/web/gti"> UPF-GTI</a> </div>\n        '}),Object(l.jsxs)(o.a,{onClick:u.logout,children:[Object(l.jsx)("i",{className:"bi bi-power"})," Log me out"]})]})]}):Object(l.jsx)(l.Fragment,{})}},210:function(e,t,n){"use strict";var r=n(5),a=n(99),o=n(64),c=n(1),i=n(0);t.a=function(){var e=Object(c.useState)(0),t=Object(r.a)(e,2),n=t[0],s=t[1];return Object(c.useEffect)((function(){var e=function(){return s(++n)};return a.a.on("change",e),function(){a.a.off("change",e)}}),[]),Object(i.jsx)("div",{id:"btn_fullscreen",children:a.a.isEnabled&&Object(i.jsxs)(o.a,{onClick:function(){a.a.toggle()},variant:"link",children:[document.fullscreen&&Object(i.jsx)("i",{className:"bi bi-fullscreen-exit"}),!document.fullscreen&&Object(i.jsx)("i",{className:"bi bi-fullscreen"})]})})}},213:function(e,t,n){"use strict";var r=n(23),a=n.n(r),o=n(1),c=n(481),i=n(18),s=n(27),l=n(26),d=n(2),u=n(6),b=n(5),f=n(0),j=["children","icon","disabled","to"],m=["children"];function h(e){var t=e.buttons,n=e.children,r=Object(i.g)(),c=Object(o.useState)(0),s=Object(b.a)(c,2),l=(s[0],s[1]),d=0;function u(e){var t,a=e.keyCode-49;a>=0&&a<n.length&&!n[a].props.disabled&&r.push(null!==(t=n[a].props.to)&&void 0!==t?t:"/")}return Object(o.useEffect)((function(){return document.addEventListener("keydown",u),function(){document.removeEventListener("keydown",u)}}),[]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("div",{style:{zIndex:1100},className:"jsx-3949751400 nav-partial px-3 d-flex justify-content-evenly align-items-center position-absolute bottom-0 start-50 translate-middle-x mb-3 shadow rounded-5 bg-light",children:[n.filter((function(e,t,n){return t<n.length/2})).map((function(e,t,n){var r=Object(f.jsx)("div",{id:t,onClick:e.props.disabled?void 0:function(){return l(t)},className:"jsx-3949751400",children:e},t);return++d,r})),t&&t,n.filter((function(e,t,n){return t>=n.length/2})).map((function(e,t,n){return Object(f.jsx)("div",{id:t+d,onClick:e.props.disabled?void 0:function(){return l(t+d)},className:"jsx-3949751400",children:e},t+d)}))]}),Object(f.jsx)(a.a,{id:"3949751400",children:[".rounded-5{border-radius:.5em;}",".nav-partial{min-width:1rem;min-height:4rem;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out;}",".nav-button,.nav-item{color:#494E58;cursor:pointer;height:100%;width:auto;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}",".nav-button:hover,.nav-item:hover{color:#f39892;}",".nav-item-active{color:red !important;}",".nav-item-disabled{color:#b6bbc0;-webkit-user-select:none !important;-moz-user-select:none !important;-ms-user-select:none !important;user-select:none !important;pointer-events:none;cursor:not-allowed;}",".nav-item-disabled:hover{color:#b6bbc0;}",".nav-button i,.nav-item i{-webkit-transform:scale(1.5);-ms-transform:scale(1.5);transform:scale(1.5);width:100%;padding:0;margin:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-transform:capitalize;}",".nav-button{color:black !important;height:4rem;width:4rem;line-height:3.5rem;margin-top:-1.5rem;margin-bottom:1.5rem;}","@media only screen and (orientation:landscape) and (max-height:671px){.nav-partial{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;left:100% !important;-webkit-transform:translate(-100%,0%) !important;-ms-transform:translate(-100%,0%) !important;transform:translate(-100%,0%) !important;margin-left:-1.1rem;padding:1.251rem 0 !important;}.nav-partial .nav-button{margin:0;margin-left:-1.5rem;margin-right:1.5rem;}}"]})]})}h.Item=function(e){var t,n=e.children,r=(e.icon,e.disabled),a=e.to,o=Object(u.a)(e,j);return Object(f.jsx)("div",Object(d.a)(Object(d.a)({to:null!==a&&void 0!==a?a:"/",className:"nav-item ".concat(r?"nav-item-disabled":""," ").concat(null!==(t=o.appendclass)&&void 0!==t?t:"")},o),{},{children:Object(f.jsx)("div",{className:"d-flex my-0 mx-2 flex-column fs-6 fw-lighter",children:n})}))},h.Button=function(e){var t,n=e.children,r=Object(u.a)(e,m);return Object(f.jsx)("div",Object(d.a)(Object(d.a)({className:"nav-button ".concat(null!==(t=r.appendclass)&&void 0!==t?t:"")},r),{},{children:Object(f.jsx)("div",{className:" pt-1 fs-1 fw-lighter",children:n})}))};var v=h,p=n(14),g=n.n(p),O=n(15),x=n(20),w=n(478),k=n(198),y=n(477),S=n(9),C=n(152),_=n(83),I=n(51),N=n(19),E=function(e){var t=e.callId,n=e.isForwardCall,r=Object(o.useState)(null),a=Object(b.a)(r,2),c=a[0],i=a[1],s=Object(o.useContext)(_.a),l=s.getLiveCall(t),d=Object(b.a)(l,2),u=d[0];d[1];return Object(f.jsxs)(f.Fragment,{children:[n?Object(f.jsx)(y.a,{style:{padding:".44em .45em"},pill:!0,bg:"danger",onClick:function(){return s.callHangup(u)},children:Object(f.jsx)("i",{className:"bi bi-x"})}):Object(f.jsx)(y.a,{style:{padding:".44em .45em"},pill:!0,bg:"danger",onClick:function(){return i(t)},className:"cursor-pointer",children:Object(f.jsx)("i",{className:"bi bi-cast"})}),Object(f.jsx)(N.a,{show:c,setShow:i,closeButton:!0,title:"Ready to forward?",children:"Enter the destination ID you want to forward to"})]})},A=function(e){Object.assign({},e);var t,n=Object(i.g)(),r=Object(i.h)().roomId,c=Object(o.useRef)(),u=Object(o.useContext)(s.a),j=Object(o.useContext)(l.a),m=Object(o.useContext)(I.a),h=Object(o.useContext)(_.a),v=Object(o.useState)(null),p=Object(b.a)(v,2),N=p[0],A=p[1];Object(o.useEffect)((function(){return document.body.addEventListener("unload",(function e(){j.leaveRoom(),document.body.addEventListener("unload",e)})),m.init(),function(){m.stop()}}),[]),Object(o.useEffect)((function(){var e,t;function n(e){this.scrollLeft+=e.deltaY}return null===(e=c.current)||void 0===e||e.removeEventListener("wheel",n),null===(t=c.current)||void 0===t||t.addEventListener("wheel",n),function(){var e;null===(e=c.current)||void 0===e||e.removeEventListener("wheel",n)}}),[c]),Object(o.useLayoutEffect)((function(){j.ready&&Object(x.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=j.getRoomInfo(r)){e.next=3;break}return e.abrupt("return",n.push("/"));case 3:if([t.master].concat(Object(O.a)(t.guests)).includes(u.user)){e.next=6;break}return e.next=6,j.joinRoom(r).catch((function(){n.push("/")}));case 6:j.setCurrent(t);case 7:case"end":return e.stop()}}),e)})))()}),[j.ready,r]),Object(o.useLayoutEffect)((function(){u.isLogged&&u.isConnected&&j.current&&(h.callHangupAll(),h.callAllUsers(j.current))}),[u.isLogged&&u.isConnected,j.current]),Object(o.useEffect)((function(){}),[h.streams]);S.c.getStream();return Object(f.jsxs)("div",{id:"room",style:{zIndex:1e3},className:"jsx-544262060 overflow-hidden m-auto",children:[Object(f.jsxs)(w.a,{id:"content-row",className:"g-1",style:{height:"100%"},children:[Object(f.jsx)(k.a,{xs:"auto",id:"carousel-col",ref:c,children:Object(f.jsx)("div",{id:"carousel",className:"jsx-544262060 d-flex flex-column",children:Object.entries(Object(d.a)({local:m.localStream},h.streams)).map((function(e,t){var n,r,a=Object(b.a)(e,2),o=a[0],c=a[1],i=h.getUserId(o),s=(u.user===(null===(n=j.current)||void 0===n?void 0:n.master)&&i!==(null===(r=j.current)||void 0===r?void 0:r.master)&&u.user,h.getLiveCall(o)),l=Object(b.a)(s,2),d=(l[0],!!l[1]),m=N===o||!N&&0===t;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("div",{className:"jsx-544262060 stream-forward",children:[Object(f.jsx)(E,{callId:o,isForwardCall:d}),m&&Object(f.jsx)(y.a,{pill:!0,bg:"primary",children:Object(f.jsx)("i",{className:"jsx-544262060 bi bi-eye active"})})]}),Object(f.jsx)(C.a,{id:i,stream:c,className:m?"":"cursor-pointer",onClick:function(){A(o)}},o)]})}))})}),Object(f.jsx)(k.a,{id:"main-col",children:Object(f.jsx)(C.a,{className:"main-video",id:h.getUserId(N),stream:null!==(t=h.streams[N])&&void 0!==t?t:m.localStream})})]}),Object(f.jsx)(a.a,{id:"544262060",children:["#room{height:calc(100vh - 3rem - 3rem);}","#room #main-col{height:100%;overflow:hidden;}","#room #main-col .Video{width:100%;height:100%;object-fit:cover;}","#room #carousel-col{height:100%;width:166px;overflow-x:hidden;overflow-y:scroll;}","#room #carousel-col #carousel{height:100%;}","#room .stream-forward{height:1.9rem;position:relative;margin-bottom:-1.9rem;text-align:left;padding:3px 6px;z-index:10000;}","@media only screen and (orientation:landscape) and (max-height:671px){#room{height:calc(100vh - 2rem);}}","@media only screen and (orientation:portrait){#content-row{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}#carousel-col{overflow-x:scroll;overflow-y:hidden;height:126px !important;width:100% !important;}#carousel-col #carousel{-webkit-flex-direction:row !important;-ms-flex-direction:row !important;flex-direction:row !important;border:none;}#carousel-col #carousel .Video,#carousel-col #carousel .Video video{width:166px;height:124px;object-fit:cover;}}"]})]})},T=n(7),R=n(482),P=n(216),L=n(157),D=n(456),F=n(454),z=n(64),M=n(479),J=n(24),V=function(){var e,t=Object(o.useRef)(null),n=Object(o.useState)(!1),r=Object(b.a)(n,2),a=r[0],c=r[1],i=Object(o.useContext)(s.a),l=Object(o.useState)({formErrors:{}}),u=Object(b.a)(l,2),j=u[0],m=u[1],h=Object(o.useState)(void 0),v=Object(b.a)(h,2),p=v[0],g=v[1];return Object(o.useEffect)((function(){!function(){var e=!0;for(var t in j)-1!==t.indexOf("_check")&&(e&=j[t]);g(!!e)}()}),[j]),Object(o.useEffect)((function(){g(!1)}),[]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(z.a,{size:"sm",className:"mt-4",variant:"link",onClick:function(){return c(1)},children:[Object(f.jsx)("i",{className:"bi bi-lock"}),"Forgot password?"]}),Object(f.jsxs)(N.a,(e={closeButton:!0,size:"lg",show:a,setShow:c,title:Object(f.jsx)("h2",{className:"user-select-none",children:"Forgot Password"})},Object(T.a)(e,"size","md"),Object(T.a)(e,"children",[Object(f.jsx)(J.a,{className:"user-select-none",children:"Enter your email adress, on a couple of minutes you will receive an email with a link to reset your password."}),Object(f.jsxs)(P.a,{validated:p,onSubmit:function(e){alert("NO IMPLEMENTATION")},ref:t,children:[Object(f.jsx)(L.a,{controlId:"floatingInput",label:"Email address",className:"mb-3",children:Object(f.jsx)(P.a.Control,{required:!0,name:"email",type:"email",placeholder:" ",onChange:function(e){!function(e,t){var n=!1,r=j.formErrors;switch(e){case"email":n=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t),r[e]=n?"":" is invalid";break;case"password":n=t.length>=6,r[e]=n?"":" is too short";break;default:console.warn("Invalid field name: ",e)}m((function(a){var o;return Object(d.a)(Object(d.a)({},a),{},(o={},Object(T.a)(o,e,t),Object(T.a)(o,"".concat(e,"_check"),n),Object(T.a)(o,"formErrors",r),o))}))}(e.target.name,e.target.value)}})}),Object(f.jsx)(D.a,{placement:"bottom",overlay:Object(f.jsx)(F.a,{className:"".concat(p?"d-none":""),id:"tooltip-bottom",children:"Enter your email address first."}),children:Object(f.jsx)("span",{style:{padding:"10px 0"},children:Object(f.jsx)(z.a,{type:"submit",disabled:!p&&i.isConnected,children:i.isConnected?Object(f.jsx)(f.Fragment,{children:" Send password reset email "}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(M.a,{as:"span",animation:"grow",role:"status","aria-hidden":"true"})," Connecting "]})})})})]})]),e))]})},U=function(){var e=Object(o.useRef)(null),t=Object(o.useState)(!1),n=Object(b.a)(t,2),r=n[0],a=n[1],c=Object(o.useContext)(s.a),i=Object(o.useState)({formErrors:{}}),l=Object(b.a)(i,2),u=l[0],j=l[1],m=Object(o.useState)(void 0),h=Object(b.a)(m,2),v=h[0],p=h[1];return Object(o.useEffect)((function(){!function(){var e=!0;for(var t in u)-1!==t.indexOf("_check")&&(e&=u[t]);p(!!e)}()}),[u]),Object(o.useEffect)((function(){p(!1)}),[]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(R.a.Footer,{className:"text-center user-select-none",onClick:function(){return a(1)},children:" Create an account "}),Object(f.jsxs)(N.a,{closeButton:!0,show:r,setShow:a,title:Object(f.jsx)("h2",{className:"user-select-none",children:"Let's create your account"}),children:[Object(f.jsx)(J.a,{className:"user-select-none",children:"Create your account. It's free and only takes a minute."}),Object(f.jsxs)(P.a,{validated:v,onSubmit:function(e){alert("NO IMPLEMENTATION")},ref:e,children:[Object(f.jsx)(L.a,{controlId:"floatingInput",label:"Email address",className:"mb-3",children:Object(f.jsx)(P.a.Control,{required:!0,name:"email",type:"email",placeholder:" ",onChange:function(e){!function(e,t){var n=!1,r=u.formErrors;switch(e){case"email":n=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t),r[e]=n?"":" is invalid";break;case"password":n=t.length>=6,r[e]=n?"":" is too short";break;default:console.warn("Invalid field name: ",e)}j((function(a){var o;return Object(d.a)(Object(d.a)({},a),{},(o={},Object(T.a)(o,e,t),Object(T.a)(o,"".concat(e,"_check"),n),Object(T.a)(o,"formErrors",r),o))}))}(e.target.name,e.target.value)}})}),Object(f.jsx)(D.a,{placement:"bottom",overlay:Object(f.jsx)(F.a,{className:"".concat(v?"d-none":""),id:"tooltip-bottom",children:"Enter your email address first."}),children:Object(f.jsx)("span",{style:{padding:"10px 0"},children:Object(f.jsx)(z.a,{type:"submit",disabled:!v&&c.isConnected,children:c.isConnected?Object(f.jsx)(f.Fragment,{children:" CREATE ACCOUNT "}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(M.a,{as:"span",animation:"grow",role:"status","aria-hidden":"true"})," Connecting "]})})})})]})]})]})},B=n(125),W=n(49),G=function(){var e,t,n,r=Object(o.useContext)(s.a),c=Object(o.useRef)(null),i=Object(o.useState)(void 0),l=Object(b.a)(i,2),u=l[0],j=l[1],m=Object(o.useState)({formErrors:{},email:W.a.get("admire_app_email"),remember:!!W.a.get("admire_app_email")}),h=Object(b.a)(m,2),v=h[0],p=h[1];function O(){return(O=Object(x.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),r.login(v.email,v.password).then((function(e){v.remember&&(W.a.set("admire_app_token",e,"30"),W.a.set("admire_app_email",v.email,"30"))}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){var t=e.target.name,n=e.target.type;!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"any",r=!1,a=v.formErrors;switch(n){case"email":r=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t),a[e]=r?"":" is invalid";break;case"password":r=t.length>=6,a[e]=r?"":" is too short";break;default:r=!0,a[e]=""}p((function(n){var o;return Object(d.a)(Object(d.a)({},n),{},(o={},Object(T.a)(o,e,t),Object(T.a)(o,"".concat(e,"_check"),r),Object(T.a)(o,"formErrors",a),o))}))}(t,"checkbox"===n?e.target.checked:e.target.value,n)}return Object(o.useEffect)((function(){!function(){var e=!0;for(var t in v)-1!==t.indexOf("_check")&&(e&=v[t]);j(!!e)}()}),[v]),Object(o.useEffect)((function(){j(!1)}),[]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(R.a,{id:"login",bg:"light",className:"flex-column text-center position-absolute start-50 top-50 translate-middle",style:{width:"24rem"},children:[Object(f.jsxs)(k.a,{children:[Object(f.jsx)(R.a.Img,{variant:"top",className:"mt-4 user-select-none",src:B.a}),Object(f.jsx)("h1",{className:"jsx-1226047467 text-start ps-4 mb-0 mt-3 user-select-none",children:"admire"}),Object(f.jsx)("div",{className:"jsx-1226047467 divider",children:Object(f.jsx)("span",{className:"jsx-1226047467"})})]}),Object(f.jsxs)(k.a,{children:[Object(f.jsxs)(R.a.Body,{as:k.a,className:"text-start px-4 pb-4",children:[Object(f.jsx)(R.a.Text,{className:"user-select-none",children:"Enter your e-mail adress and your password."}),Object(f.jsxs)(P.a,{validated:u,onSubmit:function(e){return O.apply(this,arguments)},ref:c,children:[Object(f.jsx)(L.a,{controlId:"floatingInput",label:"Email address",className:"mb-3",children:Object(f.jsx)(P.a.Control,{required:!0,name:"email",type:"email",placeholder:" ",onChange:w,defaultValue:null!==(e=v.email)&&void 0!==e?e:" "})}),Object(f.jsx)(L.a,{controlId:"floatingPassword",label:"Password",children:Object(f.jsx)(P.a.Control,{required:!0,name:"password",type:"password",placeholder:" ",onChange:w,defaultValue:null!==(t=v.password)&&void 0!==t?t:""})}),Object(f.jsx)(P.a.Switch,{id:"remember-switch",label:"Remember me",className:"user-select-none",name:"remember",onChange:w,defaultChecked:null!==(n=v.remember)&&void 0!==n&&n}),Object(f.jsx)(D.a,{placement:"bottom",overlay:Object(f.jsx)(F.a,{className:"".concat(u?"d-none":""," mt-2"),id:"tooltip-bottom",children:"Check form errors"}),children:Object(f.jsx)("span",{style:{padding:"10px 0"},className:"jsx-1226047467",children:Object(f.jsx)(z.a,{size:"sm",className:"mt-4",type:"submit",disabled:!u&&r.isConnected,children:r.isConnected?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("i",{className:"jsx-1226047467 bi bi-box-arrow-in-left"})," Log me in "]}):Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(M.a,{as:"span",animation:"grow",size:"sm",role:"status","aria-hidden":"true"})," Connecting "]})})})}),Object(f.jsx)(V,{})]})]}),Object(f.jsx)(U,{})]})]}),Object(f.jsx)(a.a,{id:"1226047467",children:[".divider{border-bottom:1px solid #FFF;background-color:#DADADA;height:2px;margin:0.5em 0px 1.5em;}",".divider span{position:relative;display:block;width:75px;height:3px;background-color:#057bbb;-webkit-transform:translatey(-25%);-ms-transform:translatey(-25%);transform:translatey(-25%);left:6%;}","#login{border:none;}","#login img{width:192px;-webkit-filter:hue-rotate(260deg);filter:hue-rotate(260deg);}","#login .card-footer{color:#D1D3D5;background:#057bbb;-webkit-transition:all 0.1s ease-in-out;transition:all 0.1s ease-in-out;}","#login .card-footer:hover{background:#045a89;font-weight:bold;cursor:pointer;}","@media only screen and (orientation:landscape) and (max-height:671px){#login{width:40rem !important;-webkit-flex-direction:row !important;-ms-flex-direction:row !important;flex-direction:row !important;}#login .col{-webkit-align-self:end;-ms-flex-item-align:end;align-self:end;}}"]})]})},H=["id","name"];function Z(e){e.id;var t=e.name,n=Object(u.a)(e,H);return Object(f.jsxs)("div",{className:"jsx-1285018445",children:[Object(f.jsxs)(R.a,Object(d.a)(Object(d.a)({className:"bg-dark text-light"},n),{},{children:[Object(f.jsx)(R.a.Img,{variant:"top",src:"https://unsplash.it/seed/test/160/100"}),Object(f.jsx)(R.a.Body,{children:Object(f.jsxs)(R.a.Title,{children:["#",t]})})]})),Object(f.jsx)(a.a,{id:"1285018445",children:[".card{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-transition:all 0.075s ease-in-out;transition:all 0.075s ease-in-out;}",".card:hover{box-shadow:0 0 0px 2px rgba(255,255,255,0.5) !important;}",".card:hover .card-body{background:#6d7a86;}",".card .card-body{-webkit-transition:all 0.075s ease-in-out;transition:all 0.075s ease-in-out;}",".card .card-body .card-title{margin:0;font-size:1rem;white-space:nowrap;}"]})]})}var q=function(){var e=Object(i.g)(),t=Object(o.useContext)(l.a);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(w.a,{id:"lobby",className:"h-100 m-auto",children:Object(f.jsxs)(k.a,{xs:12,sm:{span:10,offset:1},children:[Object(f.jsx)("h1",{className:"jsx-3939213960 text-light",children:"Lobby"}),Object(f.jsx)(w.a,{xs:2,sm:4,lg:4,xl:5,className:"g-4",children:Object.values(t.list).map((function(t,n){return Object(f.jsx)(k.a,{children:Object(f.jsx)(Z,{name:" ".concat((null===t||void 0===t?void 0:t.id)||"Room "+n),onClick:function(){return e.push("/room/".concat(null===t||void 0===t?void 0:t.id))}})},n)}))})]})}),Object(f.jsx)(a.a,{id:"3939213960",children:["#lobby{min-height:19rem;}"]})]})},$=n(36),K=n(215),Y=(n(288),["show","setShow"]),X=function(e){e.show,e.setShow,Object(u.a)(e,Y);var t=["Devices","p1","p2","p3"],r=Object(o.useState)(0),c=Object(b.a)(r,2),i=c[0],s=c[1],l=Object(o.useState)(null),d=Object(b.a)(l,2),j=d[0],m=d[1],h=Object(o.useState)([]),v=Object(b.a)(h,2),p=v[0],O=v[1];function w(e){switch(null===e||void 0===e?void 0:e.keyCode){case 37:return s((function(e){return e-1<0?t.length-1:e-1}));case 39:return s((function(e){return(e+1)%t.length}))}}return Object(o.useEffect)((function(){Object(x.a)(g.a.mark((function e(){var r,a,o,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],a=Object($.a)(t),e.prev=2,a.s();case 4:if((o=a.n()).done){e.next=10;break}return c=o.value,e.next=8,n(449)("./".concat(c,".jsx")).then((function(e){return r.push(Object(f.jsx)(e.default,{}))}));case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),a.e(e.t0);case 15:return e.prev=15,a.f(),e.finish(15);case 18:O([].concat(r)),m(r[i]);case 20:case"end":return e.stop()}}),e,null,[[2,12,15,18]])})))()}),[]),Object(o.useEffect)((function(){m(p[i])}),[i]),Object(o.useEffect)((function(){return document.addEventListener("keydown",w),function(){document.removeEventListener("keydown",w)}}),[]),Object(f.jsxs)("div",{id:"wizard",className:"jsx-3310019628",children:[Object(f.jsx)(K.a,{onSwipeLeft:function(){return s((function(e){return(e+1)%t.length}))},onSwipeRight:function(){return s((function(e){return e-1<0?t.length-1:e-1}))},children:Object(f.jsxs)("div",{className:"jsx-3310019628",children:[Object(f.jsx)("ul",{className:"jsx-3310019628 nav nav-tabs justify-content-start mb-2",children:t.map((function(e,t){return Object(f.jsx)("li",{className:"jsx-3310019628 nav-item",children:Object(f.jsx)("div",{onClick:function(){return s(t)},className:"jsx-3310019628 "+"nav-link ".concat(i===t?"active":""),children:e})},t)}))}),j]})}),Object(f.jsx)(a.a,{id:"3310019628",children:["#wizard .nav-tabs{width:calc(100% + 24px);margin-left:-12px;margin-top:-3.6rem;}"]})]})},Q=function(){var e=Object(o.useContext)(l.a),t=Object(o.useRef)(null),n=Object(o.useState)(!1),r=Object(b.a)(n,2),a=r[0],c=r[1],i=Object(o.useState)(!1),s=Object(b.a)(i,2),d=s[0],u=s[1],j=Object(o.useState)(0),m=Object(b.a)(j,2),h=m[0],p=m[1];function g(){null!==t&&void 0!==t&&t.current&&a&&e.createRoom(t.current.value.toLowerCase()).then((function(){setTimeout((function(){p(0),c(!1)}),1e3),p(2)})).catch((function(){p(3)}))}var O=Object(f.jsx)(z.a,{disabled:!d,variant:d?"outline-primary":"outline-secondary",onClick:g,children:"Proceed!"});switch(h){case 1:O=Object(f.jsxs)(z.a,{variant:"outline-primary",children:[" ",Object(f.jsx)(M.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})]});break;case 2:O=Object(f.jsx)(z.a,{variant:"outline-success",children:" \u2714\ufe0f Succeed! "});break;case 3:O=Object(f.jsx)(z.a,{variant:"outline-danger",children:" \u274c Error "})}return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(v.Button,{onClick:function(){return c(1)},label:"Create room",appendclass:"shadow rounded-circle bg-danger",children:Object(f.jsx)("i",{className:"bi bi-plus-lg"})}),Object(f.jsxs)(N.a,{onKeyDown:function(e){13===e.keyCode&&g()},tabIndex:"0",buttons:[O],closeButton:!0,size:"md",show:a,setShow:c,title:Object(f.jsx)("span",{children:"Let's create a room"}),children:[Object(f.jsx)(J.a,{children:""}),Object(f.jsx)(L.a,{controlId:"floatingInput",label:"roomId",className:"mb-3",children:Object(f.jsx)(P.a.Control,{ref:t,onChange:function(e){var n;u((null===t||void 0===t||null===(n=t.current)||void 0===n?void 0:n.value.length)>3)},required:!0,name:"roomId",type:"text",placeholder:"roomId"})})]})]})},ee=function(){var e=Object(o.useContext)(l.a),t=Object(o.useState)(!1),n=Object(b.a)(t,2),r=n[0],a=n[1];return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(v.Item,{onClick:function(){return a(1)},label:"Leave room",children:[Object(f.jsx)("i",{className:"bi bi-telephone-x"}),"Leave"]}),Object(f.jsx)(N.a,{buttons:[Object(f.jsx)(z.a,{size:"lg",onClick:function(){return e.leaveRoom()},children:"Yes, leave"})],closeButton:!0,size:"md",show:r,setShow:a,title:Object(f.jsx)("span",{children:"Hey! Are you sure?"}),children:Object(f.jsx)(J.a,{children:"\n            Are you sure you want to leave this room? Any call in progress will be lost and any active stream will be stopped.\n            "})})]})},te=function(){var e=Object(o.useContext)(l.a),t=Object(o.useRef)(null),n=Object(o.useState)(!1),r=Object(b.a)(n,2),a=r[0],c=r[1],i=Object(o.useState)(!1),s=Object(b.a)(i,2),d=s[0],u=(s[1],Object(o.useState)(0)),j=Object(b.a)(u,2),m=j[0],h=j[1];function p(){null!==t&&void 0!==t&&t.current&&a&&e.createRoom(t.current.value.toLowerCase()).then((function(){setTimeout((function(){h(0),c(!1)}),1e3),h(2)})).catch((function(){h(3)}))}var g=Object(f.jsx)(z.a,{disabled:!d,variant:d?"outline-primary":"outline-secondary",onClick:p,children:"Proceed!"});switch(m){case 1:g=Object(f.jsxs)(z.a,{variant:"outline-primary",children:[" ",Object(f.jsx)(M.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})]});break;case 2:g=Object(f.jsx)(z.a,{variant:"outline-success",children:" \u2714\ufe0f Succeed! "});break;case 3:g=Object(f.jsx)(z.a,{variant:"outline-danger",children:" \u274c Error "})}return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(v.Item,{onClick:function(){return c((function(e){return!e}))},children:[Object(f.jsx)("i",{className:"bi bi-magic"}),"Settings"]}),Object(f.jsx)(N.a,{onKeyDown:function(e){13===e.keyCode&&p()},tabIndex:"0",buttons:[g],closeButton:!0,size:"md",show:a,setShow:c,_title:Object(f.jsx)("span",{children:"Settings: Wizard"}),children:Object(f.jsx)(X,{})})]})},ne=function(){var e,t,n,r=Object(o.useContext)(l.a),a=Object(o.useState)(!1),c=Object(b.a)(a,2),i=c[0],s=c[1];return Object(o.useEffect)((function(){}),[null===(e=r.current)||void 0===e?void 0:e.guests]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(v.Item,{onClick:function(){return s((function(e){return!e}))},disabled:!r.current,children:[Object(f.jsx)("i",{className:"bi bi-people"}),"Users"]}),Object(f.jsx)(N.a,{tabIndex:"0",closeButton:!0,size:"md",show:i,setShow:s,title:Object(f.jsx)("span",{children:"Users"}),children:Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{children:null===(t=r.current)||void 0===t?void 0:t.master},-1),null===(n=r.current)||void 0===n?void 0:n.guests.map((function(e,t,n){return Object(f.jsx)("li",{children:e},t)}))]})})]})},re=function(){var e,t,n,r=Object(o.useContext)(l.a),a=Object(o.useState)(!1),c=Object(b.a)(a,2),i=c[0],s=c[1];return Object(o.useEffect)((function(){}),[null===(e=r.current)||void 0===e?void 0:e.guests]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(v.Item,{onClick:function(){return s((function(e){return!e}))},disabled:!r.current,children:[Object(f.jsx)("i",{className:"bi bi-chat-dots"}),"Chat"]}),Object(f.jsx)(N.a,{tabIndex:"0",closeButton:!0,size:"md",show:i,setShow:s,title:Object(f.jsx)("span",{children:"Chat"}),children:Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{children:null===(t=r.current)||void 0===t?void 0:t.master},-1),null===(n=r.current)||void 0===n?void 0:n.guests.map((function(e,t,n){return Object(f.jsx)("li",{children:e},t)}))]})})]})},ae=n(480),oe=function(){var e,t,n=Object(o.useContext)(I.a),r=null!==(e=n.localStream.getAudioTracks())&&void 0!==e?e:[],a=Object(o.useState)(r.every((function(e){return e.enabled}))),c=Object(b.a)(a,2),i=c[0],s=c[1],l=null!==(t=n.localStream.getVideoTracks())&&void 0!==t?t:[],d=Object(o.useState)(l.every((function(e){return e.enabled}))),u=Object(b.a)(d,2),j=u[0],m=u[1];return Object(f.jsx)(f.Fragment,{children:Object(f.jsx)(v.Button,{children:Object(f.jsxs)(ae.a,{children:[Object(f.jsx)(z.a,{onClick:function(){var e=r.every((function(e){return e.enabled=!i,!!e.enabled}));s(e)},children:Object(f.jsx)("i",{className:"bi bi-mic-mute"})}),Object(f.jsx)(z.a,{onClick:function(){var e=l.every((function(e){return e.enabled=!j,!!e.enabled}));m(e)},children:Object(f.jsx)("i",{className:j?"bi bi-camera-video":"bi bi-camera-video-off"})})]})})})};t.a=function(e){Object.assign({},e);var t,n,r=Object(i.g)(),d=Object(o.useContext)(s.a),u=Object(o.useContext)(l.a),b=Object(o.useRef)().current;return/^\/room\/[a-zA-Z0-9]+/.test(r.location.pathname)&&(b=Object(f.jsx)(A,{container:!0})),"/"===r.location.pathname&&(b=Object(f.jsx)(q,{container:!0})),"/settings"===r.location.pathname&&(b=Object(f.jsx)(X,{show:!0,container:!0})),/^\/room\/[a-zA-Z0-9]+\/chat$/.test(r.location.pathname)&&(b=Object(f.jsx)(i.a,{to:"/"})),/^\/room\/[a-zA-Z0-9]+\/users$/.test(r.location.pathname)&&(b=Object(f.jsx)(i.a,{to:"/"})),null!==d&&void 0!==d&&d.isLogged?Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("div",{className:"jsx-147180269 App",children:[Object(f.jsx)(c.a,{fluid:null===(t=b)||void 0===t||null===(n=t.props)||void 0===n?void 0:n.container,id:"content-wrapper",children:b}),Object(f.jsxs)(v,{buttons:u.current?Object(f.jsx)(oe,{}):Object(f.jsx)(Q,{}),children:[u.current?Object(f.jsx)(ee,{}):Object(f.jsxs)(v.Item,{children:[Object(f.jsx)("i",{className:"jsx-147180269 bi bi-house"}),"Lobby"]}),Object(f.jsx)(te,{}),Object(f.jsx)(ne,{}),Object(f.jsx)(re,{})]})]}),Object(f.jsx)(a.a,{id:"147180269",children:["html,body,.App{overflow:hidden;min-height:330px;}","#content-wrapper{height:100%;margin-bottom:6rem;margin-top:3.5rem;overflow-y:scroll;overflow-x:hidden;}","#content-wrapper .container-fluid{margin:0 !important;}","@media only screen and (orientation:landscape) and (max-height:671px){#content-wrapper{margin-bottom:1rem;margin-top:1rem;margin-right:3rem;}}"]})]}):Object(f.jsx)("div",{className:"App",children:Object(f.jsx)(G,{})})}},24:function(e,t,n){"use strict";var r=n(2),a=n(6),o=n(214),c=n(212),i=n(199),s=n(211),l=n(0),d=["children"];t.a=function(e){var t=e.children,n=Object(a.a)(e,d);return Object(l.jsx)(s.a,Object(r.a)({children:t.replaceAll("  ",""),remarkPlugins:[c.a,i.a],rehypePlugins:[o.a]},n))}},26:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var r=n(7),a=n(2),o=n(5),c=n(6),i=n(9),s=n(13),l=n(18),d=n(1),u=n(27),b=n(0),f=["children"],j=Object(d.createContext)();t.b=function(e){var t=e.children,n=(Object(c.a)(e,f),Object(d.useContext)(u.a)),m=Object(l.g)(),h=Object(d.useState)(!1),v=Object(o.a)(h,2),p=v[0],g=v[1],O=Object(d.useState)({}),x=Object(o.a)(O,2),w=x[0],k=x[1],y=Object(d.useState)(null),S=Object(o.a)(y,2),C=S[0],_=S[1];function I(e){var t=e.status,n=e.description,o=e.roomInfo;if("error"===t)return s.b.error("onGetRoom: ".concat(n));k(Object(a.a)(Object(a.a)({},o),{},Object(r.a)({},null===o||void 0===o?void 0:o.id,o)))}function N(e){var t=e.status,n=e.description,r=e.roomInfos;if("error"===t)return s.b.error("onGetRooms: ".concat(n));w=Object(a.a)({},r),k(w),g(!0)}Object(d.useEffect)((function(){if(n.isLogged){i.b.on("get_room_response",I),i.b.on("get_rooms_response",N),i.b.getRooms();var e=setInterval((function(){i.b.getRooms()}),2e3);return function(){i.b.off("get_room_response",I),i.b.off("get_rooms_response",N),clearInterval(e)}}}),[n.isLogged]);var E=window.rooms={joinRoom:function(e){return new Promise((function(t,n){i.b.on("join_room_response",(function r(a){var o=a.status,c=a.description;switch(i.b.off("join_room_response",r),o){case"ok":_(w[e]),s.b.success("Joined room"),t(arguments);break;case"error":var l="onJoinRoom: ".concat(c);s.b.error(l),n(l)}})),i.b.joinRoom(e)}))},leaveRoom:function(){return new Promise((function(e,t){i.b.on("leave_room_response",(function n(r){var a=r.status,o=r.description;switch(i.b.off("leave_room_response",n),a){case"ok":m.push("/"),_(null),s.b.success("Leaved room"),e(arguments);break;case"error":var c="onLeaveRoom: ".concat(o);_(null),m.push("/"),s.b.error(c),t(c)}})),i.b.leaveRoom()}))},createRoom:function(e){return new Promise((function(t,n){i.b.on("create_room_response",(function r(a){var o=a.status,c=a.description;switch(i.b.off("create_room_response",r),o){case"ok":s.b.success("Created room ".concat(e)),m.push("/rooms/".concat(e)),t(arguments);break;case"error":var l="onCreateRoom: ".concat(c);s.b.error(l),n(l)}})),i.b.createRoom(e)}))},getRoomInfo:function(e){return w[e]},setCurrent:_,ready:p,current:C,list:w};return Object(b.jsx)(j.Provider,{value:E,children:t})}},27:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(14),a=n.n(r),o=n(2),c=n(20),i=n(5),s=n(6),l=n(111),d=n(9),u=n(49),b=n(13),f=n(18),j=n(1),m=(n(23),n(100),n(0)),h=["children"],v=Object(j.createContext)();t.b=function(e){var t=e.children,n=(Object(s.a)(e,h),Object(f.g)()),r=(Object(f.h)(null).current,Object(j.useState)(!1)),p=Object(i.a)(r,2),g=p[0],O=p[1],x=Object(j.useState)(!1),w=Object(i.a)(x,2),k=w[0],y=w[1],S=Object(j.useState)({app:!1,rtc:!1}),C=Object(i.a)(S,2),_=C[0],I=C[1],N=Object(j.useState)(null),E=Object(i.a)(N,2),A=E[0],T=E[1],R=Object(j.useState)(null),P=Object(i.a)(R,2),L=P[0],D=(P[1],Object(j.useRef)(null).current),F=Object(j.useRef)(null).current,z=window.auth={user:A,avatar:L,isAdmin:g,isConnected:_.app&&_.rtc,isLogged:k,login:function(e,t){return M.apply(this,arguments)},logout:function(){return J.apply(this,arguments)}};function M(){return(M=Object(c.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=b.b.loading("Logging in..."),t=t.toLowerCase(),e.abrupt("return",l.a.post("".concat("https://admire-dev-auth.brainstorm3d.com","/auth/basic"),{email:t,password:n}).then((function(e){if(404!==e.status)return b.b.success("Success",{id:r}),d.b.login(e.access_token),e.access_token;b.b.error("Error ".concat(e.error,": ").concat(e.message),{id:r})})).catch((function(e){return b.b.error("Error catch: ".concat(e),{id:r})})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(){return(J=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.a.set("admire_app_email",null,-1),u.a.set("admire_app_token",null,-1),e.next=4,d.b.logout();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e){var t=e.status,r=e.userId,a=e.userType,o=e.description,c=e.roomInfo;switch(t){case"ok":if(b.b.success("Logged in as '".concat(r,"'")),T(r),O(null===a||void 0===a||a),y(!0),d.e.register(r),c)return n.push("/room/".concat(c.id));break;case"error":b.b.error(o),u.a.set("admire_app_token",null,-1);break;default:b.b.warn(o)}}function U(){y(!1),b.b.success("Logged out"),d.e.unregister()}return Object(j.useEffect)((function(){function e(){window.removeEventListener("unload",e),d.e.disconnect(),d.b.disconnect()}var t,n,r,a;return window.addEventListener("unload",e),d.b.on("client_connected",t=function(){Object(b.b)("App Connected",{id:D,icon:"\u26a1",duration:2e3}),I((function(e){return Object(o.a)(Object(o.a)({},e),{},{app:!0})}))}),d.e.on("client_connected",r=function(){Object(b.b)("RTC Connected",{id:F,icon:"\u26a1",duration:2e3}),I((function(e){return Object(o.a)(Object(o.a)({},e),{},{rtc:!0})}))}),d.b.on("client_disconnected",n=function(){Object(b.b)("App Disconnected",{id:D,icon:"\u26a0\ufe0f",duration:2e3}),I((function(e){return Object(o.a)(Object(o.a)({},e),{},{app:!1})}))}),d.e.on("client_disconnected",a=function(){Object(b.b)("RTC Disconnected",{id:F,icon:"\u26a0\ufe0f",duration:2e3}),I((function(e){return Object(o.a)(Object(o.a)({},e),{},{rtc:!1})}))}),d.b.on("login_response",V),d.b.on("logout_response",U),function(){d.b.off("client_connected",t),d.b.off("client_disconnected",n),d.e.off("client_connected",r),d.e.off("client_disconnected",a),d.b.off("login_response",V),d.b.off("logout_response",U),e()}}),[]),Object(j.useEffect)((function(){_.app||(D=b.b.loading("Connecting lobby server",{duration:1/0}),d.b.connect("wss://admire-dev-lobby.brainstorm3d.com"))}),[_.app]),Object(j.useEffect)((function(){_.rtc||(F=b.b.loading("Connecting rtc server",{duration:1/0}),d.e.connect("wss://admire-dev-rtc.brainstorm3d.com"))}),[_.rtc]),Object(j.useEffect)((function(){if(_.app&&_.rtc&&!k){var e=u.a.get("admire_app_token");e&&d.b.login(e)}}),[_.app&&_.rtc&&!k]),Object(m.jsx)(v.Provider,{value:z,children:t})}},449:function(e,t,n){var r={"./Devices.jsx":[460,3],"./p1.jsx":[457,4],"./p2.jsx":[458,5],"./p3.jsx":[459,6]};function a(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],a=t[0];return n.e(t[1]).then((function(){return n(a)}))}a.keys=function(){return Object.keys(r)},a.id=449,e.exports=a},451:function(e,t,n){},452:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),o=n(38),c=n.n(o),i=function(e){e&&e instanceof Function&&n.e(7).then(n.bind(null,484)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),o(e),c(e)}))},s=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function l(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var d=n(190),u=n(483),b=n(0);c.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(a.a.Suspense,{children:Object(b.jsx)(d.a,{}),fallback:Object(b.jsx)(u.a,{className:"start-50",animated:!0,now:100})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/admire-pwa",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/admire-pwa","/service-worker.js");s?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):l(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):l(t,e)}))}}(),i()},51:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),a=n(5),o=n(6),c=n(9),i=n(13),s=n(1),l=n(0),d=["children"],u=Object(s.createContext)();t.b=function(e){var t=e.children,n=(Object(o.a)(e,d),Object(s.useRef)(0).current),b=Object(s.useRef)(null),f=Object(s.useState)(null),j=Object(a.a)(f,2),m=j[0],h=j[1],v=Object(s.useState)(null),p=Object(a.a)(v,2),g=p[0],O=p[1],x=Object(s.useState)(null),w=Object(a.a)(x,2),k=w[0],y=w[1],S=Object(s.useReducer)((function(e,t){return b&&b.current&&(b.current.srcObject=t),t}),c.c.getStream()),C=Object(a.a)(S,2),_=C[0],I=C[1];function N(){c.d.getDevices()}function E(e){var t=e.resolutions,n=e.settings;O(Object(r.a)({},n)),y(t)}function A(e){var t=e.audioDevices,n=e.videoDevices,a=e.settings;O(Object(r.a)({},a)),h(Object(r.a)(Object(r.a)({},m),{},{audio:t,video:n}))}function T(e){var t=e.stream,n=e.settings;O(Object(r.a)({},n)),I(t)}function R(e){var t=e.description;i.b.error("Error:",t)}Object(s.useEffect)((function(){function e(){c.d.off("got_stream",T),c.d.off("got_devices",A),c.d.off("error_stream",R),c.d.off("error_devices",R),c.d.off("got_resolutions",E),window.removeEventListener("unload ",e)}return c.d.on("got_stream",T),c.d.on("got_devices",A),c.d.on("error_stream",R),c.d.on("error_devices",R),c.d.on("got_resolutions",E),c.d.start(),N(),window.addEventListener("unload ",e),function(){e()}}),[]);var P=window.media={devices:m,settings:g,resolutions:k,localStream:_,init:function(){n<=0&&N(),++n},stop:function(){--n},getDevices:N,setVideo:function(e,t){c.d.setVideo(e,t)},setAudio:function(e){c.d.setAudio(e)}};return Object(l.jsx)(u.Provider,{value:P,children:t})}},83:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(7),a=n(2),o=n(36),c=n(15),i=n(5),s=n(6),l=n(9),d=n(13),u=n(1),b=n(51),f=n(27),j=n(0),m=["children"],h=Object(u.createContext)();t.b=function(e){var t=e.children,n=(Object(s.a)(e,m),Object(u.useContext)(f.a)),v=Object(u.useContext)(b.a),p=Object(u.useState)({}),g=Object(i.a)(p,2),O=g[0],x=g[1],w=Object(u.useState)({}),k=Object(i.a)(w,2),y=k[0],S=k[1],C=Object(u.useState)(v.localStream),_=Object(i.a)(C,2),I=_[0],N=_[1];function E(e){return l.e.call(e,(function(e){e.callId;var t=e.status,n=e.description;"error"===t&&d.b.error("Call error: ".concat(n))}))}function A(e){l.e.hangup(e)}function T(e){var t=e.callId;e.callerId;l.e.acceptCall(t)}function R(e){var t=e.call,n=e.stream,o=t.callId;x(Object(a.a)(Object(a.a)({},O),{},Object(r.a)({},o,n)));var c=y[o];if(c){var i=O[c];if(!i)return A(o),d.b.error("Live Call Error: ".concat(o,", callerId: ").concat(t.callerId,", calleeId: ").concat(t.calleeId," "));d.b.success("Live Call: ".concat(o,", callerId: ").concat(t.callerId,", calleeId: ").concat(t.calleeId," "));var s=i.getVideoTracks()[0],l=i.getAudioTracks()[0];t.replaceLocalVideoTrack(s),t.replaceLocalAudioTrack(l)}else{d.b.success("Incoming Call: ".concat(o,", callerId: ").concat(t.callerId,", calleeId: ").concat(t.calleeId," "));var u=v.localStream.getVideoTracks()[0],b=v.localStream.getAudioTracks()[0];t.replaceLocalVideoTrack(u),t.replaceLocalAudioTrack(b)}}function P(e){var t=e.call;if(!t)return console.error("No call");var n=t.callId;D(n),delete O[n],x(Object(a.a)({},O)),Object(d.b)("Call ".concat(n," closed"),{icon:"\u26a0\ufe0f"})}function L(e){var t=e.callId;if(!t)return console.error("No call");D(t),delete O[t],x(Object(a.a)({},O)),Object(d.b)("Call ".concat(t," hangup"),{icon:"\u26a0\ufe0f"})}function D(e){for(var t=null,n=0,r=Object.entries(y);n<r.length;n++){var a=Object(i.a)(r[n],2),o=a[0],c=a[1];if(e===o||c===e){t=[o,c];break}}if(t){var s=t,l=Object(i.a)(s,2),d=l[0];l[1];delete y[d],S(y)}}Object(u.useEffect)((function(){return l.e.on(l.a.IncomingCall,T),l.e.on(l.a.CallOpened,R),l.e.on(l.a.CallClosed,P),l.e.on(l.a.UserHangup,L),function(){l.e.off(l.a.IncomingCall,T),l.e.off(l.a.CallOpened,R),l.e.off(l.a.CallClosed,P),l.e.off(l.a.UserHangup,L)}}),[]),Object(u.useEffect)((function(){for(var e in l.e.getCalls()){var t=l.e.getCall(e),n=v.localStream,r=n.getVideoTracks()[0];t.replaceLocalVideoTrack(r);var a=n.getAudioTracks()[0];t.replaceLocalAudioTrack(a)}N(v.localStream)}),[v.localStream]);var F=window.wrtc={callUser:E,callAllUsers:function(e){var t,r,a=[].concat(Object(c.a)(null!==(t=null===e||void 0===e?void 0:e.guests)&&void 0!==t?t:[]),[null===e||void 0===e?void 0:e.master]).filter((function(e,t,r){return e&&e!==n.user})),i=Object(o.a)(a);try{for(i.s();!(r=i.n()).done;){var s=r.value;E(s)||d.b.error("call missed to ".concat(s))}}catch(l){i.e(l)}finally{i.f()}},callHangup:A,callHangupAll:function(){for(var e=0,t=Object.keys(l.e.getCalls());e<t.length;e++){A(t[e])}},forwardCall:function(e,t){if(!t||!e)return console.error("source or target callId's are undefined");y[t]=e,S(Object(a.a)({},y))},getUserId:function(e){var t=n.user,r=l.e.getCalls()[e];if("local"!==e&&r){var a=r.calleeId,o=r.callerId;t=a===n.user?o:a}return t},getLiveCall:function(e){var t;return null!==(t=Object.entries(y).find((function(t){return t[1]===e})))&&void 0!==t?t:[null,null]},streams:Object(a.a)(Object(a.a)({},O),{},{local:I})};return Object(j.jsx)(h.Provider,{value:F,children:t})}},9:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return m})),n.d(t,"b",(function(){return b})),n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return j}));var r=n(14),a=n.n(r),o=n(20),c={ClientConnected:"client_connected",ClientDisconnected:"client_disconnected",IncomingCall:"incoming_call",CallAccepted:"call_accepted",CallCanceled:"call_canceled",CallOpened:"call_opened",CallClosed:"call_closed",UserHangup:"user_hangup"};function i(e,t,n){var r=null,c=[],i={},s=!1,l=function(){var c=Object(o.a)(a.a.mark((function o(){var c;return a.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r){a.next=2;break}return a.abrupt("return");case 2:return c={callId:e,callerId:t,calleeId:n},a.next=5,r.getStats(null).then((function(e){var t=null;return e.forEach((function(e){"candidate-pair"!==e.type||!0!==e.selected&&"succeeded"!==e.state||(t=e)})),t&&e.forEach((function(e){var n,r;e.id===t.localCandidateId&&(c.localType=e.candidateType,c.localAddress=null!==(n=e.address)&&void 0!==n?n:e.ip,c.localPort=e.port,c.localProtocol=e.protocol);e.id===t.remoteCandidateId&&(c.remoteType=e.candidateType,c.remoteAddress=null!==(r=e.address)&&void 0!==r?r:e.ip,c.remotePort=e.port,c.remoteProtocol=e.protocol)})),Promise.resolve(c)}));case 5:return a.abrupt("return",a.sent);case 6:case"end":return a.stop()}}),o)})));return function(){return c.apply(this,arguments)}}();return{get callId(){return e},get callerId(){return t},get calleeId(){return n},bind:function(e,t){return e instanceof RTCPeerConnection&&(s=t,(r=e).addEventListener("datachannel",(function(e){i[e.channel.label]=e.channel,e.channel.addEventListener("onclose",(function(e){delete i[e.channel.label]}))})),!0)},close:function(){var e;null===(e=r)||void 0===e||e.close()},isInitiator:function(){return s},getState:function(){return r?r.iceConnectionState:"closed"},getStats:l,addCandidate:function(e){r?r.addIceCandidate(e):c.push(e)},gatherPendingCandidates:function(){c.length>0&&(c.forEach((function(e){return r.addIceCandidate(e)})),c=[])},setRemoteDescription:function(e){return!!r&&(r.setRemoteDescription(e),!0)},setBandwidth:function(e){if(!r)return!1;var t=r.getSenders();if(!t)return!1;for(var n=0;n<t.length;n++){var a=t[n],o=a.getParameters();o.encodings||(o.encodings=[{}]),o.encodings[0].maxBitrate=1e3*e,a.setParameters(o)}return!0},getRemoteAudioTrack:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!r)return null;var t=r.getReceivers();if(!t)return null;for(var n=[],a=0;a<t.length;a++){var o=t[a];"audio"===o.track.kind&&n.push(o.track)}return e>=0&&e<n.length?n[e]:null},getRemoteVideoTrack:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!r)return null;var t=r.getReceivers();if(!t)return null;for(var n=[],a=0;a<t.length;a++){var o=t[a];"video"===o.track.kind&&n.push(o.track)}return e>=0&&e<n.length?n[e]:null},getRemoteStream:function(){if(!r)return null;var e=r.getReceivers();if(!e)return null;for(var t=[],n=0;n<e.length;n++){var a=e[n];a.track&&t.push(a.track)}if(0===t.length)return null;for(var o=new MediaStream,c=0;c<t.length;c++){var i=t[c];o.addTrack(i)}return o},replaceLocalAudioTrack:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!r||!e)return!1;for(var n=[],a=r.getSenders(),o=0;o<a.length;o++){var c=a[o];c.track&&"audio"===c.track.kind&&n.push(c)}return t>=0&&t<n.length&&(n[t].replaceTrack(e),!0)},replaceLocalVideoTrack:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!r||!e)return!1;for(var n=[],a=r.getSenders(),o=0;o<a.length;o++){var c=a[o];c.track&&"video"===c.track.kind&&n.push(c)}return t>=0&&t<n.length&&(n[t].replaceTrack(e),!0)},openChannel:function(e){if(!r||e in i)return!1;var t=r.createDataChannel(e);return i[e]=t,t.addEventListener("onclose",(function(e){delete i[t.label]})),!0},closeChannel:function(e){return!(!r||!(e in i))&&(i[e].close(),delete i[e],!0)},onDataChannel:function(e){return!!r&&(r.addEventListener("datachannel",e),!0)},onChannelOpen:function(e,t){return!!(r&&e in i&&t instanceof Function)&&(i[e].onopen=t,!0)},onChannelClose:function(e,t){return!!(r&&e in i&&t instanceof Function)&&(i[e].addEventListener("onclose",t),!0)},onChannelError:function(e,t){return!!(r&&e in i&&t instanceof Function)&&(i[e].onerror=t,!0)},onChannelMessage:function(e,t){return!!(r&&e in i&&t instanceof Function)&&(i[e].onmessage=t,!0)},sendData:function(e,t){if(!r||!(e in i))return!1;var n=i[e];return"open"===n.readyState&&(n.send(t),!0)}}}var s=n(7),l=n(2),d=n(5),u=n(36);var b=window.appClient=new function(e){e="object"!==typeof e?{}:e;var t=(e=Object.assign({debug:!1,debugStyle:"background: hsla(0, 0%, 13%, 1); color: hsla(180, 89%, 45%, 1)",pingPeriod:5e3},e)).debug?window.console:null,n={},r=null,a=null,o=null,c=null,i={},s=function(e){var t=[].slice.call(arguments,1);if("object"===typeof n[e])for(var r=n[e].slice(),a=0;a<r.length;a++)r[a].apply(this,t)},l=function(n){f(),null===t||void 0===t||t.log("%cclient_connected%o",e.debugStyle,a.url),s("client_connected",{url:a.url})},d=function(n){var r=JSON.parse(n.data);if(r.id in h){if(!1===h[r.id])return;null===t||void 0===t||t.log("%c%s%o",e.debugStyle,r.id,n.data),h[r.id]instanceof Function&&h[r.id](r),s(r.id,r)}else null===t||void 0===t||t.log("%cunknown_message%o",e.debugStyle,n.data)},u=function(n){var r=JSON.stringify(n);"ping"!==n.id&&(null===t||void 0===t||t.log(" %c%s%o",e.debugStyle,n.id,r)),a.send(r)},b=function(n){window.clearTimeout(o),null===t||void 0===t||t.log("%cclient_disconnected%o",e.debugStyle,a.url),s("client_disconnected",{url:a.url})},f=function n(){a?1===a.readyState?(j(),o=window.setTimeout(n,e.pingPeriod)):null===t||void 0===t||t.error("Connection not open, ready state "+a.readyState):null===t||void 0===t||t.error("Websocket is null")},j=function(){u({id:"ping"})},m=function(e){return!(!e||""===e)&&new RegExp("^([a-zA-Z])(([a-zA-Z0-9]+)([.-_]?))*([a-zA-Z0-9])$").test(e)},h={pong:!1,login_response:function(e){"ok"===e.status&&(c=e.userId)},logout_response:function(e){"ok"===e.status&&(r=null,c=null,null,i={})},get_room_response:!0,get_rooms_response:!0,create_room_response:function(e){"ok"===e.status&&e.roomId},room_created:!0,join_room_response:function(e){"ok"===e.status&&e.roomId},guest_joined_room:!0,user_joined_room:!0,leave_room_response:function(e){"ok"===e.status&&(null,i={})},master_left_room:!0,guest_left_room:!0,user_left_room:!0,room_deleted:!0,enable_channel_response:!0,channel_enabled:!0,disable_channel_response:!0,channel_disabled:function(e){e.userId===c&&e.channelId in i&&delete i[e.channelId]},join_channel_response:function(e){"ok"===e.status&&(i[e.channelId]=!0)},user_joined_channel:!0,leave_channel_response:function(e){"ok"===e.status&&delete i[e.channelId]},user_left_channel:!0,forward_message_response:!0,remote_message:!0};return{on:function(e,t){"object"!==typeof n[e]&&(n[e]=[]),n[e].push(t)},off:function(e,t){if("object"===typeof n[e]){var r=n[e].indexOf(t);r>-1&&n[e].splice(r,1)}},connect:function(e){(a=new WebSocket(e)).onopen=l,a.onmessage=d,a.onclose=b},disconnect:function(){var e;null===(e=a)||void 0===e||e.close()},login:function(e){u({id:"login",token:r=e})},logout:function(){u({id:"logout",token:r})},getRoom:function(){u({id:"get_room",token:r})},getRooms:function(){u({id:"get_rooms",token:r})},createRoom:function(e){return!!m(e)&&(u({id:"create_room",token:r,roomId:e}),!0)},joinRoom:function(e){u({id:"join_room",token:r,roomId:e})},leaveRoom:function(){u({id:"leave_room",token:r})},enableChannel:function(e,t){u({id:"enable_channel",token:r,userId:e,channelId:t})},disableChannel:function(e,t){u({id:"disable_channel",token:r,userId:e,channelId:t})},joinChannel:function(e){u({id:"join_channel",token:r,channelId:e})},leaveChannel:function(e){u({id:"leave_channel",token:r,channelId:e})},forwardMessage:function(e,t){c!==e&&u({id:"forward_message",token:r,userId:e,msg:t})},isDisconnected:function(){return!a||"3"===a.readyState},isLogged:function(e){return!!c&&c===e},isInChannel:function(e){return e in i}}},f=window.mediaAdapter=new function(e){e="object"!==typeof e?{}:e;var t=(e=Object.assign({},{debug:!1,debugStyle:"background: hsla(0, 0%, 13%, 1); color: hsla(13, 89%, 45%, 1)"},e)).debug?window.console:null,n={},r=null,c=null,i=null,b=null,f={},j={},m={Undefined:{width:void 0,height:void 0},"320x240":{width:320,height:240},"640x360":{width:640,height:360},"640x480":{width:640,height:480},"1280x720":{width:1280,height:720},"1920x1080":{width:1920,height:1080},"3840x2160":{width:3840,height:2160},"7680x4320":{width:7680,height:4320}},h={audio:{deviceId:{exact:void 0}}},v={video:{deviceId:{exact:void 0},width:{exact:void 0},height:{exact:void 0},frameRate:{ideal:60}}},p={audio:null,video:null,resolution:null},g=null,O=null,x=function(e){var t=[].slice.call(arguments,1);if("object"===typeof n[e])for(var r=n[e].slice(),a=0;a<r.length;a++)r[a].apply(this,t)},w=function(){var e=Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",y().then(S).catch(C));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(o.a)(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=window.localStorage.getItem("audio")||"None")in f||(t="None",window.localStorage.removeItem("audio")),(n=window.localStorage.getItem("video")||"None")in j||(n="None",window.localStorage.removeItem("video")),e.prev=4,e.next=7,_(t);case 7:return e.prev=7,e.next=10,I(n);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(7),I("None");case 15:e.next=29;break;case 17:return e.prev=17,e.t1=e.catch(4),e.next=21,_("None");case 21:return e.prev=21,e.next=24,I(n);case 24:e.next=29;break;case 26:e.prev=26,e.t2=e.catch(21),I("None");case 29:case"end":return e.stop()}}),e,null,[[4,17],[7,12],[21,26]])})));return function(){return e.apply(this,arguments)}}(),y=function(){return window.navigator.mediaDevices.enumerateDevices()},S=function(n){j={},(f={}).None="",j.None="";var r,a=0,o=0,c=Object(u.a)(n);try{for(c.s();!(r=c.n()).done;){var i=r.value;if("audioinput"===i.kind){var s=""===i.label?"Audio input "+a:i.label;f[s]=i.deviceId,a++}if("videoinput"===i.kind){var l=""===i.label?"Video input "+o:i.label;j[l]=i.deviceId,o++}}}catch(d){c.e(d)}finally{c.f()}null===t||void 0===t||t.log("%cDevice Infos%o",e.debugStyle,JSON.stringify(n)),null===t||void 0===t||t.log("%cgot_devices%o%o%o",e.debugStyle,JSON.stringify(f),JSON.stringify(j),JSON.stringify(p)),null===t||void 0===t||t.log("%cgot_resolutions%o%o",e.debugStyle,JSON.stringify(m),JSON.stringify(p)),x("got_devices",{audioDevices:f,videoDevices:j,settings:p}),x("got_resolutions",{resolutions:m,settings:p})},C=function(n){var r="Device request not allowed in the browser context.";null===t||void 0===t||t.log("%cerror_devices%o%o",e.debugStyle,n,r),x("error_devices",{error:n,description:r})},_=function(n){if(!(n in f))return Promise.resolve(new Error("Device "+n+" doesn't exist"));if(n===p.audio)return Promise.resolve(new Error("Device "+n+" already selected"));if("None"===n)return p.audio=n,window.localStorage.setItem("audio",p.audio),c=A(),b=J(c,i),null===t||void 0===t||t.log("%cgot_stream%o%o",e.debugStyle,b,JSON.stringify(p)),x("got_stream",{stream:b,settings:p}),Promise.resolve(b);g=U(h);var r=f[n];return h.audio.deviceId.exact=r,R()},I=function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"640x480";if(!(n in j))return Promise.resolve(new Error("Device "+n+" doesn't exist"));if(!(r in m))return Promise.resolve(new Error("Resolution "+r+" doesn't exist"));if(n===p.video&&r===p.resolution)return Promise.resolve(new Error("Device "+n+" and resolution "+r+" already selected"));if("None"===n){p.video=n,p.resolution=r,window.localStorage.setItem("video",p.video);var a=m[r].width,o=m[r].height;return i=T(a,o),b=J(c,i),null===t||void 0===t||t.log("%cgot_stream%o%o",e.debugStyle,b,JSON.stringify(p)),x("got_stream",{stream:b,settings:p}),Promise.resolve(b)}O=U(v);var s=j[n];v.video.deviceId.exact=s;var l=m[r].width,d=m[r].height;return v.video.width.exact=l,v.video.height.exact=d,P()},N=function(){var e=new AudioContext,t=e.createGain(),n=e.createOscillator();n.connect(t);var r=t.connect(e.createMediaStreamDestination());return t.gain.setValueAtTime(0,e.currentTime),n.start(),r.stream.getAudioTracks()[0]},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:320,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:240;r||(r=window.document.createElement("canvas")),r.width=e,r.height=t;var n=r.getContext("2d");n.fillRect(0,0,e,t);var a=r.captureStream(),o=a.getVideoTracks()[0];return o},A=function(){return new MediaStream([N()])},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:320,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:240;return new MediaStream([E(e,t)])},R=function(){return null===t||void 0===t||t.log("%cGet Audio Stream%o",e.debugStyle,JSON.stringify(h)),b=null,V(c),window.navigator.mediaDevices.getUserMedia(h).then(L).catch((function(e){throw z(e),e}))},P=function(){return null===t||void 0===t||t.log("%cGet Video Stream%o",e.debugStyle,JSON.stringify(v)),b=null,V(i),window.navigator.mediaDevices.getUserMedia(v).then(D).catch((function(e){throw M(e),e}))},L=function(){var n=Object(o.a)(a.a.mark((function n(r){var o,s;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=r.getAudioTracks()[0],s=o.getSettings(),null===t||void 0===t||t.log("%cAudio Track%o%o",e.debugStyle,JSON.stringify(o.label),JSON.stringify(s)),o.label in f){n.next=6;break}return n.next=6,w();case 6:p.audio=o.label,window.localStorage.setItem("audio",p.audio),b=J(c=r,i),null===t||void 0===t||t.log("%cAudio Constraints%o",e.debugStyle,JSON.stringify(h)),null===t||void 0===t||t.log("%cgot_stream%o%o",e.debugStyle,b,JSON.stringify(p)),x("got_stream",{stream:b,settings:p});case 13:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),D=function(){var n=Object(o.a)(a.a.mark((function n(r){var o,u,f,h,g;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=r.getVideoTracks()[0],u=o.getSettings(),null===t||void 0===t||t.log("%cVideo Track%o%o",e.debugStyle,JSON.stringify(o.label),JSON.stringify(u)),o.label in j){n.next=6;break}return n.next=6,w();case 6:f=u.width,h=u.height,m[g=f+"x"+h]||(m[g]={width:f,height:h},m=Object.entries(m).sort((function(e,t){return(e[1].width||Number.NEGATIVE_INFINITY)>(t[1].width||Number.NEGATIVE_INFINITY)})).reduce((function(e,t){var n=Object(d.a)(t,2),r=n[0],a=n[1];return Object(l.a)(Object(l.a)({},e),{},Object(s.a)({},r,a))}),{}),x("got_resolutions",{resolutions:m,settings:p})),v.video.width.exact=f,v.video.height.exact=h,p.video=o.label,p.resolution=g,window.localStorage.setItem("video",p.video),b=J(c,i=r),null===t||void 0===t||t.log("%cVideo Constraints%o",e.debugStyle,JSON.stringify(v)),null===t||void 0===t||t.log("%cgot_stream%o%o",e.debugStyle,b,JSON.stringify(p)),x("got_stream",{stream:b,settings:p});case 20:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),F=function(e){return("NotFoundError"===e.name||"DevicesNotFoundError"===e.name?"Required track is missing.":"NotReadableError"===e.name||"TrackStartError"===e.name?"Microphone or Webcam are already in use.":"OverconstrainedError"===e.name||"ConstraintNotSatisfiedError"===e.name?"Constraints cannot be satisfied.":"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?"Permission denied in browser.":"TypeError"===e.name||"TypeError"===e.name?"Empty constraints object.":"Unknown error.")+" "+e.message},z=function(n){var r=F(n);null===t||void 0===t||t.log("%cError Constraints%o",e.debugStyle,JSON.stringify(h)),null===t||void 0===t||t.log("%cerror_stream%o%o%o",e.debugStyle,n.name,r,JSON.stringify(p)),x("error_stream",{error:n.name,description:r,settings:p}),g&&(h=U(g),g=null,R())},M=function(n){var r=F(n);null===t||void 0===t||t.log("%cError Constraints%o",e.debugStyle,JSON.stringify(v)),null===t||void 0===t||t.log("%cerror_stream%o%o%o",e.debugStyle,n.name,r,JSON.stringify(p)),x("error_stream",{error:n.name,description:r,settings:p}),O&&(v=U(O),O=null,P())},J=function(e,t){if(!e||!(e instanceof MediaStream))return null;if(!t||!(t instanceof MediaStream))return null;var n=e.getAudioTracks();if(!n||0===n.length)return null;var r=t.getVideoTracks();if(!r||0===r.length)return null;var a=new MediaStream;return a.addTrack(n[0]),a.addTrack(r[0]),a},V=function(e){e&&e instanceof MediaStream&&e.getTracks().forEach((function(e){return e.stop()}))},U=function(e){return JSON.parse(JSON.stringify(e))};return{on:function(e,t){"object"!==typeof n[e]&&(n[e]=[]),n[e].push(t)},off:function(e,t){if("object"===typeof n[e]){var r=n[e].indexOf(t);r>-1&&n[e].splice(r,1)}},start:function(){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return null===t||void 0===t||t.log("%cMedia Devices Error%o",e.debugStyle,"Media devices are not available"),!1;c=A(),i=T(),b=J(c,i);var n=function(){var n=Object(o.a)(a.a.mark((function n(){var r;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=function(n){return null===t||void 0===t?void 0:t.trace("%cMedia Devices Error%o",e.debugStyle,n)},n.next=3,window.navigator.mediaDevices.getUserMedia({audio:!0}).catch(r);case 3:return n.next=5,window.navigator.mediaDevices.getUserMedia({video:!0}).catch(r);case 5:return n.next=7,w().catch(r);case 7:return n.next=9,k().catch(r);case 9:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return n(),!0},findDevices:w,getDevices:y,setAudio:_,setVideo:I}},j=window.dummyStream=new function(){var e=null,t=null,n=null,r=null,a=null;!function(){var e=new AudioContext,n=e.createGain();e.createOscillator().connect(n);var a=n.connect(e.createMediaStreamDestination());t=a.stream,r=t.getAudioTracks()[0]}(),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:320,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:240;e||(e=window.document.createElement("canvas")),e.width=t,e.height=r;var o=e.getContext("2d");o.fillRect(0,0,t,r),n=e.captureStream(),a=n.getVideoTracks()[0]}();var o=new MediaStream([r,a]);return{getAudioTrack:function(){return r},getVideoTrack:function(){return a},getStream:function(){return o}}},m=window.rtcClient=new function(e){var t={debug:!1,debugStyle:"background: hsla(0, 0%, 13%, 1); color: hsla(74, 64%, 60%, 1)",pingPeriod:5e3,defaultStream:new MediaStream};e="object"!==typeof e?{}:e;var n=(e=Object.assign({},t,e)).debug?window.console:null,r={},s={},l={},d=null,u=null,b=null,f={iceServers:null},j=function(e){if(-1==Object.values(c).indexOf(e))return!1;var t=[].slice.call(arguments,1);if("object"===typeof s[e])for(var n=s[e].slice(),r=0;r<n.length;r++)n[r].apply(this,t);return!0},m=function(t){g(),null===n||void 0===n||n.log("%c"+c.ClientConnected+"%o",e.debugStyle,d.url),j(c.ClientConnected,{url:d.url})},h=function(t){b=null,f.iceServers=null,O(),null===n||void 0===n||n.log("%c"+c.ClientDisconnected+"%o",e.debugStyle,d.url),j(c.ClientDisconnected,{url:d.url})},v=function(t){var a=JSON.parse(t.data);if("pong"!==a.id){switch(null===n||void 0===n||n.log(" %c%s%o",e.debugStyle,a.id,t.data),a.id){case"register_response":C(a);break;case"unregister_response":_(a);break;case"call_response":I(a);break;case"incoming_call":N(a);break;case"call_accepted":E(a);break;case"call_canceled":A(a);break;case"remote_offer":T(a);break;case"remote_answer":R(a);break;case"remote_candidate":P(a);break;case"user_hangup":L(a)}if(a.uuid in r){var o=r[a.uuid];delete r[a.uuid],delete a.uuid,o(a)}j(a.id,a)}},p=function(t,a){if(!d||d.readyState!==WebSocket.OPEN)return!1;t.uuid=y(),a instanceof Function&&(r[t.uuid]=a);var o=JSON.stringify(t);return d.send(o),"ping"!==t.id&&(null===n||void 0===n||n.log(" %c%s%o",e.debugStyle,t.id,o)),!0},g=function t(){return d&&d.readyState===WebSocket.OPEN?(x(),u=window.setTimeout(t,e.pingPeriod),!0):(null===n||void 0===n||n.error("WebSocket not opened"),!1)},O=function(){window.clearTimeout(u)},x=function(){return p({id:"ping"})},w=function(e){if(!(e in l))return!1;var t=l[e];return t.close(),delete l[e],j(c.CallClosed,{call:t}),!0},k=function(e,t){if(e)return!!w(e)&&p({id:"hangup",callId:e},t);for(var n in l){if(w(n))p({id:"hangup",callId:n})}return l={},!0},y=function(){return S()},S=function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))},C=function(e){"ok"===e.status&&(b=e.userId,f.iceServers=JSON.parse(e.iceServers))},_=function(e){"ok"===e.status&&(b=null,f.iceServers=null)},I=function(e){if("ok"===e.status){var t=new i(e.callId,e.callerId,e.calleeId);l[t.callId]=t}},N=function(e){var t=new i(e.callId,e.callerId,e.calleeId);l[e.callId]=t},E=function(t){var n=new RTCPeerConnection(f),r=l[t.callId];r.bind(n,!0),n.oniceconnectionstatechange=function(e){D(r)},n.onicecandidate=function(e){if(e.candidate&&""!==e.candidate){var n={id:"candidate",callId:t.callId,callerId:t.callerId,calleeId:t.calleeId,candidate:JSON.stringify(e.candidate)};p(n)}},n.onnegotiationneeded=function(e){n.createOffer().then((function(e){n.setLocalDescription(e);var r={id:"offer",callId:t.callId,callerId:t.callerId,calleeId:t.calleeId,offer:JSON.stringify(e)};p(r)}))},e.defaultStream.getTracks().forEach((function(e){return n.addTrack(e)})),n.createDataChannel("default")},A=function(e){w(e.callId)},T=function(t){var n=new RTCPeerConnection(f),r=l[t.callId];r.bind(n,!1),n.oniceconnectionstatechange=function(e){D(r)},n.setRemoteDescription(JSON.parse(t.offer)),r.gatherPendingCandidates(),n.onicecandidate=function(e){if(e.candidate&&""!==e.candidate){var n={id:"candidate",callId:t.callId,callerId:t.callerId,calleeId:t.calleeId,candidate:JSON.stringify(e.candidate)};p(n)}},e.defaultStream.getTracks().forEach((function(e){return n.addTrack(e)})),window.setTimeout((function(){n.createAnswer().then((function(e){n.setLocalDescription(e);var r={id:"answer",callId:t.callId,callerId:t.callerId,calleeId:t.calleeId,answer:JSON.stringify(e)};p(r)}))}),500)},R=function(e){if(e.callId in l){var t=JSON.parse(e.answer);l[e.callId].setRemoteDescription(t)}},P=function(e){var t=JSON.parse(e.candidate);t&&t.candidate&&""!==t.candidate&&(e.callId in l&&l[e.callId].addCandidate(t))},L=function(e){w(e.callId)},D=function(){var t=Object(o.a)(a.a.mark((function t(r){var o,i;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=r.getState(),null===n||void 0===n||n.log("%cConnection State%o%o",e.debugStyle,r.callId,o),t.t0=o,t.next="failed"===t.t0||"disconnected"===t.t0||"closed"===t.t0?5:"new"===t.t0||"checking"===t.t0||"completed"===t.t0?7:"connected"===t.t0?8:12;break;case 5:return k(r.callId),t.abrupt("break",12);case 7:return t.abrupt("break",12);case 8:return i=r.getRemoteStream(),null===n||void 0===n||n.log("%c"+c.CallOpened+"%o%o",e.debugStyle,r.callId,i),j(c.CallOpened,{call:r,stream:i}),t.abrupt("break",12);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return{on:function(e,t){return-1!=Object.values(c).indexOf(e)&&(t instanceof Function&&("object"!==typeof s[e]&&(s[e]=[]),s[e].push(t),!0))},off:function(e,t){if(-1==Object.values(c).indexOf(e))return!1;if(!(t instanceof Function))return!1;if("object"===typeof s[e]){var n=s[e].indexOf(t);if(n>-1)return s[e].splice(n,1),!0}return!1},getCall:function(e){return e in l?l[e]:null},getCalls:function(){return l},connect:function(e){d&&d.readyState!=WebSocket.CLOSED?null===n||void 0===n||n.error("WebSocket not closed"):((d=new WebSocket(e)).onopen=m,d.onmessage=v,d.onclose=h)},disconnect:function(){var e;d&&d.readyState!=WebSocket.OPEN?null===(e=d)||void 0===e||e.close():null===n||void 0===n||n.error("WebSocket not opened")},register:function(e,t){return b?(null===n||void 0===n||n.error("Client already registered"),!1):p({id:"register",userId:e},t)},unregister:function(e){return b?(k(),p({id:"unregister",userId:b},e)):(null===n||void 0===n||n.error("Client not registered"),!1)},call:function(e,t){return b===e?(null===n||void 0===n||n.error("Invalid user id "+e),!1):p({id:"call",callerId:b,calleeId:e},t)},acceptCall:function(e,t){if(!(e in l))return null===n||void 0===n||n.error("Call "+e+" not found"),!1;var r=l[e],a={id:"accept_call",callId:r.callId,callerId:r.callerId,calleeId:r.calleeId};return p(a,t)},cancelCall:function(e,t){if(!(e in l))return null===n||void 0===n||n.error("Call "+e+" not found"),!1;var r=l[e];delete l[e];var a={id:"cancel_call",callId:r.callId,callerId:r.callerId,calleeId:r.calleeId};return p(a,t)},hangup:k}}({debug:!0,defaultStream:j.getStream()});b.DEBUG=!1,m.DEBUG=!1,f.DEBUG=!1}},[[452,1,2]]]);
//# sourceMappingURL=main.89e31e83.chunk.js.map