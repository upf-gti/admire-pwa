(this["webpackJsonpadmire-pwa"]=this["webpackJsonpadmire-pwa"]||[]).push([[0],{103:function(e,t,n){"use strict";t.a=n.p+"static/media/profile_light.7c82d8ab.png"},130:function(e,t,n){"use strict";t.a=n.p+"static/media/logo.f23962e9.png"},157:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n(1);var a=n(10),r=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function o(e){if("serviceWorker"in navigator){if(new URL("/admire-pwa",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/admire-pwa","/service-worker.js");r?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):c(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):c(t,e)}))}}function c(e,t){navigator.serviceWorker.register(e).then((function(e){setInterval((function(){e.update(),console.debug("Checked for update...")}),3e5),e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),a.b.info("Update available! To update, close all windows and reopen.",{toastId:"appUpdateAvailable",onClick:function(){return window.close()},autoClose:!1}),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}},158:function(e,t,n){"use strict";var a=n(2),r=n(6),o=n(7),c=n(17),i=n.n(c),s=n(44),l=n(1),d=n(0),u=["id","stream","onClick","isLocal"];t.a=function(e){var t,n=e.id,c=e.stream,m=e.onClick,b=e.isLocal,f=void 0!==b&&b,j=Object(o.a)(e,u),h=Object(l.useRef)(null),p=Object(l.useState)({audio:!0}),v=Object(r.a)(p,2),O=v[0],x=v[1];return Object(l.useEffect)((function(){c&&h.current&&(h.current.srcObject=c)}),[c]),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{className:"jsx-1120049185 "+"Video ".concat(null!==(t=j.className)&&void 0!==t?t:""),children:[Object(d.jsxs)("div",{className:"jsx-1120049185 stream-status position-absolute bottom-0 start-0",children:[Object(d.jsxs)("span",{className:"jsx-1120049185 status-user",children:[" ",n," "]}),Object(d.jsx)(s.a,{className:"status-audio",variant:"link",disabled:f,onClick:function(){x(Object(a.a)(Object(a.a)({},O),{},{audio:!O.audio}))},children:f?Object(d.jsx)("i",{className:"jsx-1120049185 "+"bi bi-mic".concat(!f&&null!==O&&void 0!==O&&O.audio?"":"-mute")}):Object(d.jsx)("i",{className:"jsx-1120049185 "+"fs-4 bi bi-volume".concat(!f&&null!==O&&void 0!==O&&O.audio?"-down":"-mute")})})]}),Object(d.jsx)("video",{autoPlay:!0,playsInline:!0,muted:f||!(null!==O&&void 0!==O&&O.audio),ref:h,onClick:m,className:"jsx-1120049185"})]}),Object(d.jsx)(i.a,{id:"1120049185",children:[".Video{position:relative;margin:1px;padding:0;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out;background-color:#333;}",".Video:hover,.Video .selected{opacity:0.55;cursor:pointer;}",".Video .stream-status{color:white !important;z-index:1000;}",".Video .stream-status .status-user{padding:0rem 0.5rem;padding-right:0;}",".Video .stream-status .status-audio{color:white !important;cursor:pointer;padding:0;margin-bottom:-1.2rem;margin-top:-1.4rem;margin-left:-0.2rem;}",".Video video{width:calc(100% + 2px);height:100%;object-fit:cover;margin-bottom:-9px;-webkit-transform:rotateY(180deg);-ms-transform:rotateY(180deg);transform:rotateY(180deg);-webkit-transform:rotateY(180deg);-moz-transform:rotateY(180deg);}"]})]})}},195:function(e,t,n){"use strict";(function(e){var a=n(2),r=n(7),o=n(17),c=n.n(o),i=n(196),s=n(10),l=n(59),d=n(20),u=n(219),m=n(211),b=n(212),f=n(213),j=n(214),h=n(215),p=n(216),v=(n(461),n(462),n(22)),O=n(61),x=n(46),g=n(26),w=n(0),k=["children"];window.toast=s.b;var y=s.b.error;s.b.error=function(e,t){return console.trace(e),y(e,t)};var C=s.b.success;s.b.success=function(e,t){return console.log(e),C(e,t)};var S=s.b.loading;s.b.loading=function(e,t){return console.log(e),S(e,t)};var N=s.b.custom;s.b.custom=function(e,t){return console.log(e),N(e,t)},t.a=function(t){t.children;var n=Object(r.a)(t,k);return Object(w.jsxs)("div",Object(a.a)(Object(a.a)({id:"layout"},n),{},{className:"jsx-3991789039 "+(n&&null!=n.className&&n.className||""),children:[Object(w.jsx)(s.a,{id:"toaster",position:"bottom-right",reverseOrder:!0,toastOptions:{duration:2e3,style:{background:"#333",color:"#fff"}}}),Object(w.jsx)(l.a,{basename:"admire-pwa",children:Object(w.jsx)(g.b,{children:Object(w.jsx)(v.b,{children:Object(w.jsx)(x.b,{children:Object(w.jsxs)(O.b,{children:[Object(w.jsxs)(i.a,{children:[Object(w.jsx)("title",{className:"jsx-3991789039",children:"admire"}),Object(w.jsx)("meta",{property:"og:url",content:"http://www.admire3d.eu/",className:"jsx-3991789039"}),Object(w.jsx)("meta",{property:"og:type",content:Object({NODE_ENV:"production",PUBLIC_URL:"/admire-pwa",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://admire-dev-auth.brainstorm3d.com",REACT_APP_APP_URL:"wss://admire-dev-lobby.brainstorm3d.com",REACT_APP_BASE:"admire-pwa",REACT_APP_COOKIES_EXPIRE_TIME:"30",REACT_APP_DEBUG:"true",REACT_APP_NAME:"admire",REACT_APP_OG_DESC:"Advanced Mixed Realities",REACT_APP_OG_IMAGE:"http://www.admire3d.eu/wp-content/uploads/2021/02/admire.jpg",REACT_APP_OG_TITLE:"AdMiRe",REACT_APP_OG_URL:"http://www.admire3d.eu/",REACT_APP_RTC_URL:"wss://admire-dev-rtc.brainstorm3d.com"}).REACT_APP_OG_TYPE,className:"jsx-3991789039"}),Object(w.jsx)("meta",{property:"og:title",content:"AdMiRe",className:"jsx-3991789039"}),Object(w.jsx)("meta",{property:"og:description",content:"Advanced Mixed Realities",className:"jsx-3991789039"}),Object(w.jsx)("meta",{property:"og:image",content:e.envREACT_APP_OG_IMAGE,className:"jsx-3991789039"})]}),Object(w.jsx)(p.a,{}),Object(w.jsxs)("div",{className:"jsx-3991789039 z-top d-flex m-2 position-absolute top-0 end-0",children:[Object(w.jsx)(j.a,{}),Object(w.jsx)(f.a,{}),Object(w.jsx)(h.a,{})]}),Object(w.jsxs)(d.d,{children:[Object(w.jsx)(d.b,{component:u.a,exact:!0,path:["/","/settings","/about","/users","/chat","/profile","/room/:roomId","/room/:roomId/chat","/room/:roomId/guests"]}),Object(w.jsx)(d.b,{component:m.a,exact:!0,path:"/verify/:token"}),Object(w.jsx)(d.b,{component:b.a,exact:!0,path:"/reset-password/:token"}),Object(w.jsxs)(d.b,{children:[" ",Object(w.jsx)(d.a,{to:"/"})," "]})]})]})})})})}),Object(w.jsx)(c.a,{id:"3991789039",children:["#layout{text-align:center;background:#1B222E;}","#title{color:#D1D3D5;-webkit-filter:invert(0.5) brightness(0.5);filter:invert(0.5) brightness(0.5);mix-blend-mode:luminosity;}",".z-top{z-index:1000;}"]})]}))}}).call(this,n(137))},21:function(e,t,n){"use strict";var a=n(2),r=n(7),o=n(17),c=n.n(o),i=(n(1),n(106)),s=n(44),l=n(0),d=["title","children","show","setShow","callback","buttons","closeButton"];t.a=function(e){var t=e.title,n=e.children,o=e.show,u=e.setShow,m=(e.callback,e.buttons),b=e.closeButton,f=Object(r.a)(e,d);function j(){u(!1)}return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)(i.a,Object(a.a)(Object(a.a)({centered:!0,show:o,keyboard:!0,onHide:j,dialogClassName:"modal-partial modal-shadow-lg"},f),{},{children:[b&&t&&Object(l.jsx)(i.a.Header,{closeButton:b,children:Object(l.jsx)(i.a.Title,{className:"user-select-none",children:t})}),Object(l.jsx)(i.a.Body,{children:n}),(m||b)&&Object(l.jsxs)(i.a.Footer,{className:"flex-nowrap",children:[m&&m.map((function(e,t,n){return e})),b&&Object(l.jsx)(s.a,{variant:"outline-secondary",onClick:j,children:" Close"})]})]})),Object(l.jsx)(c.a,{id:"1168318629",children:['@charset "UTF-8";',".modal-dialog{max-height:calc(100vh - 1rem);outline:none !important;}",".modal-partial.modal-shadow-lg.modal-md.modal-dialog-centered:focus-visible{outline:none;}",".modal-content{max-height:90vh;}",".modal-lg>.modal-content{min-height:50vh;}",'.modal-partial .modal-title{font-weight:lighter;font-family:"Comfortaa",sans-serif;}',".modal-partial .modal-title h1,.modal-partial .modal-title h2,.modal-partial .modal-title h3,.modal-partial .modal-title h4,.modal-partial .modal-title h5,.modal-partial .modal-title h6{padding:0;margin:0;}",".modal-partial .modal-header{padding-bottom:.2em;}",".modal-partial .modal-footer{padding:0 0.75rem;}","@media only screen and (min-width:321px){}","@media only screen and (orientation:landscape) and (max-height:671px){.modal-md{max-width:800px !important;}}","@media only screen and (orientation:landscape) and (max-height:671px) and (max-width:674px){.modal-dialog{margin-right:6.5rem !important;}}"]})]})}},211:function(e,t,n){"use strict";var a=n(44),r=n(20),o=n(27),c=n(21),i=n(0);t.a=function(){var e=Object(r.g)();function t(){e.push("/")}return Object(i.jsx)(i.Fragment,{children:Object(i.jsx)(c.a,{size:"md",show:!0,title:Object(i.jsx)("h2",{className:"user-select-none",children:"User verified!\ud83c\udf89\ud83c\udf89"}),closeButton:!0,backdrop:"static",onHide:t,buttons:[Object(i.jsx)(a.a,{onClick:t,children:"Return to Loggin"})],children:Object(i.jsx)(o.a,{className:"user-select-none",children:"Account verified successfully in the system. You can now login on the application."})})})}},212:function(e,t,n){"use strict";var a=n(12),r=n.n(a),o=n(15),c=n(8),i=n(2),s=n(6),l=n(10),d=n(1),u=n(20),m=n(468),b=n(466),f=n(44),j=n(34),h=n(52),p=n(30),v=n(27),O=n(21),x=n(0);t.a=function(){var e,t=Object(u.h)().token,n=Object(u.g)(),a=Object(d.useRef)(null),g=Object(d.useState)(void 0),w=Object(s.a)(g,2),k=w[0],y=w[1],C=Object(d.useState)({formErrors:{}}),S=Object(s.a)(C,2),N=S[0],E=S[1];function R(e){return A.apply(this,arguments)}function A(){return(A=Object(o.a)(r.a.mark((function e(a){var o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),o=l.b.loading("Resetting password..."),c=N.password,e.next=5,p.a.post("".concat("https://admire-dev-auth.brainstorm3d.com","/reset-password/").concat(t),{data:{password:c}}).then((function(e){var t=e.error,a=e.message;if(t)return l.b.error("onResetPassword: ".concat(a),{id:o});l.b.success("Success",{id:o}),setTimeout((function(){return n.push("/")}),1e3)})).catch((function(e){l.b.error("Error: ".concat(e),{id:o})}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(d.useEffect)((function(){!function(){var e=!0;for(var t in N)-1!==t.indexOf("_check")&&(e&=N[t]);y(!!e)}()}),[N]),Object(d.useEffect)((function(){y(!1)}),[]),Object(x.jsx)(x.Fragment,{children:Object(x.jsx)(O.a,{closeButton:!0,show:!0,setShow:function(){return n.push("/")},onHide:function(){return n.push("/")},title:Object(x.jsx)("h2",{className:"user-select-none",children:"Reset password"}),buttons:[Object(x.jsx)(m.a,{placement:"bottom",overlay:Object(x.jsx)(b.a,{className:"".concat(k?"d-none":""," mt-2"),id:"tooltip-bottom",children:"Check form errors"}),children:Object(x.jsx)(f.a,{type:"submit",onClick:R,disabled:!k,children:" Proceed "})})],children:Object(x.jsxs)(j.a,{validated:k,onSubmit:R,ref:a,children:[Object(x.jsx)(v.a,{className:"user-select-none",children:"Please enter your new password."}),Object(x.jsx)(h.a,{controlId:"floatingPassword",label:"New Password",children:Object(x.jsx)(j.a.Control,{required:!0,name:"password",type:"password",placeholder:" ",onChange:function(e){!function(e,t){var n=!1,a=N.formErrors;switch(e){case"email":n=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t),a[e]=n?"":" is invalid";break;case"password":n=/^[a-zA-Z]+(.){7,20}$/.test(t),a[e]=n?"":" is too short";break;default:console.warn("Invalid field name: ",e)}E((function(r){var o;return Object(i.a)(Object(i.a)({},r),{},(o={},Object(c.a)(o,e,t),Object(c.a)(o,"".concat(e,"_check"),n),Object(c.a)(o,"formErrors",a),o))}))}(e.target.name,e.target.value)},defaultValue:null!==(e=N.password)&&void 0!==e?e:""})})]})})})}},213:function(e,t,n){"use strict";var a=n(12),r=n.n(a),o=n(15),c=n(2),i=n(6),s=n(1),l=n(44),d=n(21),u=n(27),m=n(0);t.a=function(){var e=Object(s.useState)(!1),t=Object(i.a)(e,2),n=t[0],a=t[1],b=Object(s.useReducer)((function(e,t){return t}),{proposalEvent:void 0}),f=Object(i.a)(b,2),j=f[0],h=f[1];function p(e){e.preventDefault(),h((function(t){return Object(c.a)(Object(c.a)({},t),{},{e:e})}))}function v(){return(v=Object(o.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==j&&void 0!==j&&j.proposalEvent){e.next=2;break}return e.abrupt("return");case 2:return j.proposalEvent.prompt(),e.next=5,j.proposalEvent.userChoice;case 5:t=e.sent,"accepted"===t.outcome&&h((function(e){return Object(c.a)(Object(c.a)({},e),{},{proposalEvent:void 0})}));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){return window.addEventListener("beforeinstallprompt",p,0),function(){window.removeEventListener("beforeinstallprompt",p,0)}}),[]),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(l.a,{variant:"link",onClick:function(){return a(1)},children:"About"}),Object(m.jsx)(d.a,{closeButton:!0,size:"md",show:n,setShow:a,title:Object(m.jsxs)("span",{children:["admire"," - Offline capable ",Object(m.jsxs)(l.a,{variant:"".concat(j.proposalEvent?"outline-primary":"outline-secondary"),size:"sm",onClick:function(){return v.apply(this,arguments)},disabled:!j.proposalEvent,children:[" ","".concat(j.proposalEvent?"Install PWA":"Not available")]})]}),children:Object(m.jsx)(u.a,{children:'\n        An offline-capable AdMiRe version is available, wich is a [Progressive Web App](https://docs.microsoft.com/en-us/microsoft-edge/progressive-web-apps-chromium/).\n\n        The app serves the following features:\n        - Offline-capable (with [Service Workers](https://developers.google.com/web/fundamentals/primers/service-workers/))\n        - "Add to Home Screen" feature on Android and iOS supported devices to launch the app from the home screen.\n        - Dark Mode.\n        - Privacy-focused - We don\'t collect any personal data.\n        - Lightweight - The app is only ~5MB.\n\n        Hope you liked using this app!\n        \n        '})})]})}},214:function(e,t,n){"use strict";var a=n(12),r=n.n(a),o=n(15),c=n(6),i=n(17),s=n.n(i),l=n(1),d=n(44),u=n(467),m=n(464),b=n(90),f=n(222),j=n(34),h=n(52),p=n(21),v=n(27),O=n(26),x=n(103),g=n(10),w=n(0);t.a=function(){var e,t,n=Object(l.useRef)(null),a=Object(l.useContext)(O.a),i=Object(l.useState)(!1),k=Object(c.a)(i,2),y=k[0],C=k[1];function S(){return(S=Object(o.a)(r.a.mark((function e(){var t,o,i,s,l,d,u,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==n&&void 0!==n&&n.current&&y){e.next=2;break}return e.abrupt("return");case 2:t=Array.from(n.current.elements).map((function(e){return e.value})),o=Object(c.a)(t,7),i=o[0],s=o[1],o[2],l=o[3],d=o[4],u=o[5],m=o[6],a.updateUserInfo({username:i,email:s,avatar:l,name:d,surname:u,birthdate:m});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return(N=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Array.from(n.current.elements).foreach((function(e){})),g.b.success("User info restored");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return a.isLogged?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(d.a,{variant:"link",onClick:function(){return C(1)},children:"Profile"}),Object(w.jsx)(p.a,{closeButton:!0,size:"lg",show:y,setShow:C,buttons:[Object(w.jsxs)(d.a,{onClick:a.logout,children:[Object(w.jsx)("i",{className:"jsx-1586328328 bi bi-power"})," Log me out"]}),Object(w.jsx)("div",{align:"center",className:"jsx-1586328328 fw-bolder",children:Object(w.jsxs)(u.a,{children:[Object(w.jsx)(d.a,{onClick:function(){return S.apply(this,arguments)},variant:"outline-primary",children:"Save"}),Object(w.jsx)(d.a,{onClick:function(){return N.apply(this,arguments)},variant:"outline-secondary",children:"Discard"})]})})],children:Object(w.jsxs)(m.a,{children:[Object(w.jsxs)(b.a,{xs:6,children:[Object(w.jsx)(b.a,{xs:"auto",className:"text-center mb-2",children:Object(w.jsx)(f.a,{id:"avatar-img",src:null!==(e=a.user)&&void 0!==e&&e.avatar.length?null===(t=a.user)||void 0===t?void 0:t.avatar:x.a,roundedCircle:!0,width:"128",height:"128"})}),Object(w.jsx)(b.a,{children:Object(w.jsx)(v.a,{className:"user-select-none",children:"\n                # Welcome ".concat(a.user.username,"!\n                This panel is where you can change your profile information. You can also change your password.\n                If you have any questions, please contact us.\n                ")})})]}),Object(w.jsx)(b.a,{xs:6,children:Object(w.jsxs)(j.a,{ref:n,children:[Object(w.jsx)(j.a.Group,{className:"mb-1",children:Object(w.jsxs)(h.a,{label:"username",children:["     ",Object(w.jsx)(j.a.Control,{disabled:!0,name:"username",placeholder:"username",defaultValue:a.user.username,type:"text"}),"      "]})}),Object(w.jsx)(j.a.Group,{className:"mb-1",children:Object(w.jsxs)(h.a,{label:"email",children:["        ",Object(w.jsx)(j.a.Control,{disabled:!0,name:"email",placeholder:"email",defaultValue:a.user.email,type:"email"}),"      "]})}),Object(w.jsx)(j.a.Group,{className:"mb-1",children:Object(w.jsxs)(h.a,{label:"password",children:["     ",Object(w.jsx)(j.a.Control,{disabled:!0,name:"password",placeholder:"password",defaultValue:a.user,type:"password"}),"      "]})}),Object(w.jsx)(j.a.Group,{className:"mb-1",children:Object(w.jsxs)(h.a,{label:"avatar URL",children:["   ",Object(w.jsx)(j.a.Control,{disabled:!0,name:"avatar",placeholder:"avatar URL",defaultValue:a.user.avatar,type:"avatar"}),"      "]})}),Object(w.jsx)(j.a.Group,{className:"mb-1",children:Object(w.jsxs)(h.a,{label:"name",children:["         ",Object(w.jsx)(j.a.Control,{disabled:!0,name:"name",placeholder:"name",defaultValue:a.user.name,type:"text"}),"      "]})}),Object(w.jsx)(j.a.Group,{className:"mb-1",children:Object(w.jsxs)(h.a,{label:"surname",children:["      ",Object(w.jsx)(j.a.Control,{disabled:!0,name:"surname",placeholder:"surname",defaultValue:a.user.surname,type:"text"}),"      "]})}),Object(w.jsx)(j.a.Group,{className:"mb-1",children:Object(w.jsxs)(h.a,{label:"birthddate",children:["   ",Object(w.jsx)(j.a.Control,{disabled:!0,name:"birthdate",placeholder:"birthdate",defaultValue:a.user.birthdate,type:"date"}),"      "]})})]})})]})}),Object(w.jsx)(s.a,{id:"1586328328",children:[]})]}):Object(w.jsx)(w.Fragment,{})}},215:function(e,t,n){"use strict";var a=n(6),r=n(105),o=n(44),c=n(1),i=n(0);t.a=function(){var e=Object(c.useState)(0),t=Object(a.a)(e,2),n=t[0],s=t[1];return Object(c.useEffect)((function(){var e=function(){return s(++n)};return r.a.on("change",e),function(){r.a.off("change",e)}}),[]),Object(i.jsx)("div",{id:"btn_fullscreen",children:r.a.isEnabled&&Object(i.jsxs)(o.a,{onClick:function(){r.a.toggle()},variant:"link",children:[document.fullscreen&&Object(i.jsx)("i",{className:"bi bi-fullscreen-exit"}),!document.fullscreen&&Object(i.jsx)("i",{className:"bi bi-fullscreen"})]})})}},216:function(e,t,n){"use strict";var a=n(17),r=n.n(a),o=n(1),c=n(222),i=n(130),s=n(22),l=n(0);t.a=function(){var e,t=Object(o.useContext)(s.a);return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)("div",{id:"title",variant:"none",className:"jsx-3295336729 d-flex m-3 position-absolute top-0 start-0 user-select-none",children:[Object(l.jsx)(c.a,{className:"me-2",width:32,height:32,src:i.a}),Object(l.jsx)("h1",{id:"app-name",className:"jsx-3295336729 fs-3",children:"admire"}),(null===t||void 0===t?void 0:t.current)&&Object(l.jsxs)("h1",{className:"jsx-3295336729 fs-3",children:[" #",null===t||void 0===t||null===(e=t.current)||void 0===e?void 0:e.name]})]}),Object(l.jsx)(r.a,{id:"3295336729",children:["@media only screen and (orientation:portrait){#app-name{display:none;}}"]})]})}},219:function(e,t,n){"use strict";var a=n(17),r=n.n(a),o=n(1),c=n(492),i=n(20),s=n(26),l=n(22),d=n(2),u=n(7),m=n(0),b=["children","icon","disabled","to"],f=["children"];function j(e){var t=e.children;return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("div",{style:{zIndex:1e3},className:"jsx-951794849 nav-partial px-3 mb-1 d-flex justify-content-evenly align-items-center position-absolute start-50 translate-middle-x shadow rounded-5 bg-light",children:t.map((function(e,t){return e&&Object(m.jsx)("div",{className:"jsx-951794849",children:e},"nav-i-"+t)}))}),Object(m.jsx)(r.a,{id:"951794849",children:[".rounded-5{border-radius:.5em;}",".nav-partial{min-width:1rem;min-height:1rem;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out;bottom:15px !important;}",".nav-button,.nav-item{color:#494E58;cursor:pointer;height:100%;width:auto;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out;}",".nav-button i,.nav-item i{-webkit-transform:scale(1.5);-ms-transform:scale(1.5);transform:scale(1.5);width:50px;overflow:hidden;padding:0;margin:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-transform:capitalize;}",".nav-button:hover,.nav-item:hover{color:#eb5a4f;}",".nav-item{height:44px;}",".nav-item-active{color:red !important;}",".nav-item-disabled{opacity:.35;-webkit-user-select:none !important;-moz-user-select:none !important;-ms-user-select:none !important;user-select:none !important;pointer-events:none;cursor:not-allowed;}",".nav-item-disabled:hover{opacity:.35;}",".nav-button{color:black !important;height:3.5rem;width:3.5rem;line-height:3rem;margin-top:-1.5rem;margin-bottom:1.5rem;}",".nav-button:hover{color:#fdf1f0 !important;}",".dark-mode.navpartial,.dark-mode .nav-partial{background-color:transparent !important;border:1px solid rgba(255,255,255,0.25);}",".dark-mode.navpartial .nav-item,.dark-mode .nav-partial .nav-item{color:gray;}",".dark-mode.navpartial .nav-item:hover,.dark-mode .nav-partial .nav-item:hover{color:#eb5a4f;-webkit-filter:saturate(120%) drop-shadow(0 0 0.1rem #d62518);filter:saturate(120%) drop-shadow(0 0 0.1rem #d62518);}",".dark-mode.navpartial .nav-button,.dark-mode .nav-partial .nav-button{-webkit-filter:saturate(80%);filter:saturate(80%);background:#2A313C !important;line-height:2.8rem;border:2px solid #d62518;color:#d62518 !important;}",".dark-mode.navpartial .nav-button:hover,.dark-mode .nav-partial .nav-button:hover{-webkit-filter:saturate(120%) drop-shadow(0 0 0.1rem #d62518);filter:saturate(120%) drop-shadow(0 0 0.1rem #d62518);color:#d62518 !important;border:2px solid #d62518;}","@media only screen and (orientation:landscape) and (max-height:671px){.nav-partial{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;left:100% !important;-webkit-transform:translate(-100%,0%) !important;-ms-transform:translate(-100%,0%) !important;transform:translate(-100%,0%) !important;margin-left:-1.1rem;padding:1.251rem 0 !important;}.nav-partial .nav-button{margin:0;margin-left:-1.5rem;margin-right:1.5rem;}}"]})]})}j.Item=function(e){var t,n=e.children,a=(e.icon,e.disabled),r=e.to,o=Object(u.a)(e,b);return Object(m.jsx)("div",Object(d.a)(Object(d.a)({to:null!==r&&void 0!==r?r:"/",className:"nav-item ".concat(a?"nav-item-disabled":""," ").concat(null!==(t=o.appendclass)&&void 0!==t?t:"")},o),{},{children:Object(m.jsx)("div",{className:"d-flex flex-column fs-6 fw-lighter",children:n})}))},j.Button=function(e){var t,n=e.children,a=Object(u.a)(e,f);return Object(m.jsx)("div",Object(d.a)(Object(d.a)({className:"nav-button ".concat(null!==(t=a.appendclass)&&void 0!==t?t:"")},a),{},{children:Object(m.jsx)("div",{className:" pt-1 fs-1 fw-lighter",children:n})}))};var h=j,p=n(6),v=n(464),O=n(90),x=n(44),g=n(491),w=n(158),k=n(61),y=n(46),C=n(10),S=n(490),N=n(52),E=n(34),R=n(21),A=function(e){var t,n=e.callId,a=e.isForwardCall,r=Object(o.useContext)(k.a),c=Object(o.useRef)(null),i=Object(o.useState)(null),s=Object(p.a)(i,2),l=s[0],d=s[1],u=Object(o.useState)(0),b=Object(p.a)(u,2),f=b[0],j=b[1],h=r.getLiveCall(n),v=Object(p.a)(h,2),O=v[0];v[1];function w(){if(null===c||void 0===c||!c.current||!l)return d(!1);j(!0);var e=[n,c.current.value],t=e[0],a=e[1];r.callUser(a,(function(e){e.event;var n=e.data,a=n.callid,o=(n.callee,n.caller,n.error),c=n.message;o?(j(3),setTimeout((function(){j(0)}),2e3),C.b.error("Mediahub Call response error: ".concat(c),{duration:5e3})):(j(2),setTimeout((function(){j(0),d(!1)}),1e3),r.forwardCall(t,a))}),t)||(j(3),C.b.error("call missed to backend"),setTimeout((function(){j(0)}),2e3))}switch(f){case 1:t=Object(m.jsxs)(x.a,{variant:"outline-primary",children:[" ",Object(m.jsx)(S.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})]});break;case 2:t=Object(m.jsx)(x.a,{variant:"outline-success",children:"Done"});break;case 3:t=Object(m.jsx)(x.a,{variant:"outline-danger",children:"Error"});break;default:t=Object(m.jsx)(x.a,{variant:"outline-primary",onClick:w,children:"Proceed"})}return Object(m.jsxs)(m.Fragment,{children:[a?Object(m.jsx)(g.a,{style:{padding:".44em .45em"},pill:!0,bg:"danger",onClick:function(){return r.callHangup(O)},children:Object(m.jsx)("i",{className:"bi bi-x"})}):Object(m.jsx)(g.a,{style:{padding:".44em .45em"},pill:!0,bg:"danger",onClick:function(){return d(n)},className:"cursor-pointer",children:Object(m.jsx)("i",{className:"bi bi-cast"})}),Object(m.jsxs)(R.a,{show:l,setShow:d,buttons:[t],closeButton:!0,title:"Forward stream",onKeyDown:function(e){13===e.keyCode&&w()},children:["Enter the destination ID you want to forward to",Object(m.jsx)(N.a,{controlId:"floatingInput",label:"targetId",className:"mb-3",children:Object(m.jsx)(E.a.Control,{ref:c,name:"targetId",type:"text",value:"mediarouter",placeholder:"mediahub target id"})})]})]})},I=n(30),T=null,_=function(){var e=Object(o.useRef)(null),t=Object(o.useRef)(null),n=(Object(o.useContext)(s.a),Object(o.useContext)(l.a)),a=Object(o.useContext)(y.a),c=Object(o.useContext)(k.a),i=Object(o.useState)(!1),d=Object(p.a)(i,2),u=d[0],b=d[1],f=Object(o.useState)("local"),j=Object(p.a)(f,2),h=j[0],g=j[1],w=Object(o.useState)("local"),C=Object(p.a)(w,2),A=C[0],_=C[1],D=Object(o.useState)(0),P=Object(p.a)(D,2),L=P[0],U=P[1];function z(){h&&e.current&&(e.current.srcObject=c.streams[h]),A&&t.current&&(t.current.srcObject=c.streams[A])}function F(e){var t=document.createElement("canvas");return t.width=e.videoWidth,t.height=e.videoHeight,t.getContext("2d").drawImage(e,0,0,t.width,t.height),t.toDataURL("image/png")}Object(o.useEffect)((function(){if(n.ready&&a.ready)return function(){}}),[n.ready,a.ready]),Object(o.useEffect)((function(){if(h&&e.current)return e.current.srcObject=c.streams[h],function(){}}),[h,c.streams]),Object(o.useEffect)((function(){if(A&&t.current)return t.current.srcObject=c.streams[A],function(){}}),[A,c.streams]);var V,B=[];switch(L){case 1:V=Object(m.jsx)(x.a,{variant:"outline-primary",children:Object(m.jsx)(S.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})});break;case 2:V=Object(m.jsx)(x.a,{variant:"outline-success",children:"Done"});break;case 3:V=Object(m.jsx)(x.a,{variant:"outline-danger",children:"Error"});break;default:V=Object(m.jsx)(x.a,{onClick:function(){if(h&&A){var n,a={studio:F(e.current),actor:F(t.current)};console.log("Request body size (bytes) "+((n=a).constructor!==String&&(n=JSON.stringify(n)),new Blob([n]).size)),U(1),I.a.post("https://admire-dev-iq.brainstorm3d.com/image/lut",{data:a}).then((function(e){U(2),setTimeout((function(){U(0)}),1500),T=e})).catch((function(e){U(3),console.error(e)}))}},children:"Submit"})}return T&&B.push(Object(m.jsxs)(x.a,{variant:"link",onClick:function(){if(!T)throw"No LUT";var e=h+"_"+A+".lut",t=new Blob([T.lut],{type:"text/plain"}),n=URL.createObjectURL(t),a=document.createElement("a");a.setAttribute("href",n),a.setAttribute("download",e),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a),setTimeout((function(){return URL.revokeObjectURL(n)}),6e4)},children:["Download LUT ",Object(m.jsx)("i",{className:"bi bi-download"})]})),B.push(V),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)(x.a,{className:"lutButton",onClick:function(){b((function(e){return!e})),setTimeout(z,100)},children:[Object(m.jsx)("i",{className:"jsx-422356642 bi bi-magic"})," Color Calibration"]}),Object(m.jsx)(R.a,{buttons:B,id:"configure",tabIndex:"0",closeButton:!0,size:"lg",show:u,setShow:b,_title:Object(m.jsx)("span",{className:"jsx-422356642",children:"Settings: Wizard"}),children:Object(m.jsxs)(v.a,{id:"devices-row",children:[Object(m.jsxs)(O.a,{md:6,children:[Object(m.jsx)("h4",{className:"jsx-422356642",children:"Studio"}),Object(m.jsx)("video",{autoPlay:!0,muted:!0,ref:e,style:{width:"100%",marginBottom:"6px"},className:"jsx-422356642 lutVideo mirrored mx-auto d-block"}),Object(m.jsx)(N.a,{className:"pb-1",controlId:"floatingSelect",label:Object(m.jsxs)("span",{className:"jsx-422356642",children:[" ",Object(m.jsx)("i",{className:"jsx-422356642 bi bi-camera-video"})," Video devices"]}),children:Object(m.jsx)(E.a.Select,{value:h,onChange:function(e){var t=e.target;g(t.value)},children:Object.keys(c.streams).map((function(e,t){return Object(m.jsx)("option",{value:e,className:"jsx-422356642",children:e},t)}))})})]}),Object(m.jsxs)(O.a,{md:6,children:[Object(m.jsx)("h4",{className:"jsx-422356642",children:"Actor"}),Object(m.jsx)("video",{autoPlay:!0,muted:!0,ref:t,style:{width:"100%",marginBottom:"6px"},className:"jsx-422356642 lutVideo mirrored mx-auto d-block"}),Object(m.jsx)(N.a,{className:"pb-1",controlId:"floatingSelect",label:Object(m.jsxs)("span",{className:"jsx-422356642",children:[" ",Object(m.jsx)("i",{className:"jsx-422356642 bi bi-camera-video"})," Video devices"]}),children:Object(m.jsx)(E.a.Select,{value:A,onChange:function(e){var t=e.target;_(t.value)},children:Object.keys(c.streams).map((function(e,t){return Object(m.jsx)("option",{value:e,className:"jsx-422356642",children:e},t)}))})})]})]})}),Object(m.jsx)(r.a,{id:"422356642",children:[".my-float-left{margin:0 auto !important;margin-left:0px !important;}",".mirrored{-webkit-transform:rotateY(180deg);-ms-transform:rotateY(180deg);transform:rotateY(180deg);-webkit-transform:rotateY(180deg);-moz-transform:rotateY(180deg);}","@media only screen and (orientation:portrait){.lutButton{margin-bottom:6px;}.lutVideo{width:70% !important;}}"]})]})};function D(e){Object.assign({},e);var t,n,a=Object(i.h)().roomId,c=Object(o.useRef)(),u=Object(o.useContext)(s.a),b=Object(o.useContext)(l.a),f=Object(o.useContext)(y.a),j=Object(o.useContext)(k.a),h=Object(o.useState)(null),C=Object(p.a)(h,2),S=C[0],N=C[1];return Object(o.useLayoutEffect)((function(){if(b.imInRoom(a)&&b.ready&&f.ready)return j.callAllUsers(),function(){j.callHangupAll()}}),[b.ready,f.ready]),Object(o.useEffect)((function(){j.replaceStream(f.localStream)}),[f.localStream]),Object(m.jsxs)("div",{id:"room",style:{zIndex:1e3},className:"jsx-3883356423 overflow-hidden m-auto",children:[Object(m.jsxs)(v.a,{id:"content-row",className:"g-2",style:{height:"100%"},children:[Object(m.jsxs)(O.a,{xs:"auto",id:"carousel-col",ref:c,children:[Object(m.jsx)(x.a,{onClick:function(){var e=document.getElementById("carousel"),t=document.querySelectorAll(".carouselVideoItem")[0];e.scrollLeft=Math.max(e.scrollLeft-t.clientWidth-4,0)},className:"float-start scrollButton",variant:"outline-light",children:Object(m.jsx)("i",{className:"jsx-3883356423 bi bi-caret-left-fill"})}),u.user.username===(null===(t=b.current)||void 0===t?void 0:t.master.username)&&Object(m.jsx)(_,{}),Object(m.jsx)(x.a,{onClick:function(){var e=document.getElementById("carousel"),t=document.querySelectorAll(".carouselVideoItem")[0];e.scrollLeft=Math.min(e.scrollLeft+t.clientWidth+4,e.scrollWidth)},className:"float-end scrollButton",variant:"outline-light",children:Object(m.jsx)("i",{className:"jsx-3883356423 bi bi-caret-right-fill"})}),Object(m.jsx)("div",{id:"carousel",className:"jsx-3883356423 d-flex flex-column",children:Object.entries(Object(d.a)({local:f.localStream},j.streams)).map((function(e,t){var n,a=Object(p.a)(e,2),r=a[0],o=a[1],c=j.getUserId(r),i=u.user.username===(null===(n=b.current)||void 0===n?void 0:n.master.username),s=j.getLiveCall(r),l=Object(p.a)(s,2),d=l[0],f=!!l[1],h=d===r,v=S===r||!S&&0===t;return Object(m.jsxs)("div",{className:"jsx-3883356423 carouselVideoItem",children:[Object(m.jsxs)("div",{className:"jsx-3883356423 stream-forward",children:[i&&Object(m.jsx)(A,{callId:r,isForwardCall:f}),v&&Object(m.jsx)(g.a,{pill:!0,bg:"primary",children:Object(m.jsx)("i",{className:"jsx-3883356423 bi bi-eye active"})})]}),!h&&Object(m.jsx)(w.a,{isLocal:c===u.user.username,id:c,stream:o,className:v?"":"cursor-pointer",onClick:function(){N(r)}},r)]},t)}))})]}),Object(m.jsx)(O.a,{id:"main-col",children:Object(m.jsx)(w.a,{isLocal:j.getUserId(S)===u.user.username,className:"main-video",id:j.getUserId(S),stream:null!==(n=j.streams[S])&&void 0!==n?n:f.localStream})})]}),Object(m.jsx)(r.a,{id:"3883356423",children:[".scrollButton{display:none;}","#room{height:calc(100vh - 3rem - 4.5rem);}","#room #main-col{height:100%;overflow:hidden;}","#room #main-col .Video{width:100%;height:100%;object-fit:cover;}","#room #carousel-col{height:100%;width:166px;}","#room #carousel-col #carousel{overflow-x:hidden;overflow-y:scroll;height:100%;padding-bottom:63px;}","#room #carousel-col #carousel .Video{padding-right:1px;padding-bottom:2px;}","#room .carouselVideoItem{margin-top:8px;border:none;border-bottom:1px solid #057bbb;}","#room .stream-forward{height:1.9rem;position:relative;margin-bottom:-1.9rem;text-align:left;padding:3px 6px;z-index:1000;}","#room .stream-controls{margin-bottom:5.5rem;}","@media only screen and (orientation:landscape) and (max-height:671px){#room{height:calc(100vh - 2rem);}.stream-controls{margin-bottom:.5rem !important;}}","@media only screen and (orientation:portrait){.scrollButton{display:block;}.carouselVideoItem{margin-top:0px !important;margin-right:3px;}.stream-controls{margin-bottom:5.5rem !important;}.stream-status{margin-bottom:6px;}#content-row{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}#carousel-col{overflow-x:scroll;overflow-y:hidden;height:170px !important;width:100% !important;}#carousel-col #carousel{-webkit-flex-direction:row !important;-ms-flex-direction:row !important;flex-direction:row !important;border:none;padding-bottom:44px !important;}#carousel-col #carousel .Video,#carousel-col #carousel .Video video{width:166px;height:124px;object-fit:cover;}}"]})]})}var P=n(12),L=n.n(P),U=n(8),z=n(15),F=n(493),V=n(468),B=n(466),G=n(27),M=function(){var e,t=Object(o.useRef)(null),n=Object(o.useState)(!1),a=Object(p.a)(n,2),r=a[0],c=a[1],i=Object(o.useContext)(s.a),l=Object(o.useState)({formErrors:{}}),u=Object(p.a)(l,2),b=u[0],f=u[1],j=Object(o.useState)(void 0),h=Object(p.a)(j,2),v=h[0],O=h[1];function g(e){return w.apply(this,arguments)}function w(){return(w=Object(z.a)(L.a.mark((function e(t){var n,a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=b.email.toLowerCase(),a=C.b.loading("Resetting password..."),e.next=5,I.a.post("".concat("https://admire-dev-auth.brainstorm3d.com","/forgot-password"),{data:{email:n}}).then((function(e){var t=e.error,n=e.message;if(t)return C.b.error("onSubmitRecovery: ".concat(n),{id:a});c(!1),C.b.success("Success",{id:a})})).catch((function(e){C.b.error("onSubmitRecovery: ".concat(e),{id:a})}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(o.useEffect)((function(){!function(){var e=!0;for(var t in b)-1!==t.indexOf("_check")&&(e&=b[t]);O(!!e)}()}),[b]),Object(o.useEffect)((function(){O(!1)}),[]);var k,y=Object(m.jsx)(V.a,{placement:"bottom",overlay:Object(m.jsx)(B.a,{className:"".concat(v?"d-none":""),id:"tooltip-bottom",children:Object.entries(b.formErrors).map((function(e){var t=Object(p.a)(e,2),n=t[0],a=t[1];return Object(m.jsxs)("span",{children:[n,": ",a]})}))}),children:Object(m.jsx)("span",{style:{padding:"10px 0"},children:Object(m.jsx)(x.a,{type:"submit",onClick:g,disabled:!v&&i.isConnected,children:" Send password reset email "})})});return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)(x.a,{size:"sm",className:"mt-4",variant:"link",onClick:function(){return c(1)},children:[Object(m.jsx)("i",{className:"bi bi-lock"}),"Forgot password?"]}),Object(m.jsxs)(R.a,{size:"md",closeButton:!0,show:r,setShow:c,buttons:[y],title:Object(m.jsx)("h2",{className:"user-select-none",children:"Forgot Password"}),children:[Object(m.jsx)(G.a,{className:"user-select-none",children:"Enter your email adress, on a couple of minutes you will receive an email with a link to reset your password."}),Object(m.jsx)(E.a,{validated:v,onSubmit:g,ref:t,children:Object(m.jsx)(N.a,{controlId:"floatingInput",label:"Email address",className:"mb-3",children:Object(m.jsx)(E.a.Control,{required:!0,className:(k=null===(e=b.formErrors)||void 0===e?void 0:e.email,k?0===k.length?"":"has-error":""),name:"email",type:"email",placeholder:" ",onChange:function(e){!function(e,t){var n=!1,a=b.formErrors;switch(e){case"email":n=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t),a[e]=n?"":" is invalid";break;case"password":n=t.length>=6,a[e]=n?"":" is too short";break;default:console.warn("Invalid field name: ",e)}f((function(r){var o;return Object(d.a)(Object(d.a)({},r),{},(o={},Object(U.a)(o,e,t),Object(U.a)(o,"".concat(e,"_check"),n),Object(U.a)(o,"formErrors",a),o))}))}(e.target.name,e.target.value)}})})})]})]})},W=n(205),J=n.n(W),H=n(222),Y=n(103),q=function(){var e,t,n,a,c,i,s,l,u,b,f=Object(o.useRef)(null),j=Object(o.useState)(!1),h=Object(p.a)(j,2),v=h[0],O=h[1],g=Object(o.useState)(!1),w=Object(p.a)(g,2),k=w[0],y=w[1],A=Object(o.useState)(void 0),T=Object(p.a)(A,2),_=T[0],D=T[1],P=Object(o.useState)({formErrors:{}}),M=Object(p.a)(P,2),W=M[0],q=M[1];function Z(e){var t=e.target.name,n=e.target.type;!function(e,t){var n,a,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"any",o=!1,c=W.formErrors,i=Object(d.a)({},W);function s(e,t){return new Promise((function(n,a){var r,o=t||5e3,c=new Image;c.onerror=c.onabort=function(){clearTimeout(r),a("Error: the url provided is not an image")},c.onload=function(){clearTimeout(r),n("success")},r=setTimeout((function(){c.src="//!!!!/test.jpg",a("timeout")}),o),c.src=e}))}switch(r){case"email":if(o=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t),c[e]=o?"":" is invalid",i=Object(d.a)(Object(d.a)({},i),{},(n={},Object(U.a)(n,e,t),Object(U.a)(n,"".concat(e,"_check"),o),Object(U.a)(n,"formErrors",c),n)),o){var l="https:"+J.a.url(t,{s:"256",r:"pg",d:"404"});s(l,2e3).then((function(e){var t;q(Object(d.a)(Object(d.a)({},i),{},(t={gravatar:l},Object(U.a)(t,"gravatar_check",o),Object(U.a)(t,"formErrors",c),t)))})).catch((function(e){var t;q(Object(d.a)(Object(d.a)({},i),{},(t={gravatar:null},Object(U.a)(t,"gravatar_check",o),Object(U.a)(t,"formErrors",c),t)))}))}else{var u;i=Object(d.a)(Object(d.a)({},i),{},(u={gravatar:null},Object(U.a)(u,"gravatar_check",o),Object(U.a)(u,"formErrors",c),u))}break;case"password":o=/^[a-zA-Z]+(.){7,20}$/.test(t),c[e]=o?"":" is too short";var m=W.password===W.password1;c=Object(d.a)(Object(d.a)({},c),{},{confirm:"".concat(m?"":"Password and confirmation do not match")}),i=Object(d.a)(Object(d.a)({},i),{},{confirm:m,formErrors:c});break;default:o=!0,c[e]=""}q(Object(d.a)(Object(d.a)({},i),{},(a={},Object(U.a)(a,e,t),Object(U.a)(a,"".concat(e,"_check"),o),Object(U.a)(a,"formErrors",c),a)))}(t,"checkbox"===n?e.target.checked:e.target.value,n)}function K(e){return $.apply(this,arguments)}function $(){return($=Object(z.a)(L.a.mark((function e(t){var n,a,r,o,c,i,s,l,d,u,m;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=W.username,r=W.email,o=W.password,c=W.avatar,i=W.gravatar,s=W.name,l=W.surname,d=W.birthdate,u=W.role,c=null!==(n=c)&&void 0!==n&&n.length?c:null!==i&&void 0!==i?i:Y.a,m=C.b.loading("Registering..."),e.next=6,I.a.post("".concat("https://admire-dev-auth.brainstorm3d.com","/register"),{data:{username:a,email:r,password:o,avatar:c,name:s,surname:l,birthdate:d,role:u}}).then((function(e){var t=e.error,n=e.message;e.status;if(t)return C.b.error("onRegister: ".concat(n),{id:m});C.b.success("Success",{id:m}),setTimeout((function(){y(0),O(!1)}),1e3)})).catch((function(e){C.b.error("Error: ".concat(e),{id:m})}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e){return null!==e&&void 0!==e&&e.length?"":"has-error"}Object(o.useEffect)((function(){!function(){var e=!0;for(var t in W)-1!==t.indexOf("_check")&&(e&=W[t]);D(!!e)}()}),[W]),Object(o.useEffect)((function(){D(!1)}),[]);var Q=Object(m.jsx)(x.a,{onClick:K,type:"submit",disabled:!_,variant:_?"outline-primary":"outline-secondary",children:"Register"});switch(k){case 1:Q=Object(m.jsxs)(x.a,{variant:"outline-primary",children:[" ",Object(m.jsx)(S.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})]});break;case 2:Q=Object(m.jsx)(x.a,{variant:"outline-success",children:"Done"});break;case 3:Q=Object(m.jsx)(x.a,{variant:"outline-danger",children:"Error"})}return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(F.a.Footer,{className:"text-center user-select-none",onClick:function(){return O(1)},children:" Create an account "}),Object(m.jsx)(E.a,{validated:_,onSubmit:K,ref:f,children:Object(m.jsxs)(R.a,{className:"py-4",closeButton:!0,show:v,setShow:O,title:Object(m.jsx)("h2",{className:"jsx-198025962 user-select-none",children:"Let's create your account"}),backdrop:"static",buttons:[Object(m.jsx)(V.a,{placement:"top",overlay:Object(m.jsx)(B.a,{className:"".concat(_?"d-none":""),id:"tooltip-top",children:Object.entries(W.formErrors).map((function(e,t){var n=Object(p.a)(e,2),a=n[0],r=n[1];return r.length?Object(m.jsxs)("p",{className:"jsx-198025962",children:[a,": ",r]},t):""}))}),children:Object(m.jsx)("div",{className:"jsx-198025962",children:Q})})],children:[Object(m.jsx)(H.a,{id:"avatar-img",src:null!==(e=null!==(t=W.avatar)&&void 0!==t?t:W.gravatar)&&void 0!==e?e:Y.a,roundedCircle:!0,className:"position-absolute top-0 start-50 bg-danger shadow",width:"128",height:"128"}),Object(m.jsx)(G.a,{className:"user-select-none",children:"Create your account. It's free and only takes a minute."}),Object(m.jsx)(E.a.Group,{className:"mb-1",children:Object(m.jsxs)(N.a,{label:"username",children:["     ",Object(m.jsx)(E.a.Control,{name:"username",className:X(null===(n=W.formErrors)||void 0===n?void 0:n.username),placeholder:"username",onChange:Z,type:"text",defaultValue:W.username}),"      "]})}),Object(m.jsx)(E.a.Group,{className:"mb-1",children:Object(m.jsxs)(N.a,{label:"email",children:["        ",Object(m.jsx)(E.a.Control,{name:"email",className:X(null===(a=W.formErrors)||void 0===a?void 0:a.email),placeholder:"email",onChange:Z,type:"email",defaultValue:W.email}),"      "]})}),Object(m.jsx)(E.a.Group,{className:"mb-1",children:Object(m.jsxs)(N.a,{label:"password",children:["     ",Object(m.jsx)(E.a.Control,{name:"password",className:X(null===(c=W.formErrors)||void 0===c?void 0:c.password),placeholder:"password",onChange:Z,type:"password",defaultValue:W.password}),"      "]})}),Object(m.jsx)(E.a.Group,{className:"mb-1",children:Object(m.jsxs)(N.a,{label:"confirm password",children:[" ",Object(m.jsx)(E.a.Control,{name:"password2",className:X(null===(i=W.formErrors)||void 0===i?void 0:i.password2),placeholder:"password2",onChange:Z,type:"password",defaultValue:W.password2}),"      "]})}),Object(m.jsx)(E.a.Group,{className:"mb-1",children:Object(m.jsxs)(N.a,{label:"avatar URL",children:["   ",Object(m.jsx)(E.a.Control,{name:"avatar",className:X(null===(s=W.formErrors)||void 0===s?void 0:s.avatar),placeholder:"avatar URL",onChange:Z,type:"avatar",defaultValue:W["avatar URL"]}),"      "]})}),Object(m.jsx)(E.a.Group,{className:"mb-1",children:Object(m.jsxs)(N.a,{label:"name",children:["         ",Object(m.jsx)(E.a.Control,{name:"name",className:X(null===(l=W.formErrors)||void 0===l?void 0:l.name),placeholder:"name",onChange:Z,type:"text",defaultValue:W.name}),"      "]})}),Object(m.jsx)(E.a.Group,{className:"mb-1",children:Object(m.jsxs)(N.a,{label:"surname",children:["      ",Object(m.jsx)(E.a.Control,{name:"surname",className:X(null===(u=W.formErrors)||void 0===u?void 0:u.surname),placeholder:"surname",onChange:Z,type:"text",defaultValue:W.surname}),"      "]})}),Object(m.jsx)(E.a.Group,{className:"mb-1",children:Object(m.jsxs)(N.a,{label:"birthddate",children:["   ",Object(m.jsx)(E.a.Control,{name:"birthdate",className:X(null===(b=W.formErrors)||void 0===b?void 0:b.birthdate),placeholder:"birthdate",onChange:Z,type:"date",defaultValue:W.birthdate}),"      "]})}),Object(m.jsxs)("div",{className:"jsx-198025962 form-floating",children:[Object(m.jsxs)("select",{id:"floatingSelect","aria-label":"Floating label select example",className:"jsx-198025962 form-select",children:[Object(m.jsx)("option",{value:"0",className:"jsx-198025962",children:"User"}),Object(m.jsx)("option",{value:"1",className:"jsx-198025962",children:"Admin"})]}),Object(m.jsx)("label",{htmlFor:"floatingSelect",className:"jsx-198025962",children:" User role"})]})]})}),Object(m.jsx)(r.a,{id:"198025962",children:["#avatar-img{-webkit-transform:translate(-50%,-125%) !important;-ms-transform:translate(-50%,-125%) !important;transform:translate(-50%,-125%) !important;}"]})]})},Z=n(130),K=n(54),$=function(){var e,t,n,a=Object(o.useContext)(s.a),c=Object(o.useRef)(null),i=Object(o.useState)(void 0),l=Object(p.a)(i,2),u=l[0],b=l[1],f=Object(o.useState)({formErrors:{},email:K.a.get("admire_app_email"),remember:!!K.a.get("admire_app_email")}),j=Object(p.a)(f,2),h=j[0],v=j[1],g=Object(o.useState)(!1),w=Object(p.a)(g,2),k=w[0],y=w[1];function C(){return(C=Object(z.a)(L.a.mark((function e(t){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),y(!0),a.login(h.email,h.password).then((function(e){y(!1),h.remember&&(K.a.set("admire_app_token",e,"30"),K.a.set("admire_app_email",h.email,"30"))})).catch((function(e){y(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){var t=e.target.name,n=e.target.type;!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"any",a=!1,r=h.formErrors;switch(n){case"email":a=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t),r[e]=a?"":" is invalid";break;case"password":a=t.length>=6,r[e]=a?"":" is too short";break;default:a=!0,r[e]=""}v((function(n){var o;return Object(d.a)(Object(d.a)({},n),{},(o={},Object(U.a)(o,e,t),Object(U.a)(o,"".concat(e,"_check"),a),Object(U.a)(o,"formErrors",r),o))}))}(t,"checkbox"===n?e.target.checked:e.target.value,n)}return Object(o.useEffect)((function(){!function(){var e=!0;for(var t in h)-1!==t.indexOf("_check")&&(e&=h[t]);b(!!e)}()}),[h]),Object(o.useEffect)((function(){b(!1)}),[]),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)(F.a,{id:"login",bg:"light",className:"flex-column text-center position-absolute start-50 top-50 translate-middle",style:{width:"24rem"},children:[Object(m.jsxs)(O.a,{children:[Object(m.jsx)(F.a.Img,{variant:"top",className:"mt-4 user-select-none",src:Z.a}),Object(m.jsx)("h1",{className:"jsx-1235835405 text-start ps-4 mb-0 mt-3 user-select-none",children:"admire"}),Object(m.jsx)("div",{className:"jsx-1235835405 divider",children:Object(m.jsx)("span",{className:"jsx-1235835405"})})]}),Object(m.jsxs)(O.a,{children:[Object(m.jsxs)(F.a.Body,{as:O.a,className:"text-start px-4 pb-4",children:[Object(m.jsx)(F.a.Text,{className:"user-select-none",children:"Enter your e-mail adress and your password."}),Object(m.jsxs)(E.a,{validated:u,onSubmit:function(e){return C.apply(this,arguments)},ref:c,children:[Object(m.jsx)(N.a,{controlId:"floatingInput",label:"Email address",className:"mb-3",children:Object(m.jsx)(E.a.Control,{required:!0,name:"email",type:"email",placeholder:" ",onChange:R,defaultValue:null!==(e=h.email)&&void 0!==e?e:" "})}),Object(m.jsx)(N.a,{controlId:"floatingPassword",label:"Password",children:Object(m.jsx)(E.a.Control,{required:!0,name:"password",type:"password",placeholder:" ",onChange:R,defaultValue:null!==(t=h.password)&&void 0!==t?t:""})}),Object(m.jsx)(E.a.Switch,{id:"remember-switch",label:"Remember me",className:"user-select-none",name:"remember",onChange:R,defaultChecked:null!==(n=h.remember)&&void 0!==n&&n}),Object(m.jsx)(V.a,{placement:"bottom",overlay:Object(m.jsx)(B.a,{className:"".concat(u?"d-none":""," mt-2"),id:"tooltip-bottom",children:"Check form errors"}),children:Object(m.jsx)("span",{style:{padding:"10px 0"},className:"jsx-1235835405",children:Object(m.jsx)(x.a,{size:"sm",className:"mt-4",type:"submit",disabled:!(u&&!k),children:k?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(S.a,{as:"span",animation:"grow",size:"sm",role:"status","aria-hidden":"true"})," Logging in... "]}):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("i",{className:"jsx-1235835405 bi bi-box-arrow-in-left"})," Log me in "]})})})}),Object(m.jsx)(M,{})]})]}),Object(m.jsx)(q,{})]})]}),Object(m.jsx)(r.a,{id:"1235835405",children:[".divider{border-bottom:1px solid #FFF;background-color:#DADADA;height:2px;margin:0.5em 0px 1.5em;}",".divider span{position:relative;display:block;width:75px;height:3px;background-color:#057bbb;-webkit-transform:translatey(-25%);-ms-transform:translatey(-25%);transform:translatey(-25%);left:6%;}","#login{max-height:calc(100vh- 1rem);border:none;}","#login img{width:192px;-webkit-filter:hue-rotate(260deg);filter:hue-rotate(260deg);}","#login .card-footer{color:#D1D3D5;background:#057bbb;-webkit-transition:all 0.1s ease-in-out;transition:all 0.1s ease-in-out;}","#login .card-footer:hover{background:#045a89;font-weight:bold;cursor:pointer;}","@media only screen and (orientation:landscape) and (max-height:671px){#login{width:40rem !important;-webkit-flex-direction:row !important;-ms-flex-direction:row !important;flex-direction:row !important;}#login .col{-webkit-align-self:end;-ms-flex-item-align:end;align-self:end;}}"]})]})},X=n(16),Q=n.p+"static/media/TeenyiconsPasswordOutline.ab4b0486.svg",ee=["show","setShow","onSubmit"],te=function(e){var t=e.show,n=e.setShow,a=e.onSubmit,c=(Object(u.a)(e,ee),Object(o.useContext)(l.a),Object(o.useRef)(null)),i=Object(o.useState)(!0),s=Object(p.a)(i,2),d=s[0],b=(s[1],Object(o.useState)(0)),f=Object(p.a)(b,2),j=f[0],h=f[1];function v(e){if(e.preventDefault(),null!==c&&void 0!==c&&c.current&&t){var r=Array.from(c.current.elements).map((function(e){return e.value})),o=Object(p.a)(r,1)[0];a(o).then((function(){return n(!1)})).catch((function(){return h(3)})).finally((function(){setTimeout((function(){return h(0)}),1e3)}))}}Object(o.useEffect)((function(){null!==c&&void 0!==c&&c.current&&t&&c.current.addEventListener("submit",(function(e){e.preventDefault()}))}),[]);var O=Object(m.jsx)(x.a,{disabled:!d,variant:d?"outline-primary":"outline-secondary",onClick:v,children:"Proceed"});switch(j){case 1:O=Object(m.jsxs)(x.a,{variant:"outline-primary",children:[" ",Object(m.jsx)(S.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})]});break;case 2:O=Object(m.jsx)(x.a,{variant:"outline-success",children:"Done"});break;case 3:O=Object(m.jsx)(x.a,{variant:"outline-danger",children:"Error"})}return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)(R.a,{className:"py-4",tabIndex:"0",buttons:[O],closeButton:!0,show:t,setShow:n,title:"Room password",children:[Object(m.jsx)(G.a,{children:""}),Object(m.jsx)(E.a,{ref:c,onSubmit:v,children:Object(m.jsx)(N.a,{controlId:"floatingInput",label:"password",className:"mb-3",children:Object(m.jsx)(E.a.Control,{name:"password",type:"password",placeholder:"password"})})})]}),Object(m.jsx)(r.a,{id:"1510850880",children:["#new-room-card{cursor:pointer;opacity:.5;border:2px dashed white;}","#new-room-card .card-img-top{display:none;}","#new-room-card .card-body{height:155px;}"]})]})},ne=["id","name","icon","hidden","master","users","secured"];function ae(e){e.id;var t=e.name,n=e.icon,a=e.hidden,c=(e.master,e.users,e.secured),i=Object(u.a)(e,ne),s=Object(o.useState)(!1),b=Object(p.a)(s,2),f=b[0],j=b[1],h=Object(o.useContext)(l.a);function v(e){return h.joinRoom(t,e)}return a?Object(m.jsx)(m.Fragment,{}):Object(m.jsxs)("div",{onClick:function(){f||(c?j(!0):v())},className:"jsx-1615470095",children:[Object(m.jsxs)(F.a,Object(d.a)(Object(d.a)({className:"bg-dark text-light"},i),{},{children:[Object(m.jsx)(F.a.Img,{variant:"top",src:n}),c&&Object(m.jsx)(g.a,{style:{padding:".44em .25em .44em .45em",margin:".25rem"},bg:"white",className:"position-absolute end-0 top-0",pill:!0,children:Object(m.jsx)("img",{width:"18",src:Q,style:{filter:"invert(.5)"},className:"jsx-1615470095"})}),Object(m.jsx)(F.a.Body,{children:Object(m.jsxs)(F.a.Title,{children:["#",t]})})]})),Object(m.jsx)(te,{show:f,setShow:j,onSubmit:v}),Object(m.jsx)(r.a,{id:"1615470095",children:[".card{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-transition:all 0.075s ease-in-out;transition:all 0.075s ease-in-out;}",".card:hover{box-shadow:0 0 0px 2px rgba(255,255,255,0.5) !important;}",".card:hover .card-body{background:#6d7a86;}",".card .card-body{-webkit-transition:all 0.075s ease-in-out;transition:all 0.075s ease-in-out;overflow-x:hidden;}",".card .card-body .card-title{margin:0;font-size:0.9rem;white-space:nowrap;-webkit-transition:2s;transition:2s;}",".card .card-body .card-title:hover{margin-left:-25px;}",".card .card-img-top{width:100%;height:100px;object-fit:cover;}"]})]})}function re(){}var oe=function(){Object(i.g)();var e=Object(o.useContext)(l.a);return Object(o.useEffect)((function(){}),[e.list]),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(v.a,{onKeyPress:re,id:"lobby",className:"h-100 m-auto",children:Object(m.jsxs)(O.a,{xs:12,sm:{span:10,offset:1},children:[Object(m.jsx)("h1",{className:"jsx-1836922784 text-light lobby-title",children:"Lobby"}),Object(m.jsx)(v.a,{xs:2,sm:3,lg:3,xl:5,className:"g-3",children:Object(X.a)(Object.values(e.list)).map((function(e,t){return Object(m.jsx)(O.a,{children:Object(m.jsx)(ae,Object(d.a)({},e))},t)}))})]})}),Object(m.jsx)(r.a,{id:"1836922784",children:["#lobby{min-height:19rem;height:calc(100vh - 3rem) !important;overflow-y:scroll !important;padding-bottom:4rem !important;}","#lobby .lobby-title{margin-bottom:20px;}"]})]})},ce=n(28),ie=n(221),se=(n(299),["show","setShow"]),le=function(e){e.show,e.setShow,Object(u.a)(e,se);var t=["Devices","Battery","Pose","Selfie"],a=Object(o.useState)(0),c=Object(p.a)(a,2),i=c[0],s=c[1],l=Object(o.useState)(null),d=Object(p.a)(l,2),b=d[0],f=d[1],j=Object(o.useState)([]),h=Object(p.a)(j,2),v=h[0],O=h[1];function x(e){switch(null===e||void 0===e?void 0:e.keyCode){case 37:return s((function(e){return e-1<0?t.length-1:e-1}));case 39:return s((function(e){return(e+1)%t.length}))}}return Object(o.useEffect)((function(){Object(z.a)(L.a.mark((function e(){var a,r,o,c;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],r=Object(ce.a)(t),e.prev=2,r.s();case 4:if((o=r.n()).done){e.next=10;break}return c=o.value,e.next=8,n(460)("./".concat(c,".jsx")).then((function(e){return a.push(Object(m.jsx)(e.default,{}))}));case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:O([].concat(a)),f(a[i]);case 20:case"end":return e.stop()}}),e,null,[[2,12,15,18]])})))()}),[]),Object(o.useEffect)((function(){f(v[i])}),[i]),Object(o.useEffect)((function(){return document.addEventListener("keydown",x),function(){document.removeEventListener("keydown",x)}}),[]),Object(m.jsxs)("div",{className:"jsx-1615848188",children:[Object(m.jsx)(ie.a,{onSwipeLeft:function(){return s((function(e){return(e+1)%t.length}))},onSwipeRight:function(){return s((function(e){return e-1<0?t.length-1:e-1}))},children:Object(m.jsxs)("div",{className:"jsx-1615848188",children:[Object(m.jsx)("ul",{className:"jsx-1615848188 nav nav-tabs justify-content-start mb-2",children:t.map((function(e,t){return Object(m.jsx)("li",{className:"jsx-1615848188 nav-item",children:Object(m.jsx)("div",{onClick:function(){return s(t)},className:"jsx-1615848188 "+"nav-link ".concat(i===t?"active":""),children:e})},t)}))}),b]})}),Object(m.jsx)(r.a,{id:"1615848188",children:["#wizard .nav-tabs{width:calc(100% + 24px);margin-left:-12px;margin-top:-3.6rem;}","#wizard .nav-tabs .nav-item{margin-right:2px;}","#wizard .nav-tabs .nav-link{background-color:rgba(60,60,60,0.75) !important;color:white;font-weight:500;}","#wizard .nav-tabs .nav-link.active{color:#057bbb !important;background-color:#fff !important;}","#wizard .modal-content{margin-top:1.5rem;max-height:calc( 100 - 4rem);}","#wizard .modal-body{padding-top:63px;overflow-y:scroll;}"]})]})},de=function(){var e=Object(o.useContext)(l.a),t=Object(o.useRef)(null),n=Object(o.useState)(!1),a=Object(p.a)(n,2),c=a[0],i=a[1],s=Object(o.useState)(!0),d=Object(p.a)(s,2),u=d[0],b=(d[1],Object(o.useState)(0)),f=Object(p.a)(b,2),j=f[0],v=f[1];function O(){if(null!==t&&void 0!==t&&t.current&&c){var n=Array.from(t.current.elements).map((function(e){return e.value})),a=Object(p.a)(n,5),r=a[0],o=a[1],s=a[2],l=a[3],d=a[4];e.createRoom(r.toLowerCase(),{password:o,size:s,icon:l,hidden:d}).then((function(e){C.b.success("Created room ".concat(e.name)),setTimeout((function(){v(0),i(!1)}),1e3),v(2)})).catch((function(e){C.b.error("onCreateRoom: ".concat(e)),v(3),setTimeout((function(){v(0)}),1e3)}))}}var g=Object(m.jsx)(x.a,{disabled:!u,variant:u?"outline-primary":"outline-secondary",onClick:O,children:"Create"});switch(j){case 1:g=Object(m.jsxs)(x.a,{variant:"outline-primary",children:[" ",Object(m.jsx)(S.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})]});break;case 2:g=Object(m.jsx)(x.a,{variant:"outline-success",children:"Done"});break;case 3:g=Object(m.jsx)(x.a,{variant:"outline-danger",children:"Error"})}return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(h.Button,{onClick:function(){return i(1)},title:"Create room",label:"Create room",appendclass:"shadow rounded-circle bg-danger",children:Object(m.jsx)("i",{className:"jsx-1510850880 bi bi-plus-lg"})}),Object(m.jsxs)(R.a,{size:"sm",onKeyDown:function(e){return 13===e.keyCode&&O()},tabIndex:"0",buttons:[g],closeButton:!0,show:c,setShow:i,title:Object(m.jsx)("span",{className:"jsx-1510850880",children:"Room settings"}),children:[Object(m.jsx)(G.a,{children:""}),Object(m.jsxs)(E.a,{ref:t,children:[Object(m.jsx)(N.a,{controlId:"floatingInput",label:"roomId",className:"mb-3",children:Object(m.jsx)(E.a.Control,{onChange:function(e){},required:!0,name:"roomId",type:"text",placeholder:"roomId"})}),Object(m.jsx)(N.a,{controlId:"floatingInput",label:"password",className:"mb-3",children:Object(m.jsx)(E.a.Control,{name:"password",type:"password",placeholder:"password"})}),Object(m.jsx)(N.a,{controlId:"floatingInput",label:"size",className:"mb-3",children:Object(m.jsx)(E.a.Control,{name:"size",min:"1",step:"1",type:"number",placeholder:"max users",defaultValue:"8"})}),Object(m.jsx)(N.a,{controlId:"floatingInput",label:"icon",className:"mb-3",children:Object(m.jsx)(E.a.Control,{name:"icon",type:"text",placeholder:"icon URL"})}),Object(m.jsx)(E.a.Switch,{id:"hidden-switch",label:"Hidden",name:"hidden",defaultValue:!1})]})]}),Object(m.jsx)(r.a,{id:"1510850880",children:["#new-room-card{cursor:pointer;opacity:.5;border:2px dashed white;}","#new-room-card .card-img-top{display:none;}","#new-room-card .card-body{height:155px;}"]})]})},ue=function(){var e=Object(o.useContext)(l.a),t=Object(o.useState)(!1),n=Object(p.a)(t,2),a=n[0],r=n[1];return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)(h.Item,{onClick:function(){return r(1)},label:"Leave room",children:[Object(m.jsx)("i",{className:"bi bi-telephone-x"}),"Leave"]}),Object(m.jsx)(R.a,{buttons:[Object(m.jsx)(x.a,{size:"lg",onClick:function(){return e.leaveRoom()},children:"Yes, leave"})],closeButton:!0,size:"md",show:a,setShow:r,title:Object(m.jsx)("span",{children:"Hey! Are you sure?"}),children:Object(m.jsx)(G.a,{children:"\n            Are you sure you want to leave this room? Any call in progress will be lost and any active stream will be stopped.\n            "})})]})},me=function(){var e=Object(o.useState)(!1),t=Object(p.a)(e,2),n=t[0],a=t[1];return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)(h.Item,{onClick:function(){return a((function(e){return!e}))},children:[Object(m.jsx)("i",{className:"bi bi-gear-wide-connected"}),"Settings"]}),Object(m.jsx)(R.a,{id:"wizard",tabIndex:"0",closeButton:!0,size:"lg",show:n,setShow:a,_title:Object(m.jsx)("span",{children:"Settings: Wizard"}),children:Object(m.jsx)(le,{})})]})},be=function(){var e,t,n=Object(o.useContext)(l.a),a=Object(o.useState)(!1),c=Object(p.a)(a,2),i=c[0],s=c[1];return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)(h.Item,{onClick:function(){return s((function(e){return!e}))},disabled:!n.current,children:[Object(m.jsx)("i",{className:"jsx-513157869 bi bi-people"}),"Users"]}),Object(m.jsx)(R.a,{tabIndex:"0",closeButton:!0,size:"md",show:i,setShow:s,title:Object(m.jsxs)("span",{className:"jsx-513157869",children:[Object(m.jsx)("i",{className:"jsx-513157869 bi bi-people"})," Users"]}),children:Object(m.jsx)("ul",{id:"user-list",className:"jsx-513157869",children:null===(e=n.current)||void 0===e||null===(t=e.users)||void 0===t?void 0:t.map((function(e,t,a){return e&&Object(m.jsxs)("li",{className:"jsx-513157869",children:[Object(m.jsx)("span",{onClick:function(){return n.kickUser(null===e||void 0===e?void 0:e.username)},className:"jsx-513157869",children:"\u274c"}),Object(m.jsx)(H.a,{className:"border border-light border-2 shadow",roundedCircle:!0,src:e.avatar,alt:e.username,style:{width:"1.5rem",height:"1.5rem"}}),null===e||void 0===e?void 0:e.username]},t)}))})}),Object(m.jsx)(r.a,{id:"513157869",children:["#user-list.jsx-513157869{list-style:none;padding:0;}","#user-list.jsx-513157869 span.jsx-513157869{cursor:pointer;}"]})]})},fe=n(494),je=function(){var e,t=Object(o.useRef)(null),n=Object(o.useContext)(l.a),a=Object(o.useContext)(s.a),c=Object(o.useState)(!1),i=Object(p.a)(c,2),d=i[0],u=i[1],b=Object(o.useState)(0),f=Object(p.a)(b,2);f[0],f[1];function j(){var e=document.getElementById("chat");if(e){var t=e.querySelector(".modal-body");t.scrollTop=t.scrollHeight}}return Object(o.useEffect)((function(){j()}),[n.messages]),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)(h.Item,{onClick:function(){return u((function(e){return!e})),void setTimeout(j,50)},disabled:!n.current,children:[Object(m.jsx)("i",{className:"jsx-3196295325 bi bi-chat-dots"}),"Chat"]}),Object(m.jsx)(R.a,{id:"chat",buttons:[Object(m.jsx)(E.a,{className:"flex-grow-1",noValidate:!0,validated:!(null===(e=t.current)||void 0===e||!e.value.length),onSubmit:function(e){e.preventDefault(),n.sendMessage(t.current.value).then((function(){return t.current.value=""}))},children:Object(m.jsxs)(fe.a,{children:[Object(m.jsx)(E.a.Control,{ref:t,placeholder:"Type a message to send","aria-label":"Recipient's username","aria-describedby":"basic-addon2",name:"message",type:"text"}),Object(m.jsx)(x.a,{type:"submit",variant:"outline-primary",id:"button-addon2",children:Object(m.jsx)("i",{className:"jsx-3196295325 bi bi-arrow-return-left"})})]})})],tabIndex:"0",closeButton:!0,size:"lg",show:d,setShow:u,title:Object(m.jsxs)("span",{className:"jsx-3196295325",children:[Object(m.jsx)("i",{className:"jsx-3196295325 bi bi-chat-dots"})," Chat"]}),children:Object(m.jsx)("ul",{className:"jsx-3196295325 messages",children:n.messages.map((function(e,t){return Object(m.jsx)(m.Fragment,{children:e.username?Object(m.jsxs)("li",{className:"jsx-3196295325 "+((e.username===a.user.username?"sent":"replies")||""),children:[Object(m.jsx)(H.a,{className:"border border-light border-2 shadow",roundedCircle:!0,src:e.avatar,alt:e.username}),Object(m.jsxs)("p",{className:"jsx-3196295325 rounded-3 shadow",children:[Object(m.jsxs)("span",{className:"jsx-3196295325 meta d-block",children:[Object(m.jsx)("span",{className:"jsx-3196295325 fw-bold",children:e.username}),Object(m.jsxs)("span",{style:{opacity:.5},className:"jsx-3196295325 float-end ps-3",children:["   ",function(){var t=new Date(e.timestamp);return"".concat(t.getHours(),":").concat(t.getMinutes())}()]})]}),e.text]})]},t):Object(m.jsxs)("li",{className:"jsx-3196295325 meta",children:[" ",e.text," "]},t)})}))})}),Object(m.jsx)(r.a,{id:"3196295325",children:["#chat .modal-body{height:50vh;overflow-y:scroll;}","#chat .modal-footer{background:#fff;}",".messages{padding-left:0;}",".messages img{width:2rem;height:2rem;}",".messages li{margin-top:.25rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-align-items:top;-webkit-box-align:top;-ms-flex-align:top;align-items:top;}",".messages li p{max-width:60%;padding:.125rem .5rem;margin:.125rem .5rem;}","@media screen and (max-width:735px){.messages li p{max-width:75%;}}",".messages .sent{-webkit-flex-direction:row-reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse;}",".messages .sent p{background-color:#f5f5f5;}",".messages .replies p{background-color:#435F7A;color:white;}"]})]})},he=function(){var e,t=Object(o.useRef)(null),n=Object(o.useContext)(y.a),a=Object(o.useState)(!1),c=Object(p.a)(a,2),i=c[0],s=c[1];return Object(o.useEffect)((function(){var e,t=null!==(e=n.localStream.getAudioTracks())&&void 0!==e?e:[];s(t.every((function(e){return e.enabled})))}),[n.localStream,null===(e=n.settings)||void 0===e?void 0:e.audio]),Object(o.useEffect)((function(){var e,n=null===t||void 0===t||null===(e=t.current)||void 0===e?void 0:e.getContext("2d");n.globalAlpha=.5;var a=requestAnimationFrame((function e(){n.clearRect(0,0,n.canvas.width,n.canvas.height);var t=.5*n.canvas.width,a=.5*n.canvas.height,r=.5*n.canvas.width,o=.5*n.canvas.height,c=.5*n.canvas.height,i=n.createRadialGradient(t,a,135,r,o,c);i.addColorStop(0,"rgba(255, 255, 255, 0.0)"),i.addColorStop(.1,"rgba(255, 255, 255, 0.5)"),i.addColorStop(.5,"rgba(255, 255, 255, 0.1)"),i.addColorStop(1,"rgba(255, 255, 255, 0.0)"),n.fillStyle=i,n.fillRect(0,0,n.canvas.width,n.canvas.height),requestAnimationFrame(e)}));return function(){cancelAnimationFrame(a)}}),[]),Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{id:"pulse-wrapper",style:{marginTop:"-4rem",marginBottom:"-4rem"},className:"jsx-652394502 p-4 rounded-circle",children:[Object(m.jsx)("canvas",{width:"512",height:"512",ref:t,className:"jsx-652394502 position-absolute top-0 rounded-circle"}),Object(m.jsx)(h.Button,{onClick:function(){var e,t=(null!==(e=n.localStream.getAudioTracks())&&void 0!==e?e:[]).every((function(e){return e.enabled=!i,!!e.enabled}));s(t)},label:"Create room",appendclass:"shadow rounded-circle bg-danger",children:Object(m.jsx)("i",{className:"jsx-652394502 "+((i?"bi bi-mic":"bi bi-mic-mute")||"")})})]}),Object(m.jsx)(r.a,{id:"652394502",children:["#pulse-wrapper{margin:-3rem -1.5rem 0rem -1.5rem !important;overflow:hidden !important;}","#pulse-wrapper .nav-button{margin-top:0;margin-bottom:0;}","#pulse-wrapper canvas{pointer-events:none;margin-top:.35rem;width:5rem;height:5rem;-webkit-transform:translate(-50%,-50%) scale(1.3) !important;-ms-transform:translate(-50%,-50%) scale(1.3) !important;transform:translate(-50%,-50%) scale(1.3) !important;}","@media only screen and (orientation:landscape) and (max-height:671px){#pulse-wrapper{margin:-1.5rem 1rem -1.5rem -4rem !important;}#pulse-wrapper .nav-button{margin-left:0;margin-right:0;}#pulse-wrapper canvas{top:50% !important;margin-top:0rem;}}"]})]})},pe=n(157);t.a=function(e){var t,n;Object.assign({},e),Object(o.useEffect)((function(){pe.a()}),[]);var a=Object(i.g)(),d=Object(o.useContext)(s.a),u=Object(o.useContext)(l.a),b=Object(o.useRef)().current;return/^\/room\/[a-zA-Z0-9]+/.test(a.location.pathname)&&(b=Object(m.jsx)(D,{container:!0})),"/"===a.location.pathname&&(b=Object(m.jsx)(oe,{container:!0})),"/settings"===a.location.pathname&&(b=Object(m.jsx)(le,{show:!0,container:!0})),/^\/room\/[a-zA-Z0-9]+\/chat$/.test(a.location.pathname)&&(b=Object(m.jsx)(i.a,{to:"/"})),/^\/room\/[a-zA-Z0-9]+\/users$/.test(a.location.pathname)&&(b=Object(m.jsx)(i.a,{to:"/"})),d.isLogged&&d.isConnected?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:"jsx-147180269 App",children:[Object(m.jsx)(c.a,{fluid:null===(t=b)||void 0===t||null===(n=t.props)||void 0===n?void 0:n.container,id:"content-wrapper",children:b}),Object(m.jsxs)(h,{children:[u.current?Object(m.jsx)(ue,{}):Object(m.jsxs)(h.Item,{children:[Object(m.jsx)("i",{className:"jsx-147180269 bi bi-house"}),"Lobby"]}),Object(m.jsx)(me,{}),u.current?Object(m.jsx)(he,{}):Object(m.jsx)(de,{}),Object(m.jsx)(be,{}),Object(m.jsx)(je,{})]})]}),Object(m.jsx)(r.a,{id:"147180269",children:["html,body,.App{overflow:hidden;min-height:330px;}","#content-wrapper{height:100%;margin-bottom:6rem;margin-top:3.5rem;overflow-y:scroll;overflow-x:hidden;}","#content-wrapper .container-fluid{margin:0 !important;}","@media only screen and (orientation:landscape) and (max-height:671px){#content-wrapper{margin-bottom:1rem;margin-top:1rem;margin-right:3rem;}}"]})]}):Object(m.jsx)("div",{className:"App",children:Object(m.jsx)($,{})})}},22:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(12),r=n.n(a),o=n(16),c=n(15),i=n(28),s=n(8),l=n(2),d=n(6),u=n(7),m=n(5),b=n(10),f=n(20),j=n(1),h=n(26),p=n.p+"static/media/UilUser.9ef7755c.svg",v=n(0),O=["children"],x=Object(j.createContext)(),g=[],w={};t.b=function(e){var t=e.children,n=(Object(u.a)(e,O),Object(j.useContext)(h.a)),a=Object(f.g)(),k=Object(j.useState)({}),y=Object(d.a)(k,2),C=y[0],S=y[1],N=Object(j.useState)(!1),E=Object(d.a)(N,2),R=E[0],A=E[1],I=Object(j.useState)(null),T=Object(d.a)(I,2),_=T[0],D=T[1],P=Object(j.useState)(0),L=Object(d.a)(P,2),U=(L[0],L[1]);function z(e){g=e,U((function(e){return e+1}))}function F(){m.d.getRoom({response:J}),m.d.getRooms({response:Y})}function V(e,t){var n,a,r=Object(l.a)(Object(l.a)({},C),{},Object(s.a)({},null===_||void 0===_?void 0:_.name,_))[t],o=Object(i.a)(null!==(n=null===r||void 0===r?void 0:r.users)&&void 0!==n?n:[]);try{for(o.s();!(a=o.n()).done;){var c=a.value;if((null===c||void 0===c?void 0:c.username)===e)return!0}}catch(d){o.e(d)}finally{o.f()}return!1}function B(e){e.data.room;m.d.getRoom({response:J}),m.d.getRooms({response:Y})}function G(e){e.data.room;m.d.getRoom({response:J}),m.d.getRooms({response:Y})}function M(e){var t,n=e.data,a=n.user;n.room;(m.d.getRoom({response:J}),_)&&(Object(b.b)("User '".concat(a.username,"' left")),D(Object(l.a)(Object(l.a)({},_),{},{users:null!==(t=null===_||void 0===_?void 0:_.users)&&void 0!==t?t:[].filter((function(e){return e.username!==a.username}))})),g.push({text:"User '".concat(a.username,"' left"),timestamp:(new Date).toISOString()}))}function W(e){var t,n=e.data,a=n.user;n.room;(m.d.getRoom({response:J}),_)&&(Object(b.b)("User '".concat(a.username,"' joined")),D(Object(l.a)(Object(l.a)({},_),{},{users:null!==(t=null===_||void 0===_?void 0:_.users)&&void 0!==t?t:[].push(a)})),g.push({text:"User '".concat(a.username,"' joined"),timestamp:(new Date).toISOString()}))}function J(e){return H.apply(this,arguments)}function H(){return(H=Object(c.a)(r.a.mark((function e(t){var o,c,s,d,u,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.data.room,D(null!==o&&void 0!==o&&o.name?Object(l.a)({},o):null),null===o||void 0===o||!o.name){e.next=32;break}s=Object(i.a)(null!==(c=o.users)&&void 0!==c?c:[]),e.prev=4,s.s();case 6:if((d=s.n()).done){e.next=21;break}if(!(m=d.value).avatar){e.next=10;break}return e.abrupt("continue",19);case 10:if(null===(u=w[m.username])||void 0===u){e.next=14;break}e.t0=u,e.next=17;break;case 14:return e.next=16,n.getUserAvatar(m.username);case 16:e.t0=e.sent;case 17:m.avatar=e.t0,m.avatar=m.avatar.length?m.avatar:p;case 19:e.next=6;break;case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(4),s.e(e.t1);case 26:return e.prev=26,s.f(),e.finish(26);case 29:a.location.pathname!=="/room/".concat(null===o||void 0===o?void 0:o.name)&&a.push("/room/".concat(null===o||void 0===o?void 0:o.name)),e.next=33;break;case 32:a.push("/");case 33:case"end":return e.stop()}}),e,null,[[4,23,26,29]])})))).apply(this,arguments)}function Y(e){var t,n=e.data.rooms,a={},r=Object(i.a)(null!==n&&void 0!==n?n:[]);try{for(r.s();!(t=r.n()).done;){var o=t.value;a[o.name]=o}}catch(c){r.e(c)}finally{r.f()}S(a)}function q(e){e.event;var t=e.data;if(_){var n=t.user;g.push({text:"User '".concat(n.username,"' rejoined"),timestamp:(new Date).toISOString()})}}function Z(e){return K.apply(this,arguments)}function K(){return(K=Object(c.a)(r.a.mark((function e(t){var a,c,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.event,i=t.data){e.next=3;break}return e.abrupt("return");case 3:if(null===(c=w[i.username])||void 0===c){e.next=7;break}e.t1=c,e.next=10;break;case 7:return e.next=9,n.getUserAvatar(i.username);case 9:e.t1=e.sent;case 10:if(e.t2=a=e.t1,e.t0=null!==e.t2,!e.t0){e.next=14;break}e.t0=void 0!==a;case 14:if(!e.t0){e.next=18;break}e.t3=a,e.next=19;break;case 18:e.t3=p;case 19:i.avatar=e.t3,z([].concat(Object(o.a)(g),[i]));case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(){return($=Object(c.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){_||n(),m.d.sendText(t,{response:function(t){e()}})})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(j.useEffect)((function(){if(n.isLogged)return m.d.on(m.a.GuestLeftRoom,M),m.d.on(m.a.GuestJoinedRoom,W),m.d.on(m.a.RoomCreated,B),m.d.on(m.a.RoomDeleted,G),m.d.on(m.a.UserRejoined,q),m.d.on(m.a.UserKicked,F),m.d.on(m.a.ChatText,Z),m.d.getRooms({response:function(e){Y(e),m.d.getRoom({response:function(e){J(e),A(!0)}})}}),function(){m.d.off(m.a.GuestLeftRoom,M),m.d.off(m.a.GuestJoinedRoom,W),m.d.off(m.a.RoomCreated,B),m.d.off(m.a.RoomDeleted,G),m.d.off(m.a.UserRejoined,q),m.d.off(m.a.ChatText,Z)}}),[n.isLogged]),Object(j.useEffect)((function(){_&&localStorage.setItem("messages",JSON.stringify(g))}),[g]);var X=window.rooms={joinRoom:function(e,t){return new Promise((function(n,a){m.d.joinRoom(e,{password:null!==t&&void 0!==t?t:"",response:function(e){e.event;var t=e.data;t.error?(b.b.error(t.message),a(t.message)):n(t.room)}})})).then((function(e){return m.d.getRoom({response:J}),e})).finally((function(){var e=localStorage.getItem("messages");e=e?JSON.parse(e):[],z(Object(o.a)(e))}))},leaveRoom:function(){return new Promise((function(e,t){m.d.leaveRoom({response:function(n){n.event;var a=n.data;a.error?t(a.message):e(a.room)}})})).finally((function(e){return z([]),m.d.getRoom({response:J}),m.d.getRooms({response:Y}),e}))},createRoom:function(e,t){var n=t.password,a=t.hidden,r=t.icon,o=t.size;return new Promise((function(t,c){m.d.createRoom(e,{password:null!==n&&void 0!==n?n:"",hidden:null!==a&&void 0!==a&&a,size:o,icon:r&&r.length?r:"https://unsplash.it/seed/test-".concat(e,"/160/100"),response:function(e){e.event;var n=e.data;n.error?c(n.message):t(n.room)}})})).then((function(e){return m.d.getRoom({response:J}),e}))},setCurrent:D,imInRoom:function(e){var t;return V(null===(t=n.user)||void 0===t?void 0:t.username,e)},isUserInRoom:V,kickUser:function(e){_&&m.d.kickUser(e,{response:function(e){var t=e.event,n=e.data;if("error"===t)return b.b.error(n.message);m.d.getRoom({response:J})}})},ready:R,current:_,sendMessage:function(e){return $.apply(this,arguments)},messages:g,list:C};return Object(v.jsx)(x.Provider,{value:X,children:t})}},26:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(28),r=n(12),o=n.n(r),c=n(15),i=n(2),s=n(6),l=n(7),d=n(30),u=n(5),m=n(54),b=n(10),f=n(1),j=n(0),h=["children"],p=Object(f.createContext)();t.b=function(e){var t=e.children,n=(Object(l.a)(e,h),Object(f.useState)(null)),r=Object(s.a)(n,2),v=r[0],O=r[1],x=Object(f.useState)(m.a.get("admire_app_token")),g=Object(s.a)(x,2),w=g[0],k=g[1],y=Object(f.useState)(!1),C=Object(s.a)(y,2),S=C[0],N=C[1],E=Object(f.useState)({app:!1,rtc:!1}),R=Object(s.a)(E,2),A=R[0],I=R[1],T=Object(f.useRef)(null).current,_=Object(f.useRef)(null).current,D=Object(f.useRef)(null).current,P=Object(f.useState)(0),L=Object(s.a)(P,2),U=L[0],z=L[1];function F(e){var t=e.event,n=e.data;if("error"===t)if(101===n.error)b.b.error(n.message),V();else console.warn("error type not handled",n)}function V(){return B.apply(this,arguments)}function B(){return(B=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.a.set("admire_app_email",null,-1),m.a.set("admire_app_token",null,-1),k(null),N(!1),Object(b.b)("Logged out"),u.g.disconnect(),u.d.disconnect(),z(0);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(){return M.apply(this,arguments)}function M(){return(M=Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){d.a.get("".concat("https://admire-dev-auth.brainstorm3d.com","/users/me"),{headers:{Authorization:"Bearer ".concat(w)}}).then((function(n){null!==n&&void 0!==n&&n.error?t(n):e(n)})).catch((function(e){return t(e)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(){return(W=Object(c.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G();case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return");case 5:if(a=[],n.username!=t.username&&a.push(d.a.post("".concat("https://admire-dev-auth.brainstorm3d.com","/users/update/username"),{data:{username:t.username}},{headers:{Authorization:"Bearer ".concat(w)}})),n.password!=t.password&&a.push(d.a.post("".concat("https://admire-dev-auth.brainstorm3d.com","/users/update/password"),{data:{password:t.password}},{headers:{Authorization:"Bearer ".concat(w)}})),n.avatar!=t.avatar&&a.push(d.a.post("".concat("https://admire-dev-auth.brainstorm3d.com","/users/update/avatar"),{data:{avatar:t.avatar}},{headers:{Authorization:"Bearer ".concat(w)}})),n.name!=t.name&&a.push(d.a.post("".concat("https://admire-dev-auth.brainstorm3d.com","/users/update/name"),{data:{name:t.name}},{headers:{Authorization:"Bearer ".concat(w)}})),n.surname!=t.surname&&a.push(d.a.post("".concat("https://admire-dev-auth.brainstorm3d.com","/users/update/surname"),{data:{email:t.surname}},{headers:{Authorization:"Bearer ".concat(w)}})),n.birthdate!=t.birthdate&&a.push(d.a.post("".concat("https://admire-dev-auth.brainstorm3d.com","/users/update/birthdate"),{data:{description:t.birthdate}},{headers:{Authorization:"Bearer ".concat(w)}})),0!==a.length){e.next=14;break}return e.abrupt("return",b.b.success("No changes on user info detected"));case 14:return e.abrupt("return",Promise.all(a).then((function(e){if(e){if(!e.some((function(e){return null===e||void 0===e?void 0:e.error})))return b.b.success("User info updated"),e;b.b.error("Error updating user info")}})).catch((function(e){return b.b.error("Error catch: ".concat(e))})));case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(){return(J=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){d.a.get("".concat("https://admire-dev-auth.brainstorm3d.com","/users/").concat(t,"/avatar"),{headers:{Authorization:"Bearer ".concat(w)}}).then((function(t){null!==t&&void 0!==t&&t.error?n(t):e(t.avatar)})).catch((function(e){return n(e)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(f.useEffect)((function(){function e(){V(),window.removeEventListener("unload",e)}function t(){Object(b.b)("App Connected",{id:T,icon:"\u26a1",duration:2e3}),I((function(e){return Object(i.a)(Object(i.a)({},e),{},{app:!0})}))}function n(){Object(b.b)("RTC Connected",{id:_,icon:"\u26a1",duration:2e3}),I((function(e){return Object(i.a)(Object(i.a)({},e),{},{rtc:!0})}))}function a(){Object(b.b)("App Disconnected",{id:T,icon:"\u26a0\ufe0f",duration:2e3}),I((function(e){return Object(i.a)(Object(i.a)({},e),{},{app:!1})}))}function r(){Object(b.b)("RTC Disconnected",{id:_,icon:"\u26a0\ufe0f",duration:2e3}),I((function(e){return Object(i.a)(Object(i.a)({},e),{},{rtc:!1})}))}return window.addEventListener("unload",e),u.d.on(u.a.ClientConnected,t),u.g.on(u.c.ClientConnected,n),u.d.on(u.a.ClientDisconnected,a),u.g.on(u.c.ClientDisconnected,r),u.d.on(u.a.Error,F),function(){u.d.off(u.a.ClientConnected,t),u.d.off(u.c.ClientConnected,a),u.g.off(u.a.ClientDisconnected,n),u.g.off(u.c.ClientDisconnected,r),u.d.off(u.a.Error,F),e()}}),[]),Object(f.useEffect)((function(){!A.app&&w&&u.d.connect("wss://admire-dev-lobby.brainstorm3d.com",w)}),[A.app,w]),Object(f.useEffect)((function(){!A.rtc&&w&&Object(c.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G().then((function(e){return b.b.success("Success",{id:D,icon:"\u26a1",duration:2e3}),O(e),e}));case 2:e.sent,u.g.connect("wss://admire-dev-rtc.brainstorm3d.com",w);case 4:case"end":return e.stop()}}),e)})))()}),[A.rtc,w]),Object(f.useEffect)((function(){A.rtc&&A.app&&w&&!S&&(D=b.b.loading("Fetching user info...",{duration:1/0}),G().then((function(e){b.b.success("Success",{id:D,icon:"\u26a1",duration:2e3}),O(e),N(!0)})).catch((function(e){var t=e.error,n=e.message;b.b.error("onGetUserInfo(e:".concat(t,"): ").concat(n),{id:D,icon:"\u26a0\ufe0f",duration:4e3}),U>=3?V():Object(b.b)((function(e){var t=Object(f.useState)(.001*e.duration),n=Object(s.a)(t,2),a=n[0],r=n[1];return Object(f.useEffect)((function(){var e=setInterval((function(){return r((function(e){return Math.max(0,e-1)}))}),1e3);return function(){clearInterval(e),z((function(e){return e+1}))}}),[]),Object(j.jsx)("span",{children:0===a?"Retrying":"Retrying in ".concat(a,"s...")})}),{duration:5e3})})))}),[A.rtc&&A.app,w,S,U]);var H=window.auth={user:v,isLogged:S,isConnected:A.app&&A.rtc,login:function(e,t){var n=b.b.loading("Logging in...");return e=e.toLowerCase(),k(null),d.a.post("".concat("https://admire-dev-auth.brainstorm3d.com","/auth/basic"),{data:{email:e,password:t}}).then(function(){var e=Object(c.a)(o.a.mark((function e(t){var r,c,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw"onLogin error: no response";case 2:if(!(null!==t&&void 0!==t&&t.error||null===t||void 0===t)&&t.token){e.next=8;break}r=Object(a.a)([t.message].flat());try{for(r.s();!(c=r.n()).done;)i=c.value,b.b.error("onLogin error: ".concat(i))}catch(o){r.e(o)}finally{r.f()}return b.b.dismiss(n),setTimeout(V,2e3),e.abrupt("return",null);case 8:return b.b.success("Success login",{id:n}),k(t.token),e.abrupt("return",t.token);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return b.b.error("Error catch: ".concat(e),{id:n})}))},logout:V,getUserInfo:G,getUserAvatar:function(e){return J.apply(this,arguments)},updateUserInfo:function(e){return W.apply(this,arguments)}};return Object(j.jsx)(p.Provider,{value:H,children:t})}},27:function(e,t,n){"use strict";var a=n(2),r=n(7),o=n(220),c=n(218),i=n(203),s=n(217),l=n(0),d=["children"];t.a=function(e){var t=e.children,n=Object(r.a)(e,d);return Object(l.jsx)(s.a,Object(a.a)({children:t.replaceAll("  ",""),remarkPlugins:[c.a,i.a],rehypePlugins:[o.a]},n))}},30:function(e,t,n){"use strict";var a=n(12),r=n.n(a),o=n(15),c={get:function(){var e=Object(o.a)(r.a.mark((function e(t){var n,a,o,c=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:{},o=Object.assign({"Content-Type":"application/json"},null!==(n=a.headers)&&void 0!==n?n:{}),e.abrupt("return",fetch(t,{method:"GET",headers:o}).then((function(e){return e.json()})).catch((function(e){return console.trace(e)})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),post:function(){var e=Object(o.a)(r.a.mark((function e(t){var n,a,o,c,i,s=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=s.length>1&&void 0!==s[1]?s[1]:{},c=Object.assign({"Content-Type":"application/json"},null!==(n=o.headers)&&void 0!==n?n:{}),i=JSON.stringify(null!==(a=o.data)&&void 0!==a?a:{}),e.abrupt("return",fetch(t,{method:"POST",headers:c,body:i}).then((function(e){return e.json()})).catch((function(e){return console.trace(e)})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};t.a=c},46:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(2),r=n(12),o=n.n(r),c=n(15),i=n(6),s=n(7),l=n(5),d=n(10),u=n(1),m=n(0),b=["children"],f=Object(u.createContext)();t.b=function(e){var t=e.children,n=(Object(s.a)(e,b),Object(u.useRef)(0).current),r=Object(u.useRef)(null),j=Object(u.useState)(!1),h=Object(i.a)(j,2),p=h[0],v=h[1],O=Object(u.useState)(null),x=Object(i.a)(O,2),g=x[0],w=x[1],k=Object(u.useState)(null),y=Object(i.a)(k,2),C=y[0],S=y[1],N=Object(u.useState)(null),E=Object(i.a)(N,2),R=E[0],A=E[1],I=Object(u.useReducer)((function(e,t){return r&&r.current&&(r.current.srcObject=t),t}),l.e.getStream()),T=Object(i.a)(I,2),_=T[0],D=T[1];function P(){l.f.getDevices()}function L(e){var t=e.resolutions,n=e.settings;S(Object(a.a)({},n)),A(t)}function U(e){var t=e.audioDevices,n=e.videoDevices,r=e.settings;S(Object(a.a)({},r)),w(Object(a.a)(Object(a.a)({},g),{},{audio:t,video:n}))}function z(e){var t=e.stream,n=e.settings;window.localStorage.setItem("audio",null===n||void 0===n?void 0:n.audio),window.localStorage.setItem("video",null===n||void 0===n?void 0:n.video),window.localStream=_=t,S(Object(a.a)({},n)),D(_)}function F(e){var t=e.error,n=e.message;d.b.error("".concat(t,": ").concat(n))}Object(u.useEffect)((function(){function e(){l.f.off(l.b.GotStream,z),l.f.off(l.b.GotDevices,U),l.f.off(l.b.ErrorStream,F),l.f.off(l.b.ErrorDevices,F),l.f.off(l.b.GotResolutions,L),window.removeEventListener("unload ",e)}return Object(c.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l.f.on(l.b.GotDevices,U),l.f.on(l.b.ErrorStream,F),l.f.on(l.b.ErrorDevices,F),l.f.on(l.b.GotResolutions,L),e.next=6,l.f.start();case 6:if(e.sent){e.next=9;break}return e.abrupt("return",d.b.error("Media devices are not available"));case 9:return t=window.localStorage.getItem("audio"),n=window.localStorage.getItem("video"),e.next=13,new Promise((function(e,t){l.f.on(l.b.GotStream,(function t(n){l.f.off(l.b.GotStream,t),e(n)})),l.f.setVideo(n)})).then(z);case 13:return e.next=15,new Promise((function(e,n){l.f.on(l.b.GotStream,(function t(n){l.f.off(l.b.GotStream,t),l.f.on(l.b.GotStream,z),e(n)})),l.f.setAudio(t)})).then(z);case 15:v(!0);case 16:case"end":return e.stop()}}),e)})))(),window.addEventListener("unload ",e),function(){e()}}),[]);var V=window.media={devices:g,settings:C,resolutions:R,localStream:_,init:function(){n<=0&&P(),++n},stop:function(){--n},getDevices:P,setVideo:function(e,t){l.f.setVideo(e,t)},setAudio:function(e){l.f.setAudio(e)},ready:p};return Object(m.jsx)(f.Provider,{value:V,children:t})}},460:function(e,t,n){var a={"./Battery.jsx":[471,3],"./Devices.jsx":[472,4],"./Pose.jsx":[469,8,5],"./Selfie.jsx":[473,6],"./Shader.jsx":[470,7]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=460,e.exports=r},462:function(e,t,n){},463:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(40),c=n.n(o),i=function(e){e&&e instanceof Function&&n.e(9).then(n.bind(null,497)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),o(e),c(e)}))},s=(n(157),n(195)),l=n(495),d=n(0);c.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(r.a.Suspense,{children:Object(d.jsx)(s.a,{}),fallback:Object(d.jsx)(l.a,{className:"start-50",animated:!0,now:100})})}),document.getElementById("root")),i()},5:function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return h})),n.d(t,"g",(function(){return k})),n.d(t,"d",(function(){return x})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return w}));var a=n(12),r=n.n(a),o=n(15),c="background: hsla(0, 0%, 13%, 1); color: hsla(74, 64%, 60%, 1)",i={ClientConnected:"client_connected",ClientDisconnected:"client_disconnected",Error:"error",IncomingCall:"incoming_call",CallAccepted:"call_accepted",CallCanceled:"call_canceled",CallOpened:"call_opened",CallClosed:"call_closed",CallHangup:"call_hangup"};function s(e,t,n,a){var c=null,i=[],s={},l=!1,d=function(){var a=Object(o.a)(r.a.mark((function a(){var o;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(c){a.next=2;break}return a.abrupt("return");case 2:return o={callid:e,caller:t,callee:n},a.next=5,c.getStats(null).then((function(e){var t=null;return e.forEach((function(e){"candidate-pair"!==e.type||!0!==e.selected&&"succeeded"!==e.state||(t=e)})),t&&e.forEach((function(e){var n,a;e.id===t.localCandidateId&&(o.localType=e.candidateType,o.localAddress=null!==(n=e.address)&&void 0!==n?n:e.ip,o.localPort=e.port,o.localProtocol=e.protocol);e.id===t.remoteCandidateId&&(o.remoteType=e.candidateType,o.remoteAddress=null!==(a=e.address)&&void 0!==a?a:e.ip,o.remotePort=e.port,o.remoteProtocol=e.protocol)})),Promise.resolve(o)}));case 5:return a.abrupt("return",a.sent);case 6:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}();return{get callid(){return e},get caller(){return t},get callee(){return n},get iceServers(){return a},bind:function(e,t){return e instanceof RTCPeerConnection&&(l=t,(c=e).addEventListener("datachannel",(function(e){s[e.channel.label]=e.channel,e.channel.addEventListener("onclose",(function(e){delete s[e.channel.label]}))})),!0)},close:function(){var e;null===(e=c)||void 0===e||e.close()},isInitiator:function(){return l},getState:function(){return c?c.iceConnectionState:"closed"},getStats:d,addCandidate:function(e){c?c.addIceCandidate(e):i.push(e)},gatherPendingCandidates:function(){i.length>0&&(i.forEach((function(e){return c.addIceCandidate(e)})),i=[])},setRemoteDescription:function(e){return!!c&&(c.setRemoteDescription(e),!0)},setBandwidth:function(e){if(!c)return!1;var t=c.getSenders();if(!t)return!1;for(var n=0;n<t.length;n++){var a=t[n],r=a.getParameters();r.encodings||(r.encodings=[{}]),r.encodings[0].maxBitrate=1e3*e,a.setParameters(r)}return!0},getRemoteAudioTrack:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!c)return null;var t=c.getReceivers();if(!t)return null;for(var n=[],a=0;a<t.length;a++){var r=t[a];"audio"===r.track.kind&&n.push(r.track)}return e>=0&&e<n.length?n[e]:null},getRemoteVideoTrack:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!c)return null;var t=c.getReceivers();if(!t)return null;for(var n=[],a=0;a<t.length;a++){var r=t[a];"video"===r.track.kind&&n.push(r.track)}return e>=0&&e<n.length?n[e]:null},getRemoteStream:function(){if(!c)return null;var e=c.getReceivers();if(!e)return null;for(var t=[],n=0;n<e.length;n++){var a=e[n];a.track&&t.push(a.track)}if(0===t.length)return null;for(var r=new MediaStream,o=0;o<t.length;o++){var i=t[o];r.addTrack(i)}return r},replaceLocalAudioTrack:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!c||!e)return!1;for(var n=[],a=c.getSenders(),r=0;r<a.length;r++){var o=a[r];o.track&&"audio"===o.track.kind&&n.push(o)}return t>=0&&t<n.length&&(n[t].replaceTrack(e),!0)},replaceLocalVideoTrack:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!c||!e)return!1;for(var n=[],a=c.getSenders(),r=0;r<a.length;r++){var o=a[r];o.track&&"video"===o.track.kind&&n.push(o)}return t>=0&&t<n.length&&(n[t].replaceTrack(e),!0)},openChannel:function(e){if(!c||e in s)return!1;var t=c.createDataChannel(e);return s[e]=t,t.addEventListener("onclose",(function(e){delete s[t.label]})),!0},closeChannel:function(e){return!(!c||!(e in s))&&(s[e].close(),delete s[e],!0)},onDataChannel:function(e){return!!c&&(c.addEventListener("datachannel",e),!0)},onChannelOpen:function(e,t){return!!(c&&e in s&&t instanceof Function)&&(s[e].onopen=t,!0)},onChannelClose:function(e,t){return!!(c&&e in s&&t instanceof Function)&&(s[e].addEventListener("onclose",t),!0)},onChannelError:function(e,t){return!!(c&&e in s&&t instanceof Function)&&(s[e].onerror=t,!0)},onChannelMessage:function(e,t){return!!(c&&e in s&&t instanceof Function)&&(s[e].onmessage=t,!0)},sendData:function(e,t){if(!c||!(e in s))return!1;var n=s[e];return"open"===n.readyState&&(n.send(t),!0)}}}var l="background: hsla(0, 0%, 13%, 1); color: hsla(180, 89%, 45%, 1)",d={ClientConnected:"client_connected",ClientDisconnected:"client_disconnected",Error:"error",UserOnline:"user_online",UserOffline:"user_offline",RoomCreated:"room_created",RoomDeleted:"room_deleted",GuestJoinedRoom:"guest_joined_room",GuestLeftRoom:"guest_left_room",UserRejoined:"user_rejoined",UserKicked:"user_kicked",ChatText:"chat_text"};var u,m=n(8),b=n(2),f=n(6),j=n(28),h={GotDevices:"got_devices",ErrorDevices:"error_devices",GotResolutions:"got_resolutions",GotStream:"got_stream",ErrorStream:"error_stream"};function p(){var e=new AudioContext,t=e.createGain(),n=e.createOscillator();n.connect(t);var a=t.connect(e.createMediaStreamDestination());return t.gain.setValueAtTime(0,e.currentTime),n.start(),a.stream}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:320,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:240,n=window.document.createElement("canvas");n.width=e,n.height=t;var a=n.getContext("2d"),r=null;function o(){a?a.fillRect(0,0,e,t):window.clearInterval(r)}r=window.setInterval(o,1e3);var c=n.captureStream();return c}var O=null!==(u="true")&&u,x=window.appClient=new function(){var e={},t={},n=null,a=null,r=null,o=function(e){if(-1==Object.values(d).indexOf(e))return!1;var n=[].slice.call(arguments,1);if("object"===typeof t[e])for(var a=t[e].slice(),r=0;r<a.length;r++)a[r].apply(this,n);return!0},c=function(e){console.log("%cconnected%o",l,a.url),m(),o(d.ClientConnected,{url:a.url})},i=function(e){console.log("%cdisconnected%o",l,a.url),b(),o(d.ClientDisconnected,{url:a.url})},s=function(t){var n=JSON.parse(t.data);if("pong"!==n.event){if(console.log(" %c%s%o",l,n.event,n.data),n.data.uuid in e){var a=e[n.data.uuid];return delete e[n.data.uuid],delete n.data.uuid,void a(n)}o(n.event,n)}},u=function(t,r){if(!a||a.readyState!==WebSocket.OPEN)return!1;t.data.token=n,t.data.uuid=j(),r instanceof Function&&(e[t.data.uuid]=r);var o=JSON.stringify(t);return a.send(o),"ping"!==t.event&&console.log(" %c%s%o",l,t.event,o),!0},m=function e(){a&&a.readyState===WebSocket.OPEN&&(f(),r=window.setTimeout(e,5e3))},b=function(){window.clearTimeout(r)},f=function(){return u({event:"ping",data:{}})},j=function(){return h()},h=function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))};return{on:function(e,n){return-1!=Object.values(d).indexOf(e)&&(n instanceof Function&&("object"!==typeof t[e]&&(t[e]=[]),t[e].push(n),!0))},off:function(e,n){if(-1==Object.values(d).indexOf(e))return!1;if(!(n instanceof Function))return!1;if("object"===typeof t[e]){var a=t[e].indexOf(n);if(a>-1)return t[e].splice(a,1),!0}return!1},connect:function(e,t){n=t,(a=new WebSocket(e+"?token="+n)).onopen=c,a.onmessage=s,a.onclose=i},disconnect:function(){var e;null===(e=a)||void 0===e||e.close()},getRoom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={event:"get_room",data:{}};return u(t,null===e||void 0===e?void 0:e.response)},getRooms:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={event:"get_rooms",data:{}};return u(t,null===e||void 0===e?void 0:e.response)},createRoom:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={event:"create_room",data:{name:e,password:null===t||void 0===t?void 0:t.password,hidden:null===t||void 0===t?void 0:t.hidden,size:null===t||void 0===t?void 0:t.size,icon:null===t||void 0===t?void 0:t.icon}};return u(n,null===t||void 0===t?void 0:t.response)},joinRoom:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={event:"join_room",data:{name:e,password:null===t||void 0===t?void 0:t.password}};return u(n,null===t||void 0===t?void 0:t.response)},leaveRoom:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={event:"leave_room",data:{}};return u(t,null===e||void 0===e?void 0:e.response)},kickUser:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={event:"kick_user",data:{target:e}};return u(n,null===t||void 0===t?void 0:t.response)},sendText:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={event:"send_text",data:{text:e}};return u(n,null===t||void 0===t?void 0:t.response)}}}({debug:O}),g=window.mediaAdapter=new function(){var e={},t=null,n=null,a=null,c={},i={},s={Undefined:{},"320x240":{width:320,height:240},"640x360":{width:640,height:360},"640x480":{width:640,height:480},"1280x720":{width:1280,height:720},"1920x1080":{width:1920,height:1080},"3840x2160":{width:3840,height:2160}},l={audio:{deviceId:{exact:void 0}}},d={video:{deviceId:{exact:void 0},width:{exact:void 0},height:{exact:void 0},frameRate:{ideal:60}}},u={audio:"None",video:"None",resolution:"Undefined"},O=null,x=null,g=function(t){if(-1==Object.values(h).indexOf(t))return!1;var n=[].slice.call(arguments,1);if("object"===typeof e[t])for(var a=e[t].slice(),r=0;r<a.length;r++)a[r].apply(this,n);return!0},w=function(){var e=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){e.next=2;break}return e.abrupt("return",!1);case 2:return t=new p,n=new v,a=D(t,n),e.next=7,window.navigator.mediaDevices.getUserMedia({audio:!0}).catch((function(e){return console.error(e)}));case 7:return e.next=9,window.navigator.mediaDevices.getUserMedia({video:!0}).catch((function(e){return console.error(e)}));case 9:return e.next=11,k();case 11:return e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",y().then(C).catch(S));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){return window.navigator.mediaDevices.enumerateDevices()},C=function(e){i={},(c={}).None="",i.None="";var t,n=0,a=0,r=Object(j.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;if("audioinput"===o.kind){var l=""===o.label?"Audio input "+n:o.label;c[l]=o.deviceId,n++}if("videoinput"===o.kind){var d=""===o.label?"Video input "+a:o.label;i[d]=o.deviceId,a++}}}catch(m){r.e(m)}finally{r.f()}g(h.GotDevices,{audioDevices:c,videoDevices:i,settings:u}),g(h.GotResolutions,{resolutions:s,settings:u})},S=function(e){g(h.ErrorDevices,{error:e,message:"Device request not allowed in the browser"})},N=function(){return a=null,P(t),window.navigator.mediaDevices.getUserMedia(l).then(R).catch(T)},E=function(){return a=null,P(n),window.navigator.mediaDevices.getUserMedia(d).then(A).catch(_)},R=function(){var e=Object(o.a)(r.a.mark((function e(o){var i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=o.getAudioTracks()[0]).label in c){e.next=4;break}return e.next=4,k();case 4:u.audio=i.label,a=D(t=o,n),g(h.GotStream,{stream:a,settings:u});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(o.a)(r.a.mark((function e(o){var c,l,j,p,v;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=o.getVideoTracks()[0],l=c.getSettings(),c.label in i){e.next=5;break}return e.next=5,k();case 5:j=l.width,p=l.height,s[v=j+"x"+p]||(s[v]={width:j,height:p},s=Object.entries(s).sort((function(e,t){return(e[1].width||Number.NEGATIVE_INFINITY)>(t[1].width||Number.NEGATIVE_INFINITY)})).reduce((function(e,t){var n=Object(f.a)(t,2),a=n[0],r=n[1];return Object(b.a)(Object(b.a)({},e),{},Object(m.a)({},a,r))}),{}),g(h.GotResolutions,{resolutions:s,settings:u})),d.video.width.exact=j,d.video.height.exact=p,u.video=c.label,u.resolution=v,a=D(t,n=o),g(h.GotStream,{stream:a,settings:u});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(e){return"NotFoundError"===e.name||"DevicesNotFoundError"===e.name?"Required track is missing":"NotReadableError"===e.name||"TrackStartError"===e.name?"Microphone or Webcam are already in use":"OverconstrainedError"===e.name||"ConstraintNotSatisfiedError"===e.name?"Invalid device settings":"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?"Permission denied in browser":"TypeError"===e.name||"TypeError"===e.name?"Empty constraints object":"Unknown error"},T=function(e){var t=I(e);g(h.ErrorStream,{error:e.name,message:t,settings:u}),O&&(l=L(O),O=null,N())},_=function(e){var t=I(e);g(h.ErrorStream,{error:e.name,message:t,settings:u}),x&&(d=L(x),x=null,E())},D=function(e,t){var n=e.getAudioTracks();if(!n||0===n.length)return null;var a=t.getVideoTracks();if(!a||0===a.length)return null;var r=new MediaStream;return r.addTrack(n[0]),r.addTrack(a[0]),r},P=function(e){e.getTracks().forEach((function(e){return e.stop()}))},L=function(e){return JSON.parse(JSON.stringify(e))};return{on:function(t,n){return-1!=Object.values(h).indexOf(t)&&(n instanceof Function&&("object"!==typeof e[t]&&(e[t]=[]),e[t].push(n),!0))},off:function(t,n){if(-1==Object.values(h).indexOf(t))return!1;if(!(n instanceof Function))return!1;if("object"===typeof e[t]){var a=e[t].indexOf(n);if(a>-1)return e[t].splice(a,1),!0}return!1},start:w,findDevices:k,getDevices:y,setAudio:function(e){if(e||(e="None"),!(e in c)){var r="Audio device "+e+" not found";g(h.ErrorStream,{error:"DeviceNotFound",message:r,settings:u}),e="None"}if("None"===e)u.audio=e,t=new p,a=D(t,n),g(h.GotStream,{stream:a,settings:u});else{O=L(l);var o=c[e];l.audio.deviceId.exact=o,N()}},setVideo:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Undefined";if(e||(e="None",r="Undefined"),r||(r="Undefined"),!(e in i)){var o="DeviceNotFound",c="Video device "+e+" not found";g(h.ErrorStream,{error:o,message:c,settings:u}),e="None"}if(!(r in s)){var l="ResolutionNotFound",m="Resolution "+r+" not found";g(h.ErrorStream,{error:l,message:m,settings:u}),r="Undefined"}if("None"===e){u.video=e,u.resolution=r;var b=s[r].width,f=s[r].height;n=new v(b,f),a=D(t,n),g(h.GotStream,{stream:a,settings:u})}else{x=L(d);var j=i[e];d.video.deviceId.exact=j;var p=s[r].width,O=s[r].height;d.video.width.exact=p,d.video.height.exact=O,E()}}}}({debug:O}),w=window.dummyStream=new function(){var e=null,t=null,n=null,a=null,r=null;!function(){var e=new AudioContext,n=e.createGain();e.createOscillator().connect(n);var r=n.connect(e.createMediaStreamDestination());t=r.stream,a=t.getAudioTracks()[0]}(),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:320,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:240;e||(e=window.document.createElement("canvas")),e.width=t,e.height=a;var o=e.getContext("2d");o.fillRect(0,0,t,a),n=e.captureStream(),r=n.getVideoTracks()[0]}();var o=new MediaStream([a,r]);return{getAudioTrack:function(){return a},getVideoTrack:function(){return r},getStream:function(){return o}}}({debug:O}),k=window.rtcClient=new function(e){e||(e=new MediaStream);var t={},n={},a=null,l={},d=null,u=null,m=function(e){if(-1==Object.values(i).indexOf(e))return!1;var t=[].slice.call(arguments,1);if("object"===typeof n[e])for(var a=n[e].slice(),r=0;r<a.length;r++)a[r].apply(this,t);return!0},b=function(e){console.log("%cconnected%o",c,d.url),p(),m(i.ClientConnected,{url:d.url})},f=function(e){console.log("%cdisconnected%o",c,d.url),v(),m(i.ClientDisconnected,{url:d.url})},j=function(e){var n=JSON.parse(e.data);if("pong"!==n.event){switch(console.log(" %c%s%o",c,n.event,n.data),n.event){case"call_response":y(n);break;case"incoming_call":C(n);break;case"call_accepted":S(n);break;case"call_canceled":N(n);break;case"remote_offer":E(n);break;case"remote_answer":R(n);break;case"remote_candidate":A(n);break;case"call_hangup":I(n)}if(n.data.uuid in t){var a=t[n.data.uuid];return delete t[n.data.uuid],delete n.data.uuid,void a(n)}m(n.event,n)}},h=function(e,n){if(!d||d.readyState!==WebSocket.OPEN)return!1;e.data.token=a,e.data.uuid=w(),n instanceof Function&&(t[e.data.uuid]=n);var r=JSON.stringify(e);return d.send(r),"ping"!==e.event&&console.log(" %c%s%o",c,e.event,r),!0},p=function e(){d&&d.readyState===WebSocket.OPEN&&(O(),u=window.setTimeout(e,5e3))},v=function(){window.clearTimeout(u)},O=function(){return h({event:"ping",data:{}})},x=function(e){if(!(e in l))return!1;var t=l[e];return t.close(),delete l[e],m(i.CallClosed,{call:t}),!0},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){if(!x(e))return!1;var n={event:"hangup",data:{callid:e}};return h(n,null===t||void 0===t?void 0:t.response)}for(var a in l)if(x(a)){var r={event:"hangup",data:{callid:a}};h(r)}return l={},!0},w=function(){return k()},k=function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))},y=function(e){var t=new s(e.data.callid,e.data.caller,e.data.callee,JSON.parse(e.data.iceServers));l[t.callid]=t},C=function(e){var t=new s(e.data.callid,e.data.caller,e.data.callee,JSON.parse(e.data.iceServers));l[t.callid]=t},S=function(t){var n=l[t.data.callid],a={iceServers:n.iceServers},r=new RTCPeerConnection(a);n.bind(r,!0),r.oniceconnectionstatechange=function(e){T(n)},r.onicecandidate=function(e){if(e.candidate&&""!==e.candidate){var n={event:"candidate",data:{callid:t.data.callid,candidate:JSON.stringify(e.candidate)}};h(n)}},r.onnegotiationneeded=function(e){r.createOffer().then((function(e){r.setLocalDescription(e);var n={event:"offer",data:{callid:t.data.callid,offer:JSON.stringify(e)}};h(n)}))},e.getTracks().forEach((function(e){return r.addTrack(e)})),r.createDataChannel("default")},N=function(e){x(e.data.callid)},E=function(t){var n=l[t.data.callid],a={iceServers:n.iceServers},r=new RTCPeerConnection(a);n.bind(r,!1),r.oniceconnectionstatechange=function(e){T(n)},r.setRemoteDescription(JSON.parse(t.data.offer)),n.gatherPendingCandidates(),r.onicecandidate=function(e){if(e.candidate&&""!==e.candidate){var n={event:"candidate",data:{callid:t.data.callid,candidate:JSON.stringify(e.candidate)}};h(n)}},e.getTracks().forEach((function(e){return r.addTrack(e)})),window.setTimeout((function(){r.createAnswer().then((function(e){r.setLocalDescription(e);var n={event:"answer",data:{callid:t.data.callid,answer:JSON.stringify(e)}};h(n)}))}),500)},R=function(e){if(e.data.callid in l){var t=JSON.parse(e.data.answer);l[e.data.callid].setRemoteDescription(t)}},A=function(e){var t=JSON.parse(e.data.candidate);t&&t.candidate&&""!==t.candidate&&(e.data.callid in l&&l[e.data.callid].addCandidate(t))},I=function(e){x(e.data.callid)},T=function(){var e=Object(o.a)(r.a.mark((function e(t){var n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.getState(),console.log("%cConnection State%o%o",c,t.callid,n),e.t0=n,e.next="failed"===e.t0||"disconnected"===e.t0||"closed"===e.t0?5:"new"===e.t0||"checking"===e.t0||"completed"===e.t0?7:"connected"===e.t0?8:12;break;case 5:return g(t.callid),e.abrupt("break",12);case 7:return e.abrupt("break",12);case 8:return a=t.getRemoteStream(),console.log("%c"+i.CallOpened+"%o%o",c,t.callid,a),m(i.CallOpened,{call:t,stream:a}),e.abrupt("break",12);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{on:function(e,t){return-1!=Object.values(i).indexOf(e)&&(t instanceof Function&&("object"!==typeof n[e]&&(n[e]=[]),n[e].push(t),!0))},off:function(e,t){if(-1==Object.values(i).indexOf(e))return!1;if(!(t instanceof Function))return!1;if("object"===typeof n[e]){var a=n[e].indexOf(t);if(a>-1)return n[e].splice(a,1),!0}return!1},connect:function(e,t){a=t,(d=new WebSocket(e+"?token="+a)).onopen=b,d.onmessage=j,d.onclose=f},disconnect:function(){var e;null===(e=d)||void 0===e||e.close()},getCall:function(e){return e in l?l[e]:null},getCalls:function(){return l},call:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={event:"call",data:{callee:e,callid:null===t||void 0===t?void 0:t.callid}};return h(n,null===t||void 0===t?void 0:t.response)},acceptCall:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(e in l))return!1;var n=l[e],a={event:"accept_call",data:{callid:n.callid}};return h(a,null===t||void 0===t?void 0:t.response)},cancelCall:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(e in l))return!1;var n=l[e];delete l[e];var a={event:"cancel_call",data:{callid:n.callid}};return h(a,null===t||void 0===t?void 0:t.response)},hangup:g}}(w.getStream()),y=d;window.BRA={APPEvent:y,RTCEvent:i,MediaEvent:h,rtcClient:k,appClient:x,mediaAdapter:g,dummyStream:w}},61:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(8),r=n(2),o=n(28),c=n(6),i=n(7),s=n(5),l=n(10),d=n(1),u=n(46),m=n(26),b=n(22),f=n(0),j=["children"],h=[],p=Object(d.createContext)();t.b=function(e){var t=e.children,n=(Object(i.a)(e,j),Object(d.useContext)(m.a)),v=Object(d.useContext)(b.a),O=Object(d.useContext)(u.a),x=Object(d.useState)(0),g=Object(c.a)(x,2),w=(g[0],g[1]),k=Object(d.useState)({}),y=Object(c.a)(k,2),C=y[0],S=y[1],N=Object(d.useState)(O.localStream),E=Object(c.a)(N,2),R=E[0],A=E[1];function I(e,t,a){var r,o=null!==t&&void 0!==t?t:function(e){e.event;var t=e.data,n=(t.callid,t.error),a=t.message;n&&l.b.error("Call error: ".concat(a),{icon:Object(f.jsx)("i",{className:"bi bi-telephone-x"}),duration:5e3})},c=(null===(r=n.user)||void 0===r?void 0:r.username)+"_"+e;if(a){var i=s.g.getCall(a);i&&(c=i.caller+"_"+c)}return s.g.call(e,{response:o,callid:c})}function T(e){s.g.hangup(e)}function _(e){e.event;var t=e.data,n=t.callid;t.caller;s.g.acceptCall(n)}function D(e){var t=e.call,n=e.stream,o=t.callid;C=Object(r.a)(Object(r.a)({},C),{},Object(a.a)({},o,n)),S(C);var c=h[o];if(c){var i=C[c];if(!i)return T(o),l.b.error("Live Call Error: ".concat(o,", callerId: ").concat(t.caller,", calleeId: ").concat(t.callee," "));l.b.success("Live Call: ".concat(o,", callerId: ").concat(t.caller,", calleeId: ").concat(t.callee," "));var s=i.getVideoTracks()[0],d=i.getAudioTracks()[0];t.replaceLocalVideoTrack(s),t.replaceLocalAudioTrack(d),Object(l.b)("Forwarding stream",{icon:Object(f.jsx)("i",{className:"bi bi-cast"})})}else{if(l.b.success("Incoming Call: ".concat(o,", callerId: ").concat(t.caller,", calleeId: ").concat(t.callee," ")),!window.localStream)return;var u=window.localStream.getVideoTracks()[0],m=window.localStream.getAudioTracks()[0];t.replaceLocalVideoTrack(u),t.replaceLocalAudioTrack(m),Object(l.b)("Call from ".concat(z(o)),{icon:Object(f.jsx)("i",{className:"bi bi-telephone-inbound"})})}}function P(e){var t=e.call;if(!t)return console.error("No call");var n=t.callid;U(n),delete C[n],S(Object(r.a)({},C)),Object(l.b)("Call from ".concat(z(n)," closed"),{icon:Object(f.jsx)("i",{className:"bi bi-telephone-x"})})}function L(e){e.event;var t=e.data.callid;if(!t)return console.error("No call");U(t),delete C[t],S(Object(r.a)({},C)),Object(l.b)("User ".concat(z(t)," hangup"),{icon:Object(f.jsx)("i",{className:"bi bi-telephone-x"})})}function U(e){for(var t=null,n=0,a=Object.entries(h);n<a.length;n++){var r=Object(c.a)(a[n],2),o=r[0],i=r[1];if(e===o||i===e){t=[o,i];break}}if(t){var s=t,l=Object(c.a)(s,2),d=l[0];l[1];delete h[d]}}function z(e){var t,a=null===(t=n.user)||void 0===t?void 0:t.username,r=s.g.getCalls()[e];if("local"!==e&&r){var o,c=r.callee,i=r.caller;a=c===(null===(o=n.user)||void 0===o?void 0:o.username)?i:c}return a}Object(d.useEffect)((function(){return s.g.on(s.c.IncomingCall,_),s.g.on(s.c.CallOpened,D),s.g.on(s.c.CallClosed,P),s.g.on(s.c.CallHangup,L),function(){s.g.off(s.c.IncomingCall,_),s.g.off(s.c.CallOpened,D),s.g.off(s.c.CallClosed,P),s.g.off(s.c.CallHangup,L)}}),[]),Object(d.useEffect)((function(){w((function(e){return e+1})),R=O.localStream,A(R)}),[O.localStream]);var F=window.wrtc={callUser:I,callAllUsers:function(){var e,t,a,r=null===(e=v.current)||void 0===e||null===(t=e.users)||void 0===t?void 0:t.filter((function(e,t,a){var r;return e&&(null===e||void 0===e?void 0:e.username)!==(null===(r=n.user)||void 0===r?void 0:r.username)})),c=Object(o.a)(null!==r&&void 0!==r?r:[]);try{for(c.s();!(a=c.n()).done;){var i=a.value;I(null===i||void 0===i?void 0:i.username)||l.b.error("Call missed to ".concat(null===i||void 0===i?void 0:i.username))}}catch(s){c.e(s)}finally{c.f()}},callHangup:T,callHangupAll:function(){for(var e=0,t=Object.keys(s.g.getCalls());e<t.length;e++){T(t[e])}},forwardCall:function(e,t){if(!t||!e)return console.error("source or target callId's are undefined");h[t]=e},getUserId:z,getLiveCall:function(e){var t;return null!==(t=Object.entries(h).find((function(t){return t[1]===e})))&&void 0!==t?t:[null,null]},replaceStream:function(e){for(var t in s.g.getCalls()){var n=e,a=h[t];a&&C[a]&&(n=C[a]);var r=s.g.getCall(t),o=n.getAudioTracks()[0],c=n.getVideoTracks()[0];r.replaceLocalVideoTrack(c),r.replaceLocalAudioTrack(o)}},streams:Object(r.a)(Object(r.a)({},C),{},{local:R})};return Object(f.jsx)(p.Provider,{value:F,children:t})}}},[[463,1,2]]]);
//# sourceMappingURL=main.57cac42c.chunk.js.map