(this["webpackJsonpadmire-pwa"]=this["webpackJsonpadmire-pwa"]||[]).push([[0],{125:function(e,t,n){"use strict";t.a=n.p+"static/media/logo.f23962e9.png"},152:function(e,t,n){"use strict";var a=n(2),r=n(5),o=n(8),c=n(20),i=n.n(c),s=n(65),l=n(1),d=n(0),u=["id","stream","onClick","isLocal"];t.a=function(e){var t,n=e.id,c=e.stream,b=e.onClick,m=e.isLocal,f=void 0!==m&&m,j=Object(o.a)(e,u),h=Object(l.useRef)(null),p=Object(l.useState)({audio:!0}),v=Object(r.a)(p,2),O=v[0],g=v[1];return Object(l.useEffect)((function(){c&&h.current&&(h.current.srcObject=c,h.current.play())}),[c]),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{className:"jsx-3322625953 "+"Video ".concat(null!==(t=j.className)&&void 0!==t?t:""),children:[Object(d.jsxs)("div",{className:"jsx-3322625953 stream-status position-absolute bottom-0 start-0",children:[Object(d.jsxs)("span",{className:"jsx-3322625953 status-user",children:[" ",n," "]}),Object(d.jsx)(s.a,{className:"status-audio",variant:"link",disabled:f,onClick:function(){g(Object(a.a)(Object(a.a)({},O),{},{audio:!O.audio}))},children:f?Object(d.jsx)("i",{className:"jsx-3322625953 "+"bi bi-mic".concat(!f&&null!==O&&void 0!==O&&O.audio?"":"-mute")}):Object(d.jsx)("i",{className:"jsx-3322625953 "+"fs-4 bi bi-volume".concat(!f&&null!==O&&void 0!==O&&O.audio?"-down":"-mute")})})]}),Object(d.jsx)("video",{autoPlay:!0,playsInline:!0,muted:f||!(null!==O&&void 0!==O&&O.audio),ref:h,onClick:b,className:"jsx-3322625953"})]}),Object(d.jsx)(i.a,{id:"3322625953",children:[".Video{position:relative;margin:1px;padding:0;border:1px solid #494E58;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out;}",".Video:hover,.Video .selected{border:1px solid #057bbb;}",".Video .stream-status{color:white !important;z-index:1000;}",".Video .stream-status .status-user{padding:0rem 0.5rem;padding-right:0;}",".Video .stream-status .status-audio{color:white !important;cursor:pointer;padding:0;margin-bottom:-1.2rem;margin-top:-1.4rem;margin-left:-0.2rem;}",".Video video{width:100%;height:100%;object-fit:cover;margin-bottom:-4px;}"]})]})}},190:function(e,t,n){"use strict";(function(e){var a=n(2),r=n(8),o=n(20),c=n.n(o),i=n(191),s=n(12),l=n(56),d=n(18),u=n(215),b=n(207),m=n(208),f=n(209),j=n(210),h=n(211),p=n(212),v=(n(457),n(458),n(22)),O=n(82),g=n(49),x=n(27),w=n(0),k=["children"];window.toast=s.b,t.a=function(t){t.children;var n=Object(r.a)(t,k);return Object(w.jsxs)("div",Object(a.a)(Object(a.a)({id:"layout"},n),{},{className:"jsx-3991789039 "+(n&&null!=n.className&&n.className||""),children:[Object(w.jsx)(s.a,{id:"toaster",position:"bottom-right",reverseOrder:!0,toastOptions:{duration:2e3,style:{background:"#333",color:"#fff"}}}),Object(w.jsx)(l.a,{basename:"admire-pwa",children:Object(w.jsx)(x.b,{children:Object(w.jsx)(v.b,{children:Object(w.jsx)(g.b,{children:Object(w.jsxs)(O.b,{children:[Object(w.jsxs)(i.a,{children:[Object(w.jsx)("title",{className:"jsx-3991789039",children:"admire"}),Object(w.jsx)("title",{className:"jsx-3991789039",children:n.title}),Object(w.jsx)("meta",{property:"og:url",content:"http://www.admire3d.eu/",className:"jsx-3991789039"}),Object(w.jsx)("meta",{property:"og:type",content:Object({NODE_ENV:"production",PUBLIC_URL:"/admire-pwa",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_URL:"https://admire-dev-auth.brainstorm3d.com",REACT_APP_APP_URL:"wss://admire-dev-lobby.brainstorm3d.com",REACT_APP_BASE:"admire-pwa",REACT_APP_COOKIES_EXPIRE_TIME:"30",REACT_APP_DEBUG:"true",REACT_APP_NAME:"admire",REACT_APP_OG_DESC:"Advanced Mixed Realities",REACT_APP_OG_IMAGE:"http://www.admire3d.eu/wp-content/uploads/2021/02/admire.jpg",REACT_APP_OG_TITLE:"AdMiRe",REACT_APP_OG_URL:"http://www.admire3d.eu/",REACT_APP_RTC_URL:"wss://admire-dev-rtc.brainstorm3d.com"}).REACT_APP_OG_TYPE,className:"jsx-3991789039"}),Object(w.jsx)("meta",{property:"og:title",content:"AdMiRe",className:"jsx-3991789039"}),Object(w.jsx)("meta",{property:"og:description",content:"Advanced Mixed Realities",className:"jsx-3991789039"}),Object(w.jsx)("meta",{property:"og:image",content:e.envREACT_APP_OG_IMAGE,className:"jsx-3991789039"})]}),Object(w.jsx)(p.a,{}),Object(w.jsxs)("div",{className:"jsx-3991789039 z-top d-flex m-2 position-absolute top-0 end-0",children:[Object(w.jsx)(j.a,{}),Object(w.jsx)(f.a,{}),Object(w.jsx)(h.a,{})]}),Object(w.jsxs)(d.d,{children:[Object(w.jsx)(d.b,{component:u.a,exact:!0,path:["/","/settings","/about","/users","/chat","/profile","/room/:roomId","/room/:roomId/chat","/room/:roomId/guests"]}),Object(w.jsx)(d.b,{component:b.a,exact:!0,path:"/verified/:token"}),Object(w.jsx)(d.b,{component:m.a,exact:!0,path:"/reset-password/:token"}),Object(w.jsxs)(d.b,{children:[" ",Object(w.jsx)(d.a,{to:"/"})," "]})]})]})})})})}),Object(w.jsx)(c.a,{id:"3991789039",children:["#layout{text-align:center;background:#1B222E;}","#title{color:#D1D3D5;-webkit-filter:invert(0.5) brightness(0.5);filter:invert(0.5) brightness(0.5);mix-blend-mode:luminosity;}",".z-top{z-index:1000;}"]})]}))}}).call(this,n(132))},207:function(e,t,n){"use strict";var a=n(18),r=n(25),o=n(21),c=n(0);t.a=function(){var e=Object(a.g)();return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)(o.a,{size:"md",show:!0,title:Object(c.jsx)("h2",{className:"user-select-none",children:"User verified!\ud83c\udf89\ud83c\udf89"}),button_tittle:"Understood",callback:function(){e.push("/")},children:Object(c.jsx)(r.a,{className:"user-select-none",children:"Account verified successfully in the system. You can now login on the application."})})})}},208:function(e,t,n){"use strict";var a=n(14),r=n.n(a),o=n(19),c=n(6),i=n(2),s=n(5),l=n(12),d=n(1),u=n(18),b=n(218),m=n(463),f=n(461),j=n(65),h=n(156),p=n(50),v=n(25),O=n(21),g=n(0);t.a=function(){var e,t=Object(u.h)().token,n=Object(u.g)(),a=Object(d.useRef)(null),x=Object(d.useState)(void 0),w=Object(s.a)(x,2),k=w[0],C=w[1],y=Object(d.useState)({formErrors:{}}),S=Object(s.a)(y,2),I=S[0],N=S[1];function E(){return(E=Object(o.a)(r.a.mark((function e(a){var o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),o=l.b.loading("Resetting password..."),c=I.password,e.next=5,p.a.post("".concat("https://admire-dev-auth.brainstorm3d.com","/reset-password/").concat(t),{data:{password:c}}).then((function(e){var t=e.status,a=e.description,r=e.message;switch(t){case"ok":l.b.success("Success",{id:o}),setTimeout((function(){return n.push("/")}),1e3);break;case 400:l.b.error(r,{id:o});break;case"error":l.b.error(a,{id:o});break;default:l.b.warn(a,{id:o})}})).catch((function(e){l.b.error("Error: ".concat(e),{id:o})}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(d.useEffect)((function(){!function(){var e=!0;for(var t in I)-1!==t.indexOf("_check")&&(e&=I[t]);C(!!e)}()}),[I]),Object(d.useEffect)((function(){C(!1)}),[]),Object(g.jsx)(g.Fragment,{children:Object(g.jsx)(b.a,{validated:k,onSubmit:function(e){return E.apply(this,arguments)},ref:a,children:Object(g.jsxs)(O.a,{closeButton:!0,show:!0,onHide:function(){return n.push("/")},title:Object(g.jsx)("h2",{className:"user-select-none",children:"Reset password"}),buttons:[Object(g.jsx)(m.a,{placement:"bottom",overlay:Object(g.jsx)(f.a,{className:"".concat(k?"d-none":""," mt-2"),id:"tooltip-bottom",children:"Check form errors"}),children:Object(g.jsx)(j.a,{type:"submit",disabled:!k,children:" Proceed "})})],children:[Object(g.jsx)(v.a,{className:"user-select-none",children:"Please enter your new password."}),Object(g.jsx)(h.a,{controlId:"floatingPassword",label:"New Password",children:Object(g.jsx)(b.a.Control,{required:!0,name:"password",type:"password",placeholder:" ",onChange:function(e){!function(e,t){var n=!1,a=I.formErrors;switch(e){case"email":n=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t),a[e]=n?"":" is invalid";break;case"password":n=t.length>=6,a[e]=n?"":" is too short";break;default:console.warn("Invalid field name: ",e)}N((function(r){var o;return Object(i.a)(Object(i.a)({},r),{},(o={},Object(c.a)(o,e,t),Object(c.a)(o,"".concat(e,"_check"),n),Object(c.a)(o,"formErrors",a),o))}))}(e.target.name,e.target.value)},defaultValue:null!==(e=I.password)&&void 0!==e?e:""})})]})})})}},209:function(e,t,n){"use strict";var a=n(14),r=n.n(a),o=n(19),c=n(2),i=n(5),s=n(1),l=n(65),d=n(21),u=n(25),b=n(0);t.a=function(){var e=Object(s.useState)(!1),t=Object(i.a)(e,2),n=t[0],a=t[1],m=Object(s.useReducer)((function(e,t){return t}),{proposalEvent:void 0}),f=Object(i.a)(m,2),j=f[0],h=f[1];function p(e){e.preventDefault(),h((function(t){return Object(c.a)(Object(c.a)({},t),{},{e:e})}))}function v(){return(v=Object(o.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==j&&void 0!==j&&j.proposalEvent){e.next=2;break}return e.abrupt("return");case 2:return j.proposalEvent.prompt(),e.next=5,j.proposalEvent.userChoice;case 5:t=e.sent,"accepted"===t.outcome&&h((function(e){return Object(c.a)(Object(c.a)({},e),{},{proposalEvent:void 0})}));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){return window.addEventListener("beforeinstallprompt",p,0),function(){window.removeEventListener("beforeinstallprompt",p,0)}}),[]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(l.a,{variant:"link",onClick:function(){return a(1)},children:"About"}),Object(b.jsx)(d.a,{closeButton:!0,size:"md",show:n,setShow:a,title:Object(b.jsxs)("span",{children:["admire"," - Offline capable ",Object(b.jsxs)(l.a,{variant:"".concat(j.proposalEvent?"outline-primary":"outline-secondary"),size:"sm",onClick:function(){return v.apply(this,arguments)},disabled:!j.proposalEvent,children:[" ","".concat(j.proposalEvent?"Install PWA":"Not available")]})]}),children:Object(b.jsx)(u.a,{children:'\n        An offline-capable AdMiRe version is available, wich is a [Progressive Web App](https://docs.microsoft.com/en-us/microsoft-edge/progressive-web-apps-chromium/).\n\n        The app serves the following features:\n        - Offline-capable (with [Service Workers](https://developers.google.com/web/fundamentals/primers/service-workers/))\n        - "Add to Home Screen" feature on Android and iOS supported devices to launch the app from the home screen.\n        - Dark Mode.\n        - Privacy-focused - We don\'t collect any personal data.\n        - Lightweight - The app is only ~5MB.\n\n        Hope you liked using this app \ud83d\ude09\n\n        <div align="center" className="fw-bolder">Made with \u2764\ufe0f by <a href="https://www.upf.edu/web/gti"> UPF-GTI</a> </div>\n        '})})]})}},21:function(e,t,n){"use strict";var a=n(2),r=n(8),o=n(20),c=n.n(o),i=(n(1),n(101)),s=n(65),l=n(0),d=["title","children","show","setShow","callback","buttons","closeButton"];t.a=function(e){var t=e.title,n=e.children,o=e.show,u=e.setShow,b=void 0===u?function(){}:u,m=(e.callback,e.buttons),f=e.closeButton,j=Object(r.a)(e,d);return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsxs)(i.a,Object(a.a)(Object(a.a)({centered:!0,show:o,keyboard:!0,onHide:function(){return b(!1)},dialogClassName:"modal-partial modal-shadow-lg"},j),{},{children:[f&&t&&Object(l.jsx)(i.a.Header,{closeButton:f,children:Object(l.jsx)(i.a.Title,{className:"user-select-none",children:t})}),Object(l.jsx)(i.a.Body,{children:n}),(m||f)&&Object(l.jsxs)(i.a.Footer,{children:[m&&m.map((function(e,t,n){return Object(l.jsx)("div",{className:"jsx-3207617541",children:e},t)})),f&&Object(l.jsx)(s.a,{variant:"outline-secondary",onClick:function(){return b(!1)},children:" Close"})]})]})),Object(l.jsx)(c.a,{id:"3207617541",children:['@charset "UTF-8";',".modal-partial.modal-shadow-lg.modal-md.modal-dialog-centered:focus-visible{outline:none;}",'.modal-partial .modal-title{font-weight:lighter;font-family:"Comfortaa",sans-serif;}',".modal-partial .modal-title h1,.modal-partial .modal-title h2,.modal-partial .modal-title h3,.modal-partial .modal-title h4,.modal-partial .modal-title h5,.modal-partial .modal-title h6{padding:0;margin:0;}",".modal-partial .modal-header{padding-bottom:.2em;}",".modal-partial .modal-footer{padding:0 0.75rem;}","@media only screen and (min-width:321px){}","@media only screen and (orientation:landscape) and (max-height:671px){.modal-dialog{max-width:38rem !important;}}"]})]})}},210:function(e,t,n){"use strict";var a=n(5),r=n(1),o=n(65),c=n(21),i=n(25),s=n(27),l=n(0);t.a=function(){var e=Object(r.useState)(!1),t=Object(a.a)(e,2),n=t[0],d=t[1],u=Object(r.useContext)(s.a);return u.isLogged?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(o.a,{variant:"link",onClick:function(){return d(1)},children:"Profile"}),Object(l.jsxs)(c.a,{closeButton:!0,size:"lg",show:n,setShow:d,title:Object(l.jsx)("h2",{className:"user-select-none",children:u.user.username}),children:[Object(l.jsx)(i.a,{className:"user-select-none",children:'\n        An offline-capable AdMiRe version is available, wich is a [Progressive Web App](https://docs.microsoft.com/en-us/microsoft-edge/progressive-web-apps-chromium/).\n\n        The app serves the following features:\n        - Offline-capable (with [Service Workers](https://developers.google.com/web/fundamentals/primers/service-workers/))\n        - "Add to Home Screen" feature on Android and iOS supported devices to launch the app from the home screen.\n        - Dark Mode.\n        - Privacy-focused - We don\'t collect any personal data.\n        - Lightweight - The app is only ~5MB.\n\n        Hope you liked using this app \ud83d\ude09\n\n        <div align="center" className="fw-bolder">Made with \u2764\ufe0f by <a href="https://www.upf.edu/web/gti"> UPF-GTI</a> </div>\n        '}),Object(l.jsxs)(o.a,{onClick:u.logout,children:[Object(l.jsx)("i",{className:"bi bi-power"})," Log me out"]})]})]}):Object(l.jsx)(l.Fragment,{})}},211:function(e,t,n){"use strict";var a=n(5),r=n(100),o=n(65),c=n(1),i=n(0);t.a=function(){var e=Object(c.useState)(0),t=Object(a.a)(e,2),n=t[0],s=t[1];return Object(c.useEffect)((function(){var e=function(){return s(++n)};return r.a.on("change",e),function(){r.a.off("change",e)}}),[]),Object(i.jsx)("div",{id:"btn_fullscreen",children:r.a.isEnabled&&Object(i.jsxs)(o.a,{onClick:function(){r.a.toggle()},variant:"link",children:[document.fullscreen&&Object(i.jsx)("i",{className:"bi bi-fullscreen-exit"}),!document.fullscreen&&Object(i.jsx)("i",{className:"bi bi-fullscreen"})]})})}},212:function(e,t,n){"use strict";var a=n(1),r=n(462),o=n(125),c=n(22),i=n(0);t.a=function(){var e,t=Object(a.useContext)(c.a);return Object(i.jsx)(i.Fragment,{children:Object(i.jsxs)("div",{id:"title",variant:"none",className:"d-flex m-3 position-absolute top-0 start-0 user-select-none",children:[Object(i.jsx)(r.a,{className:"me-2",width:32,height:32,src:o.a}),Object(i.jsx)("h1",{className:"fs-3",children:"admire"}),(null===t||void 0===t?void 0:t.current)&&Object(i.jsxs)("h1",{className:"fs-3",children:[": #",null===t||void 0===t||null===(e=t.current)||void 0===e?void 0:e.name]})]})})}},215:function(e,t,n){"use strict";var a=n(20),r=n.n(a),o=n(1),c=n(487),i=n(18),s=n(27),l=n(22),d=n(2),u=n(8),b=n(0),m=["children","icon","disabled","to"],f=["children"];function j(e){var t=e.children;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{style:{zIndex:1100},className:"jsx-2579875876 nav-partial px-3 mb-1 d-flex justify-content-evenly align-items-center position-absolute bottom-0 start-50 translate-middle-x shadow rounded-5 bg-light",children:t.map((function(e,t){return e&&Object(b.jsx)("div",{className:"jsx-2579875876",children:e},"nav-i-"+t)}))}),Object(b.jsx)(r.a,{id:"2579875876",children:[".rounded-5{border-radius:.5em;}",".nav-partial{min-width:1rem;min-height:1rem;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out;}",".nav-button,.nav-item{color:#494E58;cursor:pointer;height:100%;width:auto;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out;}",".nav-button i,.nav-item i{-webkit-transform:scale(1.5);-ms-transform:scale(1.5);transform:scale(1.5);width:50px;overflow:hidden;padding:0;margin:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-transform:capitalize;}",".nav-button:hover,.nav-item:hover{color:#eb5a4f;}",".nav-item{height:44px;}",".nav-item-active{color:red !important;}",".nav-item-disabled{opacity:.35;-webkit-user-select:none !important;-moz-user-select:none !important;-ms-user-select:none !important;user-select:none !important;pointer-events:none;cursor:not-allowed;}",".nav-item-disabled:hover{opacity:.35;}",".nav-button{color:black !important;height:3.5rem;width:3.5rem;line-height:3rem;margin-top:-1.5rem;margin-bottom:1.5rem;}",".nav-button:hover{color:#fdf1f0 !important;}",".dark-mode.navpartial,.dark-mode .nav-partial{background-color:transparent !important;border:1px solid rgba(255,255,255,0.25);}",".dark-mode.navpartial .nav-item,.dark-mode .nav-partial .nav-item{color:gray;}",".dark-mode.navpartial .nav-item:hover,.dark-mode .nav-partial .nav-item:hover{color:#eb5a4f;-webkit-filter:saturate(120%) drop-shadow(0 0 0.1rem #d62518);filter:saturate(120%) drop-shadow(0 0 0.1rem #d62518);}",".dark-mode.navpartial .nav-button,.dark-mode .nav-partial .nav-button{-webkit-filter:saturate(80%);filter:saturate(80%);background:#2A313C !important;line-height:2.8rem;border:2px solid #d62518;color:#d62518 !important;}",".dark-mode.navpartial .nav-button:hover,.dark-mode .nav-partial .nav-button:hover{-webkit-filter:saturate(120%) drop-shadow(0 0 0.1rem #d62518);filter:saturate(120%) drop-shadow(0 0 0.1rem #d62518);color:#d62518 !important;border:2px solid #d62518;}","@media only screen and (orientation:landscape) and (max-height:671px){.nav-partial{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;left:100% !important;-webkit-transform:translate(-100%,0%) !important;-ms-transform:translate(-100%,0%) !important;transform:translate(-100%,0%) !important;margin-left:-1.1rem;padding:1.251rem 0 !important;}.nav-partial .nav-button{margin:0;margin-left:-1.5rem;margin-right:1.5rem;}}"]})]})}j.Item=function(e){var t,n=e.children,a=(e.icon,e.disabled),r=e.to,o=Object(u.a)(e,m);return Object(b.jsx)("div",Object(d.a)(Object(d.a)({to:null!==r&&void 0!==r?r:"/",className:"nav-item ".concat(a?"nav-item-disabled":""," ").concat(null!==(t=o.appendclass)&&void 0!==t?t:"")},o),{},{children:Object(b.jsx)("div",{className:"d-flex flex-column fs-6 fw-lighter",children:n})}))},j.Button=function(e){var t,n=e.children,a=Object(u.a)(e,f);return Object(b.jsx)("div",Object(d.a)(Object(d.a)({className:"nav-button ".concat(null!==(t=a.appendclass)&&void 0!==t?t:"")},a),{},{children:Object(b.jsx)("div",{className:" pt-1 fs-1 fw-lighter",children:n})}))};var h=j,p=n(5),v=n(486),O=n(198),g=n(485),x=(n(7),n(152)),w=n(82),k=n(49),C=n(21),y=n(65),S=n(484),I=n(156),N=n(218),E=n(12),R=function(e){var t,n=e.callId,a=e.isForwardCall,r=Object(o.useContext)(w.a),c=Object(o.useRef)(null),i=Object(o.useState)(null),s=Object(p.a)(i,2),l=s[0],d=s[1],u=Object(o.useState)(0),m=Object(p.a)(u,2),f=m[0],j=m[1],h=r.getLiveCall(n),v=Object(p.a)(h,2),O=v[0];v[1];function x(){if(null===c||void 0===c||!c.current||!l)return d(!1);j(!0);var e=[n,c.current.value],t=e[1];r.callUser(t,(function e(t){var n=t.callId,a=t.status,r=t.description;"error"===a?(j(3),setTimeout((function(){j(0)}),2e3),E.b.error("Call response error: ".concat(r))):(j(2),setTimeout((function(){j(0),d(!1)}),1e3),e(n))}))||(j(3),E.b.error("call missed to backend"),setTimeout((function(){j(0)}),2e3))}switch(f){case 1:t=Object(b.jsxs)(y.a,{variant:"outline-primary",children:[" ",Object(b.jsx)(S.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})]});break;case 2:t=Object(b.jsx)(y.a,{variant:"outline-success",children:" \u2714\ufe0f Succeed! "});break;case 3:t=Object(b.jsx)(y.a,{variant:"outline-danger",children:" \u274c Error "});break;default:t=Object(b.jsx)(y.a,{variant:"outline-primary",onClick:x,children:"Proceed!"})}return Object(b.jsxs)(b.Fragment,{children:[a?Object(b.jsx)(g.a,{style:{padding:".44em .45em"},pill:!0,bg:"danger",onClick:function(){return r.callHangup(O)},children:Object(b.jsx)("i",{className:"bi bi-x"})}):Object(b.jsx)(g.a,{style:{padding:".44em .45em"},pill:!0,bg:"danger",onClick:function(){return d(n)},className:"cursor-pointer",children:Object(b.jsx)("i",{className:"bi bi-cast"})}),Object(b.jsxs)(C.a,{show:l,setShow:d,buttons:[t],closeButton:!0,title:"Ready to forward?",onKeyDown:function(e){13===e.keyCode&&x()},children:["Enter the destination ID you want to forward to",Object(b.jsx)(I.a,{controlId:"floatingInput",label:"targetId",className:"mb-3",children:Object(b.jsx)(N.a.Control,{ref:c,name:"targetId",type:"text",placeholder:"mediahub target id"})})]})]})},_=function(e){Object.assign({},e),Object(i.g)();var t,n=Object(i.h)().roomId,a=Object(o.useRef)(),c=Object(o.useContext)(s.a),u=Object(o.useContext)(l.a),m=Object(o.useContext)(k.a),f=Object(o.useContext)(w.a),j=Object(o.useState)(0),h=Object(p.a)(j,2),C=(h[0],h[1],Object(o.useState)(null)),y=Object(p.a)(C,2),S=y[0],I=y[1];return Object(o.useEffect)((function(){if(u.imInRoom(n)&&u.ready&&m.ready)return f.callAllUsers(),function(){f.callHangupAll()}}),[u.current,u.ready&m.ready]),Object(o.useEffect)((function(){f.replaceStream(m.localStream)}),[m.localStream]),Object(b.jsxs)("div",{id:"room",style:{zIndex:1e3},className:"jsx-3387322708 overflow-hidden m-auto",children:[Object(b.jsxs)(v.a,{id:"content-row",className:"g-0",style:{height:"100%"},children:[Object(b.jsx)(O.a,{xs:"auto",id:"carousel-col",ref:a,children:Object(b.jsx)("div",{id:"carousel",className:"jsx-3387322708 d-flex flex-column",children:Object.entries(Object(d.a)({local:m.localStream},f.streams)).map((function(e,t){var n,a,r=Object(p.a)(e,2),o=r[0],i=r[1],s=f.getUserId(o),l=(c.user.username===(null===(n=u.current)||void 0===n?void 0:n.master)&&s!==(null===(a=u.current)||void 0===a?void 0:a.master)&&c.user.username,f.getLiveCall(o)),d=Object(p.a)(l,2),m=(d[0],!!d[1]),j=S===o||!S&&0===t;return Object(b.jsxs)("div",{className:"jsx-3387322708",children:[Object(b.jsxs)("div",{className:"jsx-3387322708 stream-forward",children:[Object(b.jsx)(R,{callId:o,isForwardCall:m}),j&&Object(b.jsx)(g.a,{pill:!0,bg:"primary",children:Object(b.jsx)("i",{className:"jsx-3387322708 bi bi-eye active"})})]}),Object(b.jsx)(x.a,{isLocal:s===c.user.username,id:s,stream:i,className:j?"":"cursor-pointer",onClick:function(){I(o)}},o)]})}))})}),Object(b.jsx)(O.a,{id:"main-col",children:Object(b.jsx)(x.a,{isLocal:f.getUserId(S)===c.user.username,className:"main-video",id:f.getUserId(S),stream:null!==(t=f.streams[S])&&void 0!==t?t:m.localStream})})]}),Object(b.jsx)(r.a,{id:"3387322708",children:["#room{height:calc(100vh - 3rem - 4.5rem);}","#room #main-col{height:100%;overflow:hidden;}","#room #main-col .Video{width:100%;height:100%;object-fit:cover;}","#room #carousel-col{height:100%;width:166px;overflow-x:hidden;overflow-y:scroll;}","#room #carousel-col #carousel{height:100%;}","#room #carousel-col #carousel .Video{padding-right:1px;padding-bottom:2px;}","#room .stream-forward{height:1.9rem;position:relative;margin-bottom:-1.9rem;text-align:left;padding:3px 6px;z-index:1000;}","#room .stream-controls{margin-bottom:5.5rem;}","@media only screen and (orientation:landscape) and (max-height:671px){#room{height:calc(100vh - 2rem);}.stream-controls{margin-bottom:.5rem !important;}}","@media only screen and (orientation:portrait){.stream-controls{margin-bottom:5.5rem !important;}#content-row{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}#carousel-col{overflow-x:scroll;overflow-y:hidden;height:126px !important;width:100% !important;}#carousel-col #carousel{-webkit-flex-direction:row !important;-ms-flex-direction:row !important;flex-direction:row !important;border:none;}#carousel-col #carousel .Video,#carousel-col #carousel .Video video{width:166px;height:124px;object-fit:cover;}}"]})]})},A=n(14),T=n.n(A),P=n(6),D=n(19),L=n(488),F=n(463),U=n(461),V=n(25),z=n(50),G=function(){var e,t=Object(o.useRef)(null),n=Object(o.useState)(!1),a=Object(p.a)(n,2),r=a[0],c=a[1],i=Object(o.useContext)(s.a),l=Object(o.useState)({formErrors:{}}),u=Object(p.a)(l,2),m=u[0],f=u[1],j=Object(o.useState)(void 0),h=Object(p.a)(j,2),v=h[0],O=h[1];function g(e){return x.apply(this,arguments)}function x(){return(x=Object(D.a)(T.a.mark((function e(t){var n,a;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=m.email.toLowerCase(),a=E.b.loading("Resetting password..."),e.next=6,z.a.post("".concat("https://admire-dev-auth.brainstorm3d.com","/forgot-password"),{data:{email:n}}).then((function(e){var t=e.error,n=e.message;e.status;if(t)return E.b.error("onSubmitRecovery: ".concat(n),{id:a});c(!1),E.b.success("Success",{id:a})})).catch((function(e){E.b.error("onSubmitRecovery: ".concat(e),{id:a})}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(o.useEffect)((function(){!function(){var e=!0;for(var t in m)-1!==t.indexOf("_check")&&(e&=m[t]);O(!!e)}()}),[m]),Object(o.useEffect)((function(){O(!1)}),[]);var w=Object(b.jsx)(F.a,{placement:"bottom",overlay:Object(b.jsx)(U.a,{className:"".concat(v?"d-none":""),id:"tooltip-bottom",children:"Enter your email address first."}),children:Object(b.jsx)("span",{style:{padding:"10px 0"},children:Object(b.jsx)(y.a,{type:"submit",onClick:g,disabled:!v&&i.isConnected,children:" Send password reset email "})})});return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(y.a,{size:"sm",className:"mt-4",variant:"link",onClick:function(){return c(1)},children:[Object(b.jsx)("i",{className:"bi bi-lock"}),"Forgot password?"]}),Object(b.jsxs)(C.a,(e={buttons:[w],closeButton:!0,size:"lg",show:r,setShow:c,title:Object(b.jsx)("h2",{className:"user-select-none",children:"Forgot Password"})},Object(P.a)(e,"size","md"),Object(P.a)(e,"children",[Object(b.jsx)(V.a,{className:"user-select-none",children:"Enter your email adress, on a couple of minutes you will receive an email with a link to reset your password."}),Object(b.jsx)(N.a,{validated:v,onSubmit:g,ref:t,children:Object(b.jsx)(I.a,{controlId:"floatingInput",label:"Email address",className:"mb-3",children:Object(b.jsx)(N.a.Control,{required:!0,name:"email",type:"email",placeholder:" ",onChange:function(e){!function(e,t){var n=!1,a=m.formErrors;switch(e){case"email":n=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t),a[e]=n?"":" is invalid";break;case"password":n=t.length>=6,a[e]=n?"":" is too short";break;default:console.warn("Invalid field name: ",e)}f((function(r){var o;return Object(d.a)(Object(d.a)({},r),{},(o={},Object(P.a)(o,e,t),Object(P.a)(o,"".concat(e,"_check"),n),Object(P.a)(o,"formErrors",a),o))}))}(e.target.name,e.target.value)}})})})]),e))]})},B=n(462),M=n(201),W=n.n(M),J=function(){var e,t,n=Object(o.useRef)(null),a=Object(o.useState)(!1),c=Object(p.a)(a,2),i=c[0],l=c[1],u=Object(o.useContext)(s.a),m=Object(o.useState)(!1),f=Object(p.a)(m,2),j=(f[0],f[1]),h=Object(o.useState)(void 0),v=Object(p.a)(h,2),O=v[0],g=v[1],x=Object(o.useState)({formErrors:{}}),w=Object(p.a)(x,2),k=w[0],S=w[1];function R(e){var t=e.target.name,n=e.target.type;!function(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"any",r=!1,o=k.formErrors,c=Object(d.a)({},k);function i(e,t){return new Promise((function(n,a){var r,o=t||5e3,c=new Image;c.onerror=c.onabort=function(){clearTimeout(r),a("Error: the url provided is not an image")},c.onload=function(){clearTimeout(r),n("success")},r=setTimeout((function(){c.src="//!!!!/test.jpg",a("timeout")}),o),c.src=e}))}switch(a){case"email":if(r=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t),o[e]=r?"":" is invalid",r&&!k.gravatar){var s="https:"+W.a.url(t,{s:"256",r:"pg",d:"404"});i(s,2e3).then((function(e){var t;S(Object(d.a)(Object(d.a)({},c),{},(t={gravatar:s},Object(P.a)(t,"gravatar_check",r),Object(P.a)(t,"formErrors",o),t)))})).catch((function(e){var t;S(Object(d.a)(Object(d.a)({},c),{},(t={gravatar:null},Object(P.a)(t,"gravatar_check",r),Object(P.a)(t,"formErrors",o),t)))}))}break;case"password":r=t.length>=6,o[e]=r?"":" is too short";break;default:r=!0,o[e]=""}S(Object(d.a)(Object(d.a)({},c),{},(n={},Object(P.a)(n,e,t),Object(P.a)(n,"".concat(e,"_check"),r),Object(P.a)(n,"formErrors",o),n)))}(t,"checkbox"===n?e.target.checked:e.target.value,n)}function _(e){return A.apply(this,arguments)}function A(){return(A=Object(D.a)(T.a.mark((function e(t){var n,a,r,o,c,i,s,d,u;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=k.username,a=k.email,r=k.password,o=k.avatar,c=k.name,i=k.surname,s=k.birthdate,d=k.role,u=E.b.loading("Registering..."),e.next=5,z.a.post("".concat("https://admire-dev-auth.brainstorm3d.com","/register"),{data:{username:n,email:a,password:r,avatar:o,name:c,surname:i,birthdate:s,role:d}}).then((function(e){var t=e.error,n=e.message;e.status;if(t)return E.b.error("onRegister: ".concat(n),{id:u});E.b.success("Success",{id:u}),setTimeout((function(){j(0),l(!1)}),1e3)})).catch((function(e){E.b.error("Error: ".concat(e),{id:u})}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(o.useEffect)((function(){!function(){var e=!0;for(var t in k)-1!==t.indexOf("_check")&&(e&=k[t]);g(!!e)}()}),[k]),Object(o.useEffect)((function(){g(!1)}),[]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(L.a.Footer,{className:"text-center user-select-none",onClick:function(){return l(1)},children:" Create an account "}),Object(b.jsx)(N.a,{validated:O,onSubmit:_,ref:n,children:Object(b.jsxs)(C.a,{className:"py-4",closeButton:!0,show:i,setShow:l,title:Object(b.jsx)("h2",{className:"jsx-198025962 user-select-none",children:"Let's create your account"}),buttons:[Object(b.jsx)(F.a,{placement:"bottom",overlay:Object(b.jsx)(U.a,{className:"".concat(O?"d-none":""),id:"tooltip-bottom",children:"Enter your email address first."}),children:Object(b.jsx)(y.a,{type:"submit",onClick:_,disabled:!O&&u.isConnected,children:"CREATE ACCOUNT"})})],children:[Object(b.jsx)(B.a,{id:"avatar-img",src:null!==(e=null!==(t=k.avatar)&&void 0!==t?t:k.gravatar)&&void 0!==e?e:"https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Fforums.opera.com%2Fassets%2Fuploads%2Fprofile%2F192104-profileavatar.png&f=1&nofb=1",roundedCircle:!0,className:"position-absolute top-0 start-50 bg-danger shadow",width:"128",height:"128"}),Object(b.jsx)(V.a,{className:"user-select-none",children:"Create your account. It's free and only takes a minute."}),Object(b.jsx)(N.a.Group,{className:"mb-1",children:Object(b.jsxs)(I.a,{label:"username",children:["     ",Object(b.jsx)(N.a.Control,{name:"username",placeholder:"username",onChange:R,type:"text",defaultValue:k.username}),"      "]})}),Object(b.jsx)(N.a.Group,{className:"mb-1",children:Object(b.jsxs)(I.a,{label:"email",children:["        ",Object(b.jsx)(N.a.Control,{name:"email",placeholder:"email",onChange:R,type:"email",defaultValue:k.email}),"      "]})}),Object(b.jsx)(N.a.Group,{className:"mb-1",children:Object(b.jsxs)(I.a,{label:"password",children:["     ",Object(b.jsx)(N.a.Control,{name:"password",placeholder:"password",onChange:R,type:"password",defaultValue:k.password}),"      "]})}),Object(b.jsx)(N.a.Group,{className:"mb-1",children:Object(b.jsxs)(I.a,{label:"avatar URL",children:["   ",Object(b.jsx)(N.a.Control,{name:"avatar",placeholder:"avatar URL",onChange:R,type:"avatar",defaultValue:k["avatar URL"]}),"      "]})}),Object(b.jsx)(N.a.Group,{className:"mb-1",children:Object(b.jsxs)(I.a,{label:"name",children:["         ",Object(b.jsx)(N.a.Control,{name:"name",placeholder:"name",onChange:R,type:"text",defaultValue:k.name}),"      "]})}),Object(b.jsx)(N.a.Group,{className:"mb-1",children:Object(b.jsxs)(I.a,{label:"surname",children:["      ",Object(b.jsx)(N.a.Control,{name:"surname",placeholder:"surname",onChange:R,type:"text",defaultValue:k.surname}),"      "]})}),Object(b.jsx)(N.a.Group,{className:"mb-1",children:Object(b.jsxs)(I.a,{label:"birthddate",children:["   ",Object(b.jsx)(N.a.Control,{name:"birthdate",placeholder:"birthdate",onChange:R,type:"date",defaultValue:k.birthdate}),"      "]})}),Object(b.jsxs)("div",{className:"jsx-198025962 form-floating",children:[Object(b.jsxs)("select",{id:"floatingSelect","aria-label":"Floating label select example",className:"jsx-198025962 form-select",children:[Object(b.jsx)("option",{value:"0",className:"jsx-198025962",children:"User"}),Object(b.jsx)("option",{value:"1",className:"jsx-198025962",children:"Admin"})]}),Object(b.jsx)("label",{htmlFor:"floatingSelect",className:"jsx-198025962",children:" User role"})]})]})}),Object(b.jsx)(r.a,{id:"198025962",children:["#avatar-img{-webkit-transform:translate(-50%,-125%) !important;-ms-transform:translate(-50%,-125%) !important;transform:translate(-50%,-125%) !important;}"]})]})},H=n(125),q=n(51),Z=function(){var e,t,n,a=Object(o.useContext)(s.a),c=Object(o.useRef)(null),i=Object(o.useState)(void 0),l=Object(p.a)(i,2),u=l[0],m=l[1],f=Object(o.useState)({formErrors:{},email:q.a.get("admire_app_email"),remember:!!q.a.get("admire_app_email")}),j=Object(p.a)(f,2),h=j[0],v=j[1],g=Object(o.useState)(!1),x=Object(p.a)(g,2),w=x[0],k=x[1];function C(){return(C=Object(D.a)(T.a.mark((function e(t){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),k(!0),a.login(h.email,h.password).then((function(e){k(!1),h.remember&&(q.a.set("admire_app_token",e,"30"),q.a.set("admire_app_email",h.email,"30"))})).catch((function(e){k(!1)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){var t=e.target.name,n=e.target.type;!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"any",a=!1,r=h.formErrors;switch(n){case"email":a=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t),r[e]=a?"":" is invalid";break;case"password":a=t.length>=6,r[e]=a?"":" is too short";break;default:a=!0,r[e]=""}v((function(n){var o;return Object(d.a)(Object(d.a)({},n),{},(o={},Object(P.a)(o,e,t),Object(P.a)(o,"".concat(e,"_check"),a),Object(P.a)(o,"formErrors",r),o))}))}(t,"checkbox"===n?e.target.checked:e.target.value,n)}return Object(o.useEffect)((function(){!function(){var e=!0;for(var t in h)-1!==t.indexOf("_check")&&(e&=h[t]);m(!!e)}()}),[h]),Object(o.useEffect)((function(){m(!1)}),[]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(L.a,{id:"login",bg:"light",className:"flex-column text-center position-absolute start-50 top-50 translate-middle",style:{width:"24rem"},children:[Object(b.jsxs)(O.a,{children:[Object(b.jsx)(L.a.Img,{variant:"top",className:"mt-4 user-select-none",src:H.a}),Object(b.jsx)("h1",{className:"jsx-1226047467 text-start ps-4 mb-0 mt-3 user-select-none",children:"admire"}),Object(b.jsx)("div",{className:"jsx-1226047467 divider",children:Object(b.jsx)("span",{className:"jsx-1226047467"})})]}),Object(b.jsxs)(O.a,{children:[Object(b.jsxs)(L.a.Body,{as:O.a,className:"text-start px-4 pb-4",children:[Object(b.jsx)(L.a.Text,{className:"user-select-none",children:"Enter your e-mail adress and your password."}),Object(b.jsxs)(N.a,{validated:u,onSubmit:function(e){return C.apply(this,arguments)},ref:c,children:[Object(b.jsx)(I.a,{controlId:"floatingInput",label:"Email address",className:"mb-3",children:Object(b.jsx)(N.a.Control,{required:!0,name:"email",type:"email",placeholder:" ",onChange:E,defaultValue:null!==(e=h.email)&&void 0!==e?e:" "})}),Object(b.jsx)(I.a,{controlId:"floatingPassword",label:"Password",children:Object(b.jsx)(N.a.Control,{required:!0,name:"password",type:"password",placeholder:" ",onChange:E,defaultValue:null!==(t=h.password)&&void 0!==t?t:""})}),Object(b.jsx)(N.a.Switch,{id:"remember-switch",label:"Remember me",className:"user-select-none",name:"remember",onChange:E,defaultChecked:null!==(n=h.remember)&&void 0!==n&&n}),Object(b.jsx)(F.a,{placement:"bottom",overlay:Object(b.jsx)(U.a,{className:"".concat(u?"d-none":""," mt-2"),id:"tooltip-bottom",children:"Check form errors"}),children:Object(b.jsx)("span",{style:{padding:"10px 0"},className:"jsx-1226047467",children:Object(b.jsx)(y.a,{size:"sm",className:"mt-4",type:"submit",disabled:!(u&&!w),children:w?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(S.a,{as:"span",animation:"grow",size:"sm",role:"status","aria-hidden":"true"})," Logging in... "]}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("i",{className:"jsx-1226047467 bi bi-box-arrow-in-left"})," Log me in "]})})})}),Object(b.jsx)(G,{})]})]}),Object(b.jsx)(J,{})]})]}),Object(b.jsx)(r.a,{id:"1226047467",children:[".divider{border-bottom:1px solid #FFF;background-color:#DADADA;height:2px;margin:0.5em 0px 1.5em;}",".divider span{position:relative;display:block;width:75px;height:3px;background-color:#057bbb;-webkit-transform:translatey(-25%);-ms-transform:translatey(-25%);transform:translatey(-25%);left:6%;}","#login{border:none;}","#login img{width:192px;-webkit-filter:hue-rotate(260deg);filter:hue-rotate(260deg);}","#login .card-footer{color:#D1D3D5;background:#057bbb;-webkit-transition:all 0.1s ease-in-out;transition:all 0.1s ease-in-out;}","#login .card-footer:hover{background:#045a89;font-weight:bold;cursor:pointer;}","@media only screen and (orientation:landscape) and (max-height:671px){#login{width:40rem !important;-webkit-flex-direction:row !important;-ms-flex-direction:row !important;flex-direction:row !important;}#login .col{-webkit-align-self:end;-ms-flex-item-align:end;align-self:end;}}"]})]})},K=n(16),$=function(){var e=Object(o.useContext)(l.a),t=Object(o.useRef)(null),n=Object(o.useState)(!1),a=Object(p.a)(n,2),c=a[0],i=a[1],s=Object(o.useState)(!0),d=Object(p.a)(s,2),u=d[0],m=(d[1],Object(o.useState)(0)),f=Object(p.a)(m,2),j=f[0],v=f[1];function O(){if(null!==t&&void 0!==t&&t.current&&c){var n=Array.from(t.current.elements).map((function(e){return e.value})),a=Object(p.a)(n,4),r=a[0],o=a[1],s=a[2],l=a[3];e.createRoom(r.toLowerCase(),{password:o,icon:s,hidden:l}).then((function(e){E.b.success("Created room ".concat(e.name)),setTimeout((function(){v(0),i(!1)}),1e3),v(2)})).catch((function(e){E.b.error("onCreateRoom: ".concat(e)),v(3),setTimeout((function(){v(0)}),1e3)}))}}Object(o.useEffect)((function(){function e(e){13===e.keyCode&&i(!0)}return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}),[]);var g=Object(b.jsx)(y.a,{disabled:!u,variant:u?"outline-primary":"outline-secondary",onClick:O,children:"Proceed!"});switch(j){case 1:g=Object(b.jsxs)(y.a,{variant:"outline-primary",children:[" ",Object(b.jsx)(S.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})]});break;case 2:g=Object(b.jsx)(y.a,{variant:"outline-success",children:" \u2714\ufe0f Succeed! "});break;case 3:g=Object(b.jsx)(y.a,{variant:"outline-danger",children:" \u274c Error "})}return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(h.Button,{onClick:function(){return i(1)},label:"Create room",appendclass:"shadow rounded-circle bg-danger",children:Object(b.jsx)("i",{className:"jsx-1510850880 bi bi-plus-lg"})}),Object(b.jsxs)(C.a,{size:"sm",onKeyDown:function(e){return 13===e.keyCode&&O()},tabIndex:"0",buttons:[g],closeButton:!0,show:c,setShow:i,title:Object(b.jsx)("span",{className:"jsx-1510850880",children:"Let's create a room"}),children:[Object(b.jsx)(V.a,{children:""}),Object(b.jsxs)(N.a,{ref:t,children:[Object(b.jsx)(I.a,{controlId:"floatingInput",label:"roomId",className:"mb-3",children:Object(b.jsx)(N.a.Control,{onChange:function(e){},required:!0,name:"roomId",type:"text",placeholder:"roomId"})}),Object(b.jsx)(I.a,{controlId:"floatingInput",label:"password",className:"mb-3",children:Object(b.jsx)(N.a.Control,{required:!0,name:"password",type:"password",placeholder:"password"})}),Object(b.jsx)(I.a,{controlId:"floatingInput",label:"icon",className:"mb-3",children:Object(b.jsx)(N.a.Control,{required:!0,name:"icon",type:"text",placeholder:"icon URL"})}),Object(b.jsx)(N.a.Switch,{id:"hidden-switch",label:"Hidden",name:"hidden",defaultValue:!1})]})]}),Object(b.jsx)(r.a,{id:"1510850880",children:["#new-room-card{cursor:pointer;opacity:.5;border:2px dashed white;}","#new-room-card .card-img-top{display:none;}","#new-room-card .card-body{height:155px;}"]})]})},Y=["id","name"];function X(e){e.id;var t=e.name,n=Object(u.a)(e,Y);return Object(b.jsxs)("div",{className:"jsx-1285018445",children:[Object(b.jsxs)(L.a,Object(d.a)(Object(d.a)({className:"bg-dark text-light"},n),{},{children:[Object(b.jsx)(L.a.Img,{variant:"top",src:"https://unsplash.it/seed/tesst-".concat(t,"/160/100")}),Object(b.jsx)(L.a.Body,{children:Object(b.jsxs)(L.a.Title,{children:["#",t]})})]})),Object(b.jsx)(r.a,{id:"1285018445",children:[".card{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-transition:all 0.075s ease-in-out;transition:all 0.075s ease-in-out;}",".card:hover{box-shadow:0 0 0px 2px rgba(255,255,255,0.5) !important;}",".card:hover .card-body{background:#6d7a86;}",".card .card-body{-webkit-transition:all 0.075s ease-in-out;transition:all 0.075s ease-in-out;}",".card .card-body .card-title{margin:0;font-size:1rem;white-space:nowrap;}"]})]})}function Q(){}var ee=function(){Object(i.g)();var e=Object(o.useContext)(l.a);return Object(o.useEffect)((function(){}),[e.list]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(v.a,{onKeyPress:Q,id:"lobby",className:"h-100 m-auto",children:Object(b.jsxs)(O.a,{xs:12,sm:{span:10,offset:1},children:[Object(b.jsx)("h1",{className:"jsx-3939213960 text-light",children:"Lobby"}),Object(b.jsx)(v.a,{xs:2,sm:4,lg:4,xl:5,className:"g-4",children:Object(K.a)(Object.values(e.list)).map((function(t,n){return Object(b.jsx)(O.a,{children:Object(b.jsx)(X,{name:" ".concat((null===t||void 0===t?void 0:t.name)||"Room "+n),onClick:function(){return e.joinRoom(null===t||void 0===t?void 0:t.name)}})},n)}))})]})}),Object(b.jsx)(r.a,{id:"3939213960",children:["#lobby{min-height:19rem;}"]})]})},te=n(34),ne=n(217),ae=(n(295),["show","setShow"]),re=function(e){e.show,e.setShow,Object(u.a)(e,ae);var t=["Devices","p1","p2","p3"],a=Object(o.useState)(0),c=Object(p.a)(a,2),i=c[0],s=c[1],l=Object(o.useState)(null),d=Object(p.a)(l,2),m=d[0],f=d[1],j=Object(o.useState)([]),h=Object(p.a)(j,2),v=h[0],O=h[1];function g(e){switch(null===e||void 0===e?void 0:e.keyCode){case 37:return s((function(e){return e-1<0?t.length-1:e-1}));case 39:return s((function(e){return(e+1)%t.length}))}}return Object(o.useEffect)((function(){Object(D.a)(T.a.mark((function e(){var a,r,o,c;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],r=Object(te.a)(t),e.prev=2,r.s();case 4:if((o=r.n()).done){e.next=10;break}return c=o.value,e.next=8,n(456)("./".concat(c,".jsx")).then((function(e){return a.push(Object(b.jsx)(e.default,{}))}));case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:O([].concat(a)),f(a[i]);case 20:case"end":return e.stop()}}),e,null,[[2,12,15,18]])})))()}),[]),Object(o.useEffect)((function(){f(v[i])}),[i]),Object(o.useEffect)((function(){return document.addEventListener("keydown",g),function(){document.removeEventListener("keydown",g)}}),[]),Object(b.jsxs)("div",{className:"jsx-1554317544",children:[Object(b.jsx)(ne.a,{onSwipeLeft:function(){return s((function(e){return(e+1)%t.length}))},onSwipeRight:function(){return s((function(e){return e-1<0?t.length-1:e-1}))},children:Object(b.jsxs)("div",{className:"jsx-1554317544",children:[Object(b.jsx)("ul",{className:"jsx-1554317544 nav nav-tabs justify-content-start mb-2",children:t.map((function(e,t){return Object(b.jsx)("li",{className:"jsx-1554317544 nav-item",children:Object(b.jsx)("div",{onClick:function(){return s(t)},className:"jsx-1554317544 "+"nav-link ".concat(i===t?"active":""),children:e})},t)}))}),m]})}),Object(b.jsx)(r.a,{id:"1554317544",children:["#wizard .nav-tabs{width:calc(100% + 24px);margin-left:-12px;margin-top:-3.6rem;}","#wizard .modal-content{margin-top:1.5rem;min-height:calc(100vh - 10rem);}"]})]})},oe=function(){var e=Object(o.useContext)(l.a),t=Object(o.useState)(!1),n=Object(p.a)(t,2),a=n[0],r=n[1];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(h.Item,{onClick:function(){return r(1)},label:"Leave room",children:[Object(b.jsx)("i",{className:"bi bi-telephone-x"}),"Leave"]}),Object(b.jsx)(C.a,{buttons:[Object(b.jsx)(y.a,{size:"lg",onClick:function(){return e.leaveRoom()},children:"Yes, leave"})],closeButton:!0,size:"md",show:a,setShow:r,title:Object(b.jsx)("span",{children:"Hey! Are you sure?"}),children:Object(b.jsx)(V.a,{children:"\n            Are you sure you want to leave this room? Any call in progress will be lost and any active stream will be stopped.\n            "})})]})},ce=function(){var e=Object(o.useContext)(l.a),t=Object(o.useRef)(null),n=Object(o.useState)(!1),a=Object(p.a)(n,2),r=a[0],c=a[1],i=Object(o.useState)(!1),s=Object(p.a)(i,2),d=s[0],u=(s[1],Object(o.useState)(0)),m=Object(p.a)(u,2),f=m[0],j=m[1];function v(){null!==t&&void 0!==t&&t.current&&r&&e.createRoom(t.current.value.toLowerCase()).then((function(){setTimeout((function(){j(0),c(!1)}),1e3),j(2)})).catch((function(){j(3)}))}var O=Object(b.jsx)(y.a,{disabled:!d,variant:d?"outline-primary":"outline-secondary",onClick:v,children:"Proceed!"});switch(f){case 1:O=Object(b.jsxs)(y.a,{variant:"outline-primary",children:[" ",Object(b.jsx)(S.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})]});break;case 2:O=Object(b.jsx)(y.a,{variant:"outline-success",children:" \u2714\ufe0f Succeed! "});break;case 3:O=Object(b.jsx)(y.a,{variant:"outline-danger",children:" \u274c Error "})}return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(h.Item,{onClick:function(){return c((function(e){return!e}))},children:[Object(b.jsx)("i",{className:"bi bi-magic"}),"Settings"]}),Object(b.jsx)(C.a,{id:"wizard",onKeyDown:function(e){13===e.keyCode&&v()},tabIndex:"0",buttons:[O],closeButton:!0,size:"md",show:r,setShow:c,_title:Object(b.jsx)("span",{children:"Settings: Wizard"}),children:Object(b.jsx)(re,{})})]})},ie=function(){var e,t,n=Object(o.useContext)(l.a),a=Object(o.useState)(!1),r=Object(p.a)(a,2),c=r[0],i=r[1];return Object(o.useEffect)((function(){}),[n.current]),console.log("render-users"),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(h.Item,{onClick:function(){return i((function(e){return!e}))},disabled:!n.current,children:[Object(b.jsx)("i",{className:"bi bi-people"}),"Users"]}),Object(b.jsx)(C.a,{tabIndex:"0",closeButton:!0,size:"md",show:c,setShow:i,title:Object(b.jsxs)("span",{children:[Object(b.jsx)("i",{className:"bi bi-people"})," Users"]}),children:Object(b.jsx)("ul",{children:null===(e=n.current)||void 0===e||null===(t=e.users)||void 0===t?void 0:t.map((function(e,t,n){return e&&Object(b.jsx)("li",{children:null===e||void 0===e?void 0:e.username},t)}))})})]})},se=function(){var e,t,n=Object(o.useContext)(l.a),a=Object(o.useState)(!1),r=Object(p.a)(a,2),c=r[0],i=r[1];return Object(o.useEffect)((function(){}),[n.current]),console.log("render-chat"),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(h.Item,{onClick:function(){return i((function(e){return!e}))},disabled:!n.current,children:[Object(b.jsx)("i",{className:"bi bi-chat-dots"}),"Chat"]}),Object(b.jsx)(C.a,{tabIndex:"0",closeButton:!0,size:"md",show:c,setShow:i,title:Object(b.jsxs)("span",{children:[Object(b.jsx)("i",{className:"bi bi-chat-dots"})," Chat"]}),children:Object(b.jsx)("ul",{children:null===(e=n.current)||void 0===e||null===(t=e.users)||void 0===t?void 0:t.map((function(e,t,n){return e&&Object(b.jsx)("li",{children:null===e||void 0===e?void 0:e.username},t)}))})})]})},le=function(){var e,t=Object(o.useRef)(null),n=Object(o.useContext)(k.a),a=Object(o.useState)(!1),c=Object(p.a)(a,2),i=c[0],s=c[1];return Object(o.useEffect)((function(){var e,t=null!==(e=n.localStream.getAudioTracks())&&void 0!==e?e:[];s(t.every((function(e){return e.enabled})))}),[n.localStream,null===(e=n.settings)||void 0===e?void 0:e.audio]),Object(o.useEffect)((function(){var e,n=null===t||void 0===t||null===(e=t.current)||void 0===e?void 0:e.getContext("2d");n.globalAlpha=.5;var a=requestAnimationFrame((function e(){n.clearRect(0,0,n.canvas.width,n.canvas.height);var t=.5*n.canvas.width,a=.5*n.canvas.height,r=.5*n.canvas.width,o=.5*n.canvas.height,c=.5*n.canvas.height,i=n.createRadialGradient(t,a,135,r,o,c);i.addColorStop(0,"rgba(255, 255, 255, 0.0)"),i.addColorStop(.1,"rgba(255, 255, 255, 0.5)"),i.addColorStop(.5,"rgba(255, 255, 255, 0.1)"),i.addColorStop(1,"rgba(255, 255, 255, 0.0)"),n.fillStyle=i,n.fillRect(0,0,n.canvas.width,n.canvas.height),requestAnimationFrame(e)}));return function(){cancelAnimationFrame(a)}}),[]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{id:"pulse-wrapper",style:{marginTop:"-4rem",marginBottom:"-4rem"},className:"jsx-652394502 p-4 rounded-circle",children:[Object(b.jsx)("canvas",{width:"512",height:"512",ref:t,className:"jsx-652394502 position-absolute top-0 rounded-circle"}),Object(b.jsx)(h.Button,{onClick:function(){var e,t=(null!==(e=n.localStream.getAudioTracks())&&void 0!==e?e:[]).every((function(e){return e.enabled=!i,!!e.enabled}));s(t)},label:"Create room",appendclass:"shadow rounded-circle bg-danger",children:Object(b.jsx)("i",{className:"jsx-652394502 "+((i?"bi bi-mic":"bi bi-mic-mute")||"")})})]}),Object(b.jsx)(r.a,{id:"652394502",children:["#pulse-wrapper{margin:-3rem -1.5rem 0rem -1.5rem !important;overflow:hidden !important;}","#pulse-wrapper .nav-button{margin-top:0;margin-bottom:0;}","#pulse-wrapper canvas{pointer-events:none;margin-top:.35rem;width:5rem;height:5rem;-webkit-transform:translate(-50%,-50%) scale(1.3) !important;-ms-transform:translate(-50%,-50%) scale(1.3) !important;transform:translate(-50%,-50%) scale(1.3) !important;}","@media only screen and (orientation:landscape) and (max-height:671px){#pulse-wrapper{margin:-1.5rem 1rem -1.5rem -4rem !important;}#pulse-wrapper .nav-button{margin-left:0;margin-right:0;}#pulse-wrapper canvas{top:50% !important;margin-top:0rem;}}"]})]})};t.a=function(e){Object.assign({},e);var t,n,a=Object(i.g)(),d=Object(o.useContext)(s.a),u=Object(o.useContext)(l.a),m=Object(o.useRef)().current;return/^\/room\/[a-zA-Z0-9]+/.test(a.location.pathname)&&(m=Object(b.jsx)(_,{container:!0})),"/"===a.location.pathname&&(m=Object(b.jsx)(ee,{container:!0})),"/settings"===a.location.pathname&&(m=Object(b.jsx)(re,{show:!0,container:!0})),/^\/room\/[a-zA-Z0-9]+\/chat$/.test(a.location.pathname)&&(m=Object(b.jsx)(i.a,{to:"/"})),/^\/room\/[a-zA-Z0-9]+\/users$/.test(a.location.pathname)&&(m=Object(b.jsx)(i.a,{to:"/"})),d.isLogged&&d.isConnected?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"jsx-147180269 App",children:[Object(b.jsx)(c.a,{fluid:null===(t=m)||void 0===t||null===(n=t.props)||void 0===n?void 0:n.container,id:"content-wrapper",children:m}),Object(b.jsxs)(h,{children:[u.current?Object(b.jsx)(oe,{}):Object(b.jsxs)(h.Item,{children:[Object(b.jsx)("i",{className:"jsx-147180269 bi bi-house"}),"Lobby"]}),Object(b.jsx)(ce,{}),u.current?Object(b.jsx)(le,{}):Object(b.jsx)($,{}),Object(b.jsx)(ie,{}),Object(b.jsx)(se,{})]})]}),Object(b.jsx)(r.a,{id:"147180269",children:["html,body,.App{overflow:hidden;min-height:330px;}","#content-wrapper{height:100%;margin-bottom:6rem;margin-top:3.5rem;overflow-y:scroll;overflow-x:hidden;}","#content-wrapper .container-fluid{margin:0 !important;}","@media only screen and (orientation:landscape) and (max-height:671px){#content-wrapper{margin-bottom:1rem;margin-top:1rem;margin-right:3rem;}}"]})]}):Object(b.jsx)("div",{className:"App",children:Object(b.jsx)(Z,{})})}},22:function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(34),r=n(6),o=n(2),c=n(5),i=n(8),s=n(7),l=n(12),d=n(18),u=n(1),b=n(27),m=n(0),f=["children"],j=Object(u.createContext)();t.b=function(e){var t=e.children,n=(Object(i.a)(e,f),Object(u.useContext)(b.a)),h=Object(d.g)(),p=Object(u.useState)({}),v=Object(c.a)(p,2),O=v[0],g=v[1],x=Object(u.useState)(!1),w=Object(c.a)(x,2),k=w[0],C=w[1],y=Object(u.useState)(null),S=Object(c.a)(y,2),I=S[0],N=S[1];function E(e,t){var n,c,i=Object(o.a)(Object(o.a)({},O),{},Object(r.a)({},null===I||void 0===I?void 0:I.name,I))[t],s=Object(a.a)(null!==(n=null===i||void 0===i?void 0:i.users)&&void 0!==n?n:[]);try{for(s.s();!(c=s.n()).done;){var l=c.value;if((null===l||void 0===l?void 0:l.username)===e)return!0}}catch(d){s.e(d)}finally{s.f()}return!1}function R(e){var t=e.data.room;g(Object(o.a)(Object(o.a)({},O),{},Object(r.a)({},t.name,t)))}function _(e){var t=e.data.room;delete O[t.name],g(Object(o.a)({},O)),s.c.getRoom(P)}function A(e){var t,n=e.data,a=n.user;n.room;s.c.getRoom(P),Object(l.b)("User '".concat(a.username,"' left")),I&&N(Object(o.a)(Object(o.a)({},I),{},{users:null!==(t=null===I||void 0===I?void 0:I.users)&&void 0!==t?t:[].filter((function(e){return e.username!==a.username}))}))}function T(e){var t,n=e.data,a=n.user;n.room;s.c.getRoom(P),Object(l.b)("User '".concat(a.username,"' joined")),I&&N(Object(o.a)(Object(o.a)({},I),{},{users:null!==(t=null===I||void 0===I?void 0:I.users)&&void 0!==t?t:[].push(a)}))}function P(e){var t=e.data.room;N(null!==t&&void 0!==t&&t.name?Object(o.a)({},t):null),null!==t&&void 0!==t&&t.name?h.push("/room/".concat(null===t||void 0===t?void 0:t.name)):h.push("/")}Object(u.useEffect)((function(){if(n.isLogged)return s.c.on(s.a.GuestLeftRoom,A),s.c.on(s.a.GuestJoinedRoom,T),s.c.on(s.a.RoomCreated,R),s.c.on(s.a.RoomDeleted,_),s.c.getRooms((function(e){!function(e){var t,n=e.data.rooms,r={},o=Object(a.a)(null!==n&&void 0!==n?n:[]);try{for(o.s();!(t=o.n()).done;){var c=t.value;r[c.name]=c}}catch(i){o.e(i)}finally{o.f()}g(r)}(e),s.c.getRoom((function(e){P(e),C(!0)}))})),function(){s.c.off(s.a.GuestLeftRoom,A),s.c.off(s.a.GuestJoinedRoom,T),s.c.off(s.a.RoomCreated,R),s.c.off(s.a.RoomDeleted,_)}}),[n.isLogged]);var D=window.rooms={joinRoom:function(e){return new Promise((function(t,n){s.c.joinRoom(e,"",(function(e){e.event;var a=e.data;a.error?n(a.message):t(a.room)}))})).then((function(e){return s.c.getRoom(P),e}))},leaveRoom:function(){return new Promise((function(e,t){s.c.leaveRoom((function(n){n.event;var a=n.data;a.error?t(a.message):e(a.room)}))})).then((function(e){return s.c.getRoom(P),e}))},createRoom:function(e,t){var n=t.password,a=t.hidden,r=t.icon;return new Promise((function(t,o){s.c.createRoom(e,null!==n&&void 0!==n?n:"",null!==a&&void 0!==a&&a,null!==r&&void 0!==r?r:"",(function(e){e.event;var n=e.data;n.error?o(n.message):t(n.room)}))})).then((function(e){return s.c.getRoom(P),e}))},setCurrent:N,imInRoom:function(e){var t;return E(null===(t=n.user)||void 0===t?void 0:t.username,e)},isUserInRoom:E,ready:k,current:I,list:O};return Object(m.jsx)(j.Provider,{value:D,children:t})}},25:function(e,t,n){"use strict";var a=n(2),r=n(8),o=n(216),c=n(214),i=n(199),s=n(213),l=n(0),d=["children"];t.a=function(e){var t=e.children,n=Object(r.a)(e,d);return Object(l.jsx)(s.a,Object(a.a)({children:t.replaceAll("  ",""),remarkPlugins:[c.a,i.a],rehypePlugins:[o.a]},n))}},27:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(14),r=n.n(a),o=n(19),c=n(2),i=n(5),s=n(8),l=n(50),d=n(7),u=n(51),b=n(12),m=n(1),f=n(0),j=["children"],h=Object(m.createContext)();t.b=function(e){var t=e.children,n=(Object(s.a)(e,j),Object(m.useState)(null)),a=Object(i.a)(n,2),p=a[0],v=a[1],O=Object(m.useState)(u.a.get("admire_app_token")),g=Object(i.a)(O,2),x=g[0],w=g[1],k=Object(m.useState)(!1),C=Object(i.a)(k,2),y=C[0],S=C[1],I=Object(m.useState)({app:!1,rtc:!1}),N=Object(i.a)(I,2),E=N[0],R=N[1],_=Object(m.useRef)(null).current,A=Object(m.useRef)(null).current,T=Object(m.useRef)(null).current,P=Object(m.useState)(0),D=Object(i.a)(P,2),L=D[0],F=D[1];function U(){return(U=Object(o.a)(r.a.mark((function e(t,n){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=b.b.loading("Logging in..."),t=t.toLowerCase(),e.abrupt("return",l.a.post("".concat("https://admire-dev-auth.brainstorm3d.com","/auth/basic"),{data:{email:t,password:n}}).then((function(e){if(null!==e&&void 0!==e&&e.access_token)return b.b.success("Success login",{id:a}),w(e.access_token),e.access_token;b.b.error("Error ".concat(e.error,": ").concat(e.message),{id:a}),setTimeout(V,2e3)})).catch((function(e){return b.b.error("Error catch: ".concat(e),{id:a})})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){return z.apply(this,arguments)}function z(){return(z=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u.a.set("admire_app_email",null,-1),u.a.set("admire_app_token",null,-1),w(null),S(!1),Object(b.b)("Logged out"),d.f.unregister(),d.f.disconnect(),d.c.disconnect(),F(0);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(){return(G=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){l.a.get("".concat("https://admire-dev-auth.brainstorm3d.com","/users/me"),{headers:{Authorization:"Bearer ".concat(x)}}).then((function(n){null!==n&&void 0!==n&&n.error?t(n):e(n)})).catch((function(e){return t(e)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(m.useEffect)((function(){function e(){d.f.unregister(),d.f.disconnect(),d.c.disconnect(),window.removeEventListener("unload",e)}var t,n,a,r;return window.addEventListener("unload",e),d.c.on(d.a.ClientConnected,t=function(){Object(b.b)("App Connected",{id:_,icon:"\u26a1",duration:2e3}),R((function(e){return Object(c.a)(Object(c.a)({},e),{},{app:!0})}))}),d.f.on(d.b.ClientConnected,a=function(){Object(b.b)("RTC Connected",{id:A,icon:"\u26a1",duration:2e3}),R((function(e){return Object(c.a)(Object(c.a)({},e),{},{rtc:!0})}))}),d.c.on(d.a.ClientDisconnected,n=function(){Object(b.b)("App Disconnected",{id:_,icon:"\u26a0\ufe0f",duration:2e3}),R((function(e){return Object(c.a)(Object(c.a)({},e),{},{app:!1})}))}),d.f.on(d.b.ClientDisconnected,r=function(){Object(b.b)("RTC Disconnected",{id:A,icon:"\u26a0\ufe0f",duration:2e3}),R((function(e){return Object(c.a)(Object(c.a)({},e),{},{rtc:!1})}))}),function(){d.c.off(d.a.ClientConnected,t),d.c.off(d.b.ClientConnected,n),d.f.off(d.a.ClientDisconnected,a),d.f.off(d.b.ClientDisconnected,r),e()}}),[]),Object(m.useEffect)((function(){!E.app&&x&&d.c.connect("wss://admire-dev-lobby.brainstorm3d.com",x)}),[E.app,x]),Object(m.useEffect)((function(){!E.rtc&&x&&d.f.connect("wss://admire-dev-rtc.brainstorm3d.com",x)}),[E.rtc,x]),Object(m.useEffect)((function(){E.rtc&&E.app&&x&&!y&&(T=b.b.loading("Fetching user info...",{duration:1/0}),function(){return G.apply(this,arguments)}().then((function(e){b.b.success("Success",{id:T,icon:"\u26a1",duration:2e3}),console.log(e),v(e),S(!0)})).catch((function(e){var t=e.error,n=e.message;b.b.error("onGetUserInfo(e:".concat(t,"): ").concat(n),{id:T,icon:"\u26a0\ufe0f",duration:4e3}),L>=3?V():Object(b.b)((function(e){var t=Object(m.useState)(.001*e.duration),n=Object(i.a)(t,2),a=n[0],r=n[1];return Object(m.useEffect)((function(){var e=setInterval((function(){return r((function(e){return Math.max(0,e-1)}))}),1e3);return function(){clearInterval(e),F((function(e){return e+1}))}}),[]),Object(f.jsx)("span",{children:0===a?"Retrying":"Retrying in ".concat(a,"s...")})}),{duration:5e3})}))),E.rtc&&E.app&&y&&d.f.register(p.username)}),[E.rtc&&E.app,x,y,L]);var B=window.auth={user:p,isLogged:y,isConnected:E.app&&E.rtc,login:function(e,t){return U.apply(this,arguments)},logout:V};return Object(f.jsx)(h.Provider,{value:B,children:t})}},456:function(e,t,n){var a={"./Devices.jsx":[467,3],"./p1.jsx":[464,4],"./p2.jsx":[465,5],"./p3.jsx":[466,6]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=456,e.exports=r},458:function(e,t,n){},459:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(38),c=n.n(o),i=function(e){e&&e instanceof Function&&n.e(7).then(n.bind(null,490)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),o(e),c(e)}))},s=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function l(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var d=n(190),u=n(489),b=n(0);c.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(r.a.Suspense,{children:Object(b.jsx)(d.a,{}),fallback:Object(b.jsx)(u.a,{className:"start-50",animated:!0,now:100})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/admire-pwa",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/admire-pwa","/service-worker.js");s?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):l(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):l(t,e)}))}}(),i()},49:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),r=n(5),o=n(8),c=n(7),i=n(12),s=n(1),l=n(0),d=["children"],u=Object(s.createContext)();t.b=function(e){var t=e.children,n=(Object(o.a)(e,d),Object(s.useRef)(0).current),b=Object(s.useRef)(null),m=Object(s.useState)(!1),f=Object(r.a)(m,2),j=f[0],h=f[1],p=Object(s.useState)(null),v=Object(r.a)(p,2),O=v[0],g=v[1],x=Object(s.useState)(null),w=Object(r.a)(x,2),k=w[0],C=w[1],y=Object(s.useState)(null),S=Object(r.a)(y,2),I=S[0],N=S[1],E=Object(s.useReducer)((function(e,t){return b&&b.current&&(b.current.srcObject=t),t}),c.d.getStream()),R=Object(r.a)(E,2),_=R[0],A=R[1];function T(){c.e.getDevices()}function P(e){var t=e.resolutions,n=e.settings;C(Object(a.a)({},n)),N(t)}function D(e){var t=e.audioDevices,n=e.videoDevices,r=e.settings;C(Object(a.a)({},r)),g(Object(a.a)(Object(a.a)({},O),{},{audio:t,video:n}))}function L(e){var t=e.stream,n=e.settings;C(Object(a.a)({},n)),A(t),h(!0)}function F(e){var t=e.description;i.b.error("Error:",t)}Object(s.useEffect)((function(){function e(){c.e.off("got_stream",L),c.e.off("got_devices",D),c.e.off("error_stream",F),c.e.off("error_devices",F),c.e.off("got_resolutions",P),window.removeEventListener("unload ",e)}return c.e.on("got_stream",L),c.e.on("got_devices",D),c.e.on("error_stream",F),c.e.on("error_devices",F),c.e.on("got_resolutions",P),c.e.start(),T(),window.addEventListener("unload ",e),function(){e()}}),[]);var U=window.media={devices:O,settings:k,resolutions:I,localStream:_,init:function(){n<=0&&T(),++n},stop:function(){--n},getDevices:T,setVideo:function(e,t){c.e.setVideo(e,t)},setAudio:function(e){c.e.setAudio(e)},ready:j};return Object(l.jsx)(u.Provider,{value:U,children:t})}},50:function(e,t,n){"use strict";var a=n(14),r=n.n(a),o=n(19),c={get:function(){var e=Object(o.a)(r.a.mark((function e(t){var n,a,o,c=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:{},o=Object.assign({"Content-Type":"application/json"},null!==(n=a.headers)&&void 0!==n?n:{}),e.abrupt("return",fetch(t,{method:"GET",headers:o}).then((function(e){return e.json()})).catch((function(e){return console.trace(e)})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),post:function(){var e=Object(o.a)(r.a.mark((function e(t){var n,a,o,c,i,s=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=s.length>1&&void 0!==s[1]?s[1]:{},c=Object.assign({"Content-Type":"application/json"},null!==(n=o.headers)&&void 0!==n?n:{}),i=JSON.stringify(null!==(a=o.data)&&void 0!==a?a:{}),e.abrupt("return",fetch(t,{method:"POST",headers:c,body:i}).then((function(e){return e.json()})).catch((function(e){return console.trace(e)})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};t.a=c},7:function(e,t,n){"use strict";n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return x})),n.d(t,"c",(function(){return v})),n.d(t,"e",(function(){return O})),n.d(t,"d",(function(){return g}));var a=n(14),r=n.n(a),o=n(19),c={ClientConnected:"client_connected",ClientDisconnected:"client_disconnected",IncomingCall:"incoming_call",CallAccepted:"call_accepted",CallCanceled:"call_canceled",CallOpened:"call_opened",CallClosed:"call_closed",UserHangup:"user_hangup"};function i(e,t,n){var a=null,c=[],i={},s=!1,l=function(){var c=Object(o.a)(r.a.mark((function o(){var c;return r.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a){r.next=2;break}return r.abrupt("return");case 2:return c={callId:e,callerId:t,calleeId:n},r.next=5,a.getStats(null).then((function(e){var t=null;return e.forEach((function(e){"candidate-pair"!==e.type||!0!==e.selected&&"succeeded"!==e.state||(t=e)})),t&&e.forEach((function(e){var n,a;e.id===t.localCandidateId&&(c.localType=e.candidateType,c.localAddress=null!==(n=e.address)&&void 0!==n?n:e.ip,c.localPort=e.port,c.localProtocol=e.protocol);e.id===t.remoteCandidateId&&(c.remoteType=e.candidateType,c.remoteAddress=null!==(a=e.address)&&void 0!==a?a:e.ip,c.remotePort=e.port,c.remoteProtocol=e.protocol)})),Promise.resolve(c)}));case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}}),o)})));return function(){return c.apply(this,arguments)}}();return{get callId(){return e},get callerId(){return t},get calleeId(){return n},bind:function(e,t){return e instanceof RTCPeerConnection&&(s=t,(a=e).addEventListener("datachannel",(function(e){i[e.channel.label]=e.channel,e.channel.addEventListener("onclose",(function(e){delete i[e.channel.label]}))})),!0)},close:function(){var e;null===(e=a)||void 0===e||e.close()},isInitiator:function(){return s},getState:function(){return a?a.iceConnectionState:"closed"},getStats:l,addCandidate:function(e){a?a.addIceCandidate(e):c.push(e)},gatherPendingCandidates:function(){c.length>0&&(c.forEach((function(e){return a.addIceCandidate(e)})),c=[])},setRemoteDescription:function(e){return!!a&&(a.setRemoteDescription(e),!0)},setBandwidth:function(e){if(!a)return!1;var t=a.getSenders();if(!t)return!1;for(var n=0;n<t.length;n++){var r=t[n],o=r.getParameters();o.encodings||(o.encodings=[{}]),o.encodings[0].maxBitrate=1e3*e,r.setParameters(o)}return!0},getRemoteAudioTrack:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!a)return null;var t=a.getReceivers();if(!t)return null;for(var n=[],r=0;r<t.length;r++){var o=t[r];"audio"===o.track.kind&&n.push(o.track)}return e>=0&&e<n.length?n[e]:null},getRemoteVideoTrack:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!a)return null;var t=a.getReceivers();if(!t)return null;for(var n=[],r=0;r<t.length;r++){var o=t[r];"video"===o.track.kind&&n.push(o.track)}return e>=0&&e<n.length?n[e]:null},getRemoteStream:function(){if(!a)return null;var e=a.getReceivers();if(!e)return null;for(var t=[],n=0;n<e.length;n++){var r=e[n];r.track&&t.push(r.track)}if(0===t.length)return null;for(var o=new MediaStream,c=0;c<t.length;c++){var i=t[c];o.addTrack(i)}return o},replaceLocalAudioTrack:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!a||!e)return!1;for(var n=[],r=a.getSenders(),o=0;o<r.length;o++){var c=r[o];c.track&&"audio"===c.track.kind&&n.push(c)}return t>=0&&t<n.length&&(n[t].replaceTrack(e),!0)},replaceLocalVideoTrack:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!a||!e)return!1;for(var n=[],r=a.getSenders(),o=0;o<r.length;o++){var c=r[o];c.track&&"video"===c.track.kind&&n.push(c)}return t>=0&&t<n.length&&(n[t].replaceTrack(e),!0)},openChannel:function(e){if(!a||e in i)return!1;var t=a.createDataChannel(e);return i[e]=t,t.addEventListener("onclose",(function(e){delete i[t.label]})),!0},closeChannel:function(e){return!(!a||!(e in i))&&(i[e].close(),delete i[e],!0)},onDataChannel:function(e){return!!a&&(a.addEventListener("datachannel",e),!0)},onChannelOpen:function(e,t){return!!(a&&e in i&&t instanceof Function)&&(i[e].onopen=t,!0)},onChannelClose:function(e,t){return!!(a&&e in i&&t instanceof Function)&&(i[e].addEventListener("onclose",t),!0)},onChannelError:function(e,t){return!!(a&&e in i&&t instanceof Function)&&(i[e].onerror=t,!0)},onChannelMessage:function(e,t){return!!(a&&e in i&&t instanceof Function)&&(i[e].onmessage=t,!0)},sendData:function(e,t){if(!a||!(e in i))return!1;var n=i[e];return"open"===n.readyState&&(n.send(t),!0)}}}var s={ClientConnected:"client_connected",ClientDisconnected:"client_disconnected",Error:"error",UserOnline:"user_online",UserOffline:"user_offline",RoomCreated:"room_created",RoomDeleted:"room_deleted",GuestJoinedRoom:"guest_joined_room",GuestLeftRoom:"guest_left_room",UserRejoined:"user_rejoined"};var l,d=n(6),u=n(2),b=n(5),m=n(34),f={GotDevices:"got_devices",ErrorDevices:"error_devices",GotResolutions:"got_resolutions",GotStream:"got_stream",ErrorStream:"error_stream"};function j(){var e=new AudioContext,t=e.createGain(),n=e.createOscillator();n.connect(t);var a=t.connect(e.createMediaStreamDestination());return t.gain.setValueAtTime(0,e.currentTime),n.start(),a.stream}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:320,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:240,n=window.document.createElement("canvas");n.width=e,n.height=t;var a=n.getContext("2d"),r=null;function o(){a?a.fillRect(0,0,e,t):window.clearInterval(r)}r=window.setInterval(o,1e3);var c=n.captureStream();return c}var p=null!==(l="true")&&l,v=window.appClient=new function(e){e="object"!==typeof e?{}:e;var t=(e=Object.assign({},{debug:!1,debugStyle:"background: hsla(0, 0%, 13%, 1); color: hsla(180, 89%, 45%, 1)",pingPeriod:5e3},e)).debug?window.console:null,n={},a={},r=null,o=null,c=null,i=function(e){if(-1==Object.values(s).indexOf(e))return!1;var t=[].slice.call(arguments,1);if("object"===typeof a[e])for(var n=a[e].slice(),r=0;r<n.length;r++)n[r].apply(this,t);return!0},l=function(n){null===t||void 0===t||t.log("%cconnected%o",e.debugStyle,o.url),m(),i(s.ClientConnected,{url:o.url})},d=function(n){null===t||void 0===t||t.log("%cdisconnected%o",e.debugStyle,o.url),f(),i(s.ClientDisconnected,{url:o.url})},u=function(a){var r=JSON.parse(a.data);if("pong"!==r.event){if(null===t||void 0===t||t.log(" %c%s%o",e.debugStyle,r.event,r.data),r.data.uuid in n){var o=n[r.data.uuid];return delete n[r.data.uuid],delete r.data.uuid,void o(r)}i(r.event,r)}},b=function(a,c){if(!o||o.readyState!==WebSocket.OPEN)return!1;a.data.token=r,a.data.uuid=h(),c instanceof Function&&(n[a.data.uuid]=c);var i=JSON.stringify(a);return o.send(i),"ping"!==a.event&&(null===t||void 0===t||t.log(" %c%s%o",e.debugStyle,a.event,i)),!0},m=function t(){o&&o.readyState===WebSocket.OPEN&&(j(),c=window.setTimeout(t,e.pingPeriod))},f=function(){window.clearTimeout(c)},j=function(){return b({event:"ping",data:{}})},h=function(){return p()},p=function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))};return{on:function(e,t){return-1!=Object.values(s).indexOf(e)&&(t instanceof Function&&("object"!==typeof a[e]&&(a[e]=[]),a[e].push(t),!0))},off:function(e,t){if(-1==Object.values(s).indexOf(e))return!1;if(!(t instanceof Function))return!1;if("object"===typeof a[e]){var n=a[e].indexOf(t);if(n>-1)return a[e].splice(n,1),!0}return!1},connect:function(e,t){r=t,(o=new WebSocket(e+"?token="+r)).onopen=l,o.onmessage=u,o.onclose=d},disconnect:function(){var e;null===(e=o)||void 0===e||e.close()},getRoom:function(e){return b({event:"get_room",data:{}},e)},getRooms:function(e){return b({event:"get_rooms",data:{}},e)},createRoom:function(e,t,n,a,r){return b({event:"create_room",data:{name:e,password:t,hidden:n,icon:a}},r)},joinRoom:function(e,t,n){return b({event:"join_room",data:{name:e,password:t}},n)},leaveRoom:function(e){return b({event:"leave_room",data:{}},e)}}}({debug:!1}),O=window.mediaAdapter=new function(){var e={},t=null,n=null,a=null,c={},i={},s={Undefined:{},"320x240":{width:320,height:240},"640x360":{width:640,height:360},"640x480":{width:640,height:480},"1280x720":{width:1280,height:720},"1920x1080":{width:1920,height:1080},"3840x2160":{width:3840,height:2160}},l={audio:{deviceId:{exact:void 0}}},p={video:{deviceId:{exact:void 0},width:{exact:void 0},height:{exact:void 0},frameRate:{ideal:60}}},v={audio:"None",video:"None",resolution:"Undefined"},O=null,g=null,x=function(t){if(-1==Object.values(f).indexOf(t))return!1;var n=[].slice.call(arguments,1);if("object"===typeof e[t])for(var a=e[t].slice(),r=0;r<a.length;r++)a[r].apply(this,n);return!0},w=function(){var e=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){e.next=2;break}return e.abrupt("return",!1);case 2:return t=new j,n=new h,a=P(t,n),e.next=7,window.navigator.mediaDevices.getUserMedia({audio:!0});case 7:return e.next=9,window.navigator.mediaDevices.getUserMedia({video:!0});case 9:return e.next=11,k();case 11:return e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",C().then(y).catch(S));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),C=function(){return window.navigator.mediaDevices.enumerateDevices()},y=function(e){i={},(c={}).None="",i.None="";var t,n=0,a=0,r=Object(m.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;if("audioinput"===o.kind){var l=""===o.label?"Audio input "+n:o.label;c[l]=o.deviceId,n++}if("videoinput"===o.kind){var d=""===o.label?"Video input "+a:o.label;i[d]=o.deviceId,a++}}}catch(u){r.e(u)}finally{r.f()}x(f.GotDevices,{audioDevices:c,videoDevices:i,settings:v}),x(f.GotResolutions,{resolutions:s,settings:v})},S=function(e){x(f.ErrorDevices,{error:e,message:"Device request not allowed in the browser"})},I=function(){return a=null,D(t),window.navigator.mediaDevices.getUserMedia(l).then(E).catch(A)},N=function(){return a=null,D(n),window.navigator.mediaDevices.getUserMedia(p).then(R).catch(T)},E=function(){var e=Object(o.a)(r.a.mark((function e(o){var i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=o.getAudioTracks()[0]).label in c){e.next=4;break}return e.next=4,k();case 4:v.audio=i.label,a=P(t=o,n),x(f.GotStream,{stream:a,settings:v});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(){var e=Object(o.a)(r.a.mark((function e(o){var c,l,m,j,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=o.getVideoTracks()[0],l=c.getSettings(),c.label in i){e.next=5;break}return e.next=5,k();case 5:m=l.width,j=l.height,s[h=m+"x"+j]||(s[h]={width:m,height:j},s=Object.entries(s).sort((function(e,t){return(e[1].width||Number.NEGATIVE_INFINITY)>(t[1].width||Number.NEGATIVE_INFINITY)})).reduce((function(e,t){var n=Object(b.a)(t,2),a=n[0],r=n[1];return Object(u.a)(Object(u.a)({},e),{},Object(d.a)({},a,r))}),{}),x(f.GotResolutions,{resolutions:s,settings:v})),p.video.width.exact=m,p.video.height.exact=j,v.video=c.label,v.resolution=h,a=P(t,n=o),x(f.GotStream,{stream:a,settings:v});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(e){return"NotFoundError"===e.name||"DevicesNotFoundError"===e.name?"Required track is missing":"NotReadableError"===e.name||"TrackStartError"===e.name?"Microphone or Webcam are already in use":"OverconstrainedError"===e.name||"ConstraintNotSatisfiedError"===e.name?"Invalid device settings":"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?"Permission denied in browser":"TypeError"===e.name||"TypeError"===e.name?"Empty constraints object":"Unknown error"},A=function(e){var t=_(e);x(f.ErrorStream,{error:e.name,message:t,settings:v}),O&&(l=L(O),O=null,I())},T=function(e){var t=_(e);x(f.ErrorStream,{error:e.name,message:t,settings:v}),g&&(p=L(g),g=null,N())},P=function(e,t){var n=e.getAudioTracks();if(!n||0===n.length)return null;var a=t.getVideoTracks();if(!a||0===a.length)return null;var r=new MediaStream;return r.addTrack(n[0]),r.addTrack(a[0]),r},D=function(e){e.getTracks().forEach((function(e){return e.stop()}))},L=function(e){return JSON.parse(JSON.stringify(e))};return{on:function(t,n){return-1!=Object.values(f).indexOf(t)&&(n instanceof Function&&("object"!==typeof e[t]&&(e[t]=[]),e[t].push(n),!0))},off:function(t,n){if(-1==Object.values(f).indexOf(t))return!1;if(!(n instanceof Function))return!1;if("object"===typeof e[t]){var a=e[t].indexOf(n);if(a>-1)return e[t].splice(a,1),!0}return!1},start:w,findDevices:k,getDevices:C,setAudio:function(e){if(e||(e="None"),!(e in c)){x(f.ErrorStream,{error:"DeviceNotFound",message:"Audio device "+e+" not found",settings:v}),e="None"}if("None"===e)v.audio=e,t=new j,a=P(t,n),x(f.GotStream,{stream:a,settings:v});else{O=L(l);var r=c[e];l.audio.deviceId.exact=r,I()}},setVideo:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Undefined";if(e||(e="None",r="Undefined"),r||(r="Undefined"),!(e in i)){var o="DeviceNotFound",c="Video device "+e+" not found";x(f.ErrorStream,{error:o,message:c,settings:v}),e="None"}if(!(r in s)){var l="ResolutionNotFound",d="Resolution "+r+" not found";x(f.ErrorStream,{error:l,message:d,settings:v}),r="Undefined"}if("None"===e){v.video=e,v.resolution=r;var u=s[r].width,b=s[r].height;n=new h(u,b),a=P(t,n),x(f.GotStream,{stream:a,settings:v})}else{g=L(p);var m=i[e];p.video.deviceId.exact=m;var j=s[r].width,O=s[r].height;p.video.width.exact=j,p.video.height.exact=O,N()}}}}({debug:p}),g=window.dummyStream=new function(){var e=null,t=null,n=null,a=null,r=null;!function(){var e=new AudioContext,n=e.createGain();e.createOscillator().connect(n);var r=n.connect(e.createMediaStreamDestination());t=r.stream,a=t.getAudioTracks()[0]}(),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:320,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:240;e||(e=window.document.createElement("canvas")),e.width=t,e.height=a;var o=e.getContext("2d");o.fillRect(0,0,t,a),n=e.captureStream(),r=n.getVideoTracks()[0]}();var o=new MediaStream([a,r]);return{getAudioTrack:function(){return a},getVideoTrack:function(){return r},getStream:function(){return o}}}({debug:p}),x=window.rtcClient=new function(e){var t={debug:!1,debugStyle:"background: hsla(0, 0%, 13%, 1); color: hsla(74, 64%, 60%, 1)",pingPeriod:5e3,defaultStream:new MediaStream};e="object"!==typeof e?{}:e;var n=(e=Object.assign({},t,e)).debug?window.console:null,a={},s={},l={},d=null,u=null,b=null,m={iceServers:null},f=function(e){if(-1==Object.values(c).indexOf(e))return!1;var t=[].slice.call(arguments,1);if("object"===typeof s[e])for(var n=s[e].slice(),a=0;a<n.length;a++)n[a].apply(this,t);return!0},j=function(t){O(),null===n||void 0===n||n.log("%c"+c.ClientConnected+"%o",e.debugStyle,d.url),f(c.ClientConnected,{url:d.url})},h=function(t){b=null,m.iceServers=null,g(),null===n||void 0===n||n.log("%c"+c.ClientDisconnected+"%o",e.debugStyle,d.url),f(c.ClientDisconnected,{url:d.url})},p=function(t){var r=JSON.parse(t.data);if("pong"!==r.id){switch(null===n||void 0===n||n.log(" %c%s%o",e.debugStyle,r.id,t.data),r.id){case"register_response":S(r);break;case"unregister_response":I(r);break;case"call_response":N(r);break;case"incoming_call":E(r);break;case"call_accepted":R(r);break;case"call_canceled":_(r);break;case"remote_offer":A(r);break;case"remote_answer":T(r);break;case"remote_candidate":P(r);break;case"user_hangup":D(r)}if(r.uuid in a){var o=a[r.uuid];delete a[r.uuid],delete r.uuid,o(r)}f(r.id,r)}},v=function(t,r){if(!d||d.readyState!==WebSocket.OPEN)return!1;t.uuid=C(),r instanceof Function&&(a[t.uuid]=r);var o=JSON.stringify(t);return d.send(o),"ping"!==t.id&&(null===n||void 0===n||n.log(" %c%s%o",e.debugStyle,t.id,o)),!0},O=function t(){return d&&d.readyState===WebSocket.OPEN?(x(),u=window.setTimeout(t,e.pingPeriod),!0):(null===n||void 0===n||n.error("WebSocket not opened"),!1)},g=function(){window.clearTimeout(u)},x=function(){return v({id:"ping"})},w=function(e){if(!(e in l))return!1;var t=l[e];return t.close(),delete l[e],f(c.CallClosed,{call:t}),!0},k=function(e,t){if(e)return!!w(e)&&v({id:"hangup",callId:e},t);for(var n in l){if(w(n))v({id:"hangup",callId:n})}return l={},!0},C=function(){return y()},y=function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))},S=function(e){"ok"===e.status&&(b=e.userId,m.iceServers=JSON.parse(e.iceServers))},I=function(e){"ok"===e.status&&(b=null,m.iceServers=null)},N=function(e){if("ok"===e.status){var t=new i(e.callId,e.callerId,e.calleeId);l[t.callId]=t}},E=function(e){var t=new i(e.callId,e.callerId,e.calleeId);l[e.callId]=t},R=function(t){var n=new RTCPeerConnection(m),a=l[t.callId];a.bind(n,!0),n.oniceconnectionstatechange=function(e){L(a)},n.onicecandidate=function(e){if(e.candidate&&""!==e.candidate){var n={id:"candidate",callId:t.callId,callerId:t.callerId,calleeId:t.calleeId,candidate:JSON.stringify(e.candidate)};v(n)}},n.onnegotiationneeded=function(e){n.createOffer().then((function(e){n.setLocalDescription(e);var a={id:"offer",callId:t.callId,callerId:t.callerId,calleeId:t.calleeId,offer:JSON.stringify(e)};v(a)}))},e.defaultStream.getTracks().forEach((function(e){return n.addTrack(e)})),n.createDataChannel("default")},_=function(e){w(e.callId)},A=function(t){var n=new RTCPeerConnection(m),a=l[t.callId];a.bind(n,!1),n.oniceconnectionstatechange=function(e){L(a)},n.setRemoteDescription(JSON.parse(t.offer)),a.gatherPendingCandidates(),n.onicecandidate=function(e){if(e.candidate&&""!==e.candidate){var n={id:"candidate",callId:t.callId,callerId:t.callerId,calleeId:t.calleeId,candidate:JSON.stringify(e.candidate)};v(n)}},e.defaultStream.getTracks().forEach((function(e){return n.addTrack(e)})),window.setTimeout((function(){n.createAnswer().then((function(e){n.setLocalDescription(e);var a={id:"answer",callId:t.callId,callerId:t.callerId,calleeId:t.calleeId,answer:JSON.stringify(e)};v(a)}))}),500)},T=function(e){if(e.callId in l){var t=JSON.parse(e.answer);l[e.callId].setRemoteDescription(t)}},P=function(e){var t=JSON.parse(e.candidate);t&&t.candidate&&""!==t.candidate&&(e.callId in l&&l[e.callId].addCandidate(t))},D=function(e){w(e.callId)},L=function(){var t=Object(o.a)(r.a.mark((function t(a){var o,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=a.getState(),null===n||void 0===n||n.log("%cConnection State%o%o",e.debugStyle,a.callId,o),t.t0=o,t.next="failed"===t.t0||"disconnected"===t.t0||"closed"===t.t0?5:"new"===t.t0||"checking"===t.t0||"completed"===t.t0?7:"connected"===t.t0?8:12;break;case 5:return k(a.callId),t.abrupt("break",12);case 7:return t.abrupt("break",12);case 8:return i=a.getRemoteStream(),null===n||void 0===n||n.log("%c"+c.CallOpened+"%o%o",e.debugStyle,a.callId,i),f(c.CallOpened,{call:a,stream:i}),t.abrupt("break",12);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return{on:function(e,t){return-1!=Object.values(c).indexOf(e)&&(t instanceof Function&&("object"!==typeof s[e]&&(s[e]=[]),s[e].push(t),!0))},off:function(e,t){if(-1==Object.values(c).indexOf(e))return!1;if(!(t instanceof Function))return!1;if("object"===typeof s[e]){var n=s[e].indexOf(t);if(n>-1)return s[e].splice(n,1),!0}return!1},getCall:function(e){return e in l?l[e]:null},getCalls:function(){return l},connect:function(e){d&&d.readyState!=WebSocket.CLOSED?null===n||void 0===n||n.error("WebSocket not closed"):((d=new WebSocket(e)).onopen=j,d.onmessage=p,d.onclose=h)},disconnect:function(){var e;d&&d.readyState!=WebSocket.OPEN?null===(e=d)||void 0===e||e.close():null===n||void 0===n||n.error("WebSocket not opened")},register:function(e,t){return b?(null===n||void 0===n||n.error("Client already registered"),!1):v({id:"register",userId:e},t)},unregister:function(e){return b?(k(),v({id:"unregister",userId:b},e)):(null===n||void 0===n||n.error("Client not registered"),!1)},call:function(e,t){return b===e?(null===n||void 0===n||n.error("Invalid user id "+e),!1):v({id:"call",callerId:b,calleeId:e},t)},acceptCall:function(e,t){if(!(e in l))return null===n||void 0===n||n.error("Call "+e+" not found"),!1;var a=l[e],r={id:"accept_call",callId:a.callId,callerId:a.callerId,calleeId:a.calleeId};return v(r,t)},cancelCall:function(e,t){if(!(e in l))return null===n||void 0===n||n.error("Call "+e+" not found"),!1;var a=l[e];delete l[e];var r={id:"cancel_call",callId:a.callId,callerId:a.callerId,calleeId:a.calleeId};return v(r,t)},hangup:k}}({debug:p,defaultStream:g.getStream()}),w=s},82:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(6),r=n(2),o=n(34),c=n(5),i=n(8),s=n(7),l=n(12),d=n(1),u=n(49),b=n(27),m=n(22),f=n(0),j=["children"],h=Object(d.createContext)();t.b=function(e){var t=e.children,n=(Object(i.a)(e,j),Object(d.useContext)(b.a)),p=Object(d.useContext)(m.a),v=Object(d.useContext)(u.a),O=Object(d.useState)({}),g=Object(c.a)(O,2),x=g[0],w=g[1],k=Object(d.useState)({}),C=Object(c.a)(k,2),y=C[0],S=C[1],I=Object(d.useState)(v.localStream),N=Object(c.a)(I,2),E=N[0],R=N[1];function _(e,t){return s.f.call(e,null!==t&&void 0!==t?t:function(e){e.callId;var t=e.status,n=e.description;"error"===t&&l.b.error("Call error: ".concat(n),{icon:Object(f.jsx)("i",{className:"bi bi-telephone-x"}),duration:5e3})})}function A(e){s.f.hangup(e)}function T(e){var t=e.callId;e.callerId;s.f.acceptCall(t)}function P(e){var t=e.call,n=e.stream,o=t.callId;w(Object(r.a)(Object(r.a)({},x),{},Object(a.a)({},o,n)));var c=y[o];if(c){var i=x[c];if(!i)return A(o),l.b.error("Live Call Error: ".concat(o,", callerId: ").concat(t.callerId,", calleeId: ").concat(t.calleeId," "));l.b.success("Live Call: ".concat(o,", callerId: ").concat(t.callerId,", calleeId: ").concat(t.calleeId," "));var s=i.getVideoTracks()[0],d=i.getAudioTracks()[0];t.replaceLocalVideoTrack(s),t.replaceLocalAudioTrack(d),Object(l.b)("Forwarding stream",{icon:Object(f.jsx)("i",{className:"bi bi-cast"})})}else{l.b.success("Incoming Call: ".concat(o,", callerId: ").concat(t.callerId,", calleeId: ").concat(t.calleeId," "));var u=v.localStream.getVideoTracks()[0],b=v.localStream.getAudioTracks()[0];t.replaceLocalVideoTrack(u),t.replaceLocalAudioTrack(b),Object(l.b)("Call from ".concat(U(o)),{icon:Object(f.jsx)("i",{className:"bi bi-telephone-inbound"})})}}function D(e){var t=e.call;if(!t)return console.error("No call");var n=t.callId;F(n),delete x[n],w(Object(r.a)({},x)),Object(l.b)("Call from ".concat(U(n)," closed"),{icon:Object(f.jsx)("i",{className:"bi bi-telephone-x"})})}function L(e){var t=e.callId;if(!t)return console.error("No call");F(t),delete x[t],w(Object(r.a)({},x)),Object(l.b)("User ".concat(U(t)," hangup"),{icon:Object(f.jsx)("i",{className:"bi bi-telephone-x"})})}function F(e){for(var t=null,n=0,a=Object.entries(y);n<a.length;n++){var r=Object(c.a)(a[n],2),o=r[0],i=r[1];if(e===o||i===e){t=[o,i];break}}if(t){var s=t,l=Object(c.a)(s,2),d=l[0];l[1];delete y[d],S(y)}}function U(e){var t,a=null===(t=n.user)||void 0===t?void 0:t.username,r=s.f.getCalls()[e];if("local"!==e&&r){var o,c=r.calleeId,i=r.callerId;a=c===(null===(o=n.user)||void 0===o?void 0:o.username)?i:c}return a}Object(d.useEffect)((function(){return s.f.on(s.b.IncomingCall,T),s.f.on(s.b.CallOpened,P),s.f.on(s.b.CallClosed,D),s.f.on(s.b.UserHangup,L),function(){s.f.off(s.b.IncomingCall,T),s.f.off(s.b.CallOpened,P),s.f.off(s.b.CallClosed,D),s.f.off(s.b.UserHangup,L)}}),[]),Object(d.useEffect)((function(){for(var e in s.f.getCalls()){var t=s.f.getCall(e),n=v.localStream,a=n.getVideoTracks()[0];t.replaceLocalVideoTrack(a);var r=n.getAudioTracks()[0];t.replaceLocalAudioTrack(r)}R(v.localStream)}),[v.localStream]);var V=window.wrtc={callUser:_,callAllUsers:function(){var e,t,a,r=null===(e=p.current)||void 0===e||null===(t=e.users)||void 0===t?void 0:t.filter((function(e,t,a){var r;return e&&(null===e||void 0===e?void 0:e.username)!==(null===(r=n.user)||void 0===r?void 0:r.username)})),c=Object(o.a)(null!==r&&void 0!==r?r:[]);try{for(c.s();!(a=c.n()).done;){var i=a.value;_(null===i||void 0===i?void 0:i.username)||l.b.error("Call missed to ".concat(null===i||void 0===i?void 0:i.username))}}catch(s){c.e(s)}finally{c.f()}},callHangup:A,callHangupAll:function(){for(var e=0,t=Object.keys(s.f.getCalls());e<t.length;e++){A(t[e])}},forwardCall:function(e,t){if(!t||!e)return console.error("source or target callId's are undefined");y[t]=e,S(Object(r.a)({},y))},getUserId:U,getLiveCall:function(e){var t;return null!==(t=Object.entries(y).find((function(t){return t[1]===e})))&&void 0!==t?t:[null,null]},replaceStream:function(e){for(var t in s.f.getCalls()){var n=s.f.getCall(t),a=e.getVideoTracks()[0];n.replaceLocalVideoTrack(a);var r=e.getAudioTracks()[0];n.replaceLocalAudioTrack(r)}},streams:Object(r.a)(Object(r.a)({},x),{},{local:E})};return Object(f.jsx)(h.Provider,{value:V,children:t})}}},[[459,1,2]]]);
//# sourceMappingURL=main.5650b936.chunk.js.map